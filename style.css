.settings-page,
.config-page,
.beautify-page,
.contacts-page {
    position: absolute;
    left: 0;
    width: 100%;
    top: 0;
    bottom: 0;
    /*height: auto;*/
}

/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µå…¨æ–°çš„ã€ä¿®æ­£åçš„ä»£ç å—CSS ========== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    display: flex;
    justify-content: center;
    min-height: 100vh;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    padding: 20px;
}

/* --- èŠå¤©ç•Œé¢æ ·å¼ --- */

/* ===== é«˜çº§ç®€çº¦èŠå¤©ç•Œé¢æ ·å¼ - å¼€å§‹ ===== */

.chat-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #f7f8fa; /* æŸ”å’Œçš„èƒŒæ™¯è‰² */
    z-index: 1005;
    display: flex;
    flex-direction: column;
    transform: translateY(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.chat-page.show {
    transform: translateY(0);
}

/* å½“ chat-page æ‹¥æœ‰ simple-style ç±»æ—¶è§¦å‘ */
.chat-page.simple-style .message-row {
    flex-direction: row !important; /* å¼ºåˆ¶ å¤´åƒ-å†…å®¹ é¡ºåº */
    justify-content: flex-start !important; /* å¼ºåˆ¶ å·¦å¯¹é½ */
}

/* å¹¶ä¸”ï¼Œç§»é™¤æ°”æ³¡çš„æ‰€æœ‰æ ·å¼ */
.chat-page.simple-style .chat-bubble {
    background: transparent;
    color: #333;
    padding: 0;
    border-radius: 0;
    box-shadow: none;
}


/* æ¶ˆæ¯å†…å®¹å®¹å™¨ï¼Œç”¨äºåŒ…è£¹å‘é€è€…å’Œæ¶ˆæ¯æ–‡æœ¬ */
/* è¿™æ˜¯è§£å†³é—®é¢˜çš„å…³é”®ï¼ */
.chat-page.simple-style .message-content {
    display: flex;
    flex-direction: column;
    gap: 4px; /* å‘é€è€…å’Œæ¶ˆæ¯ä¹‹é—´çš„é—´è· */
    min-width: 0; /* å…³é”®ä¿®å¤ï¼å…è®¸flexå­é¡¹æ”¶ç¼©ï¼Œé˜²æ­¢è¢«å†…éƒ¨å†…å®¹æ’‘å¼€ */
}


/* ç®€æ´æ¨¡å¼ä¸‹ï¼Œå‘é€æ¶ˆæ¯çš„æ°”æ³¡ä¹Ÿä¸å†æœ‰ç‰¹æ®Šé¢œè‰² */
.chat-page.simple-style .message-row.sent .chat-bubble {
    background: transparent;
    color: #333;
}


/* å‘é€è€…åç§°çš„æ ·å¼ */
.message-sender-name {
    font-size: 14px;
    font-weight: 600;
    color: #555;
}

/* é»˜è®¤éšè—å¤´åƒå’Œåå­—ï¼Œåªåœ¨ç®€æ´æ¨¡å¼ä¸‹æ˜¾ç¤º */


.chat-page.simple-style .message-chat-avatar,
.chat-page.simple-style .message-sender-name {
    display: block; /* åœ¨ç®€æ´æ¨¡å¼ä¸‹æ˜¾ç¤ºå®ƒä»¬ */
}

/* èŠå¤©ä¸­çš„å°å¤´åƒæ ·å¼ */
.message-chat-avatar {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    flex-shrink: 0;
    overflow: hidden;
    background: #ccc;
}

.message-chat-avatar img,
.message-chat-avatar .initials {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    font-weight: bold;
    color: white;
}

.message-chat-avatar, .message-sender-name {
    display: none;
}

/* ========== ç»“æŸï¼šã€æœ€ç»ˆä¿®æ­£ç‰ˆã€‘ç®€æ´èŠå¤©æ ·å¼ ========== */


.chat-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 45px 12px 12px; /* è°ƒæ•´å†…è¾¹è· */
    background: white;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); /* æ›´æŸ”å’Œçš„é˜´å½± */
    flex-shrink: 0;
    position: relative;
    z-index: 2;
}

.chat-header .back-btn {
    margin-right: 8px;
}

.chat-title {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    font-size: 17px; /* ç¨å¾®è°ƒæ•´å­—ä½“å¤§å° */
    font-weight: 600;
    color: #000;
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 55%;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 0; /* æŒ‰é’®ä¹‹é—´ä¸ç•™ç©ºéš™ */
}

.edit-contact-btn, .chat-settings-btn {
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 500;
    color: #0A84FF; /* ç»Ÿä¸€ä¸ºå“ç‰Œè“è‰² */
    cursor: pointer;
    border-radius: 8px;
    transition: background-color 0.2s;
}

.chat-settings-btn {
    font-size: 20px; /* è®©å›¾æ ‡ç¨å¤§ä¸€äº› */
}

.edit-contact-btn:hover, .chat-settings-btn:hover {
    background-color: #f0f2f5;
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    min-height: 0;
    padding: 20px;
    display: flex;
    flex-direction: column;
    background-color: rgba(247, 248, 250, 0.85); /* æ–°å¢æ­¤è¡Œ */
}


.chat-messages::-webkit-scrollbar {
    display: none;
}

/* ========== å¼€å§‹ï¼šä¿®å¤æ°”æ³¡å¯¹é½é—®é¢˜ ========== */

/* 1. è®©æ¶ˆæ¯å†…å®¹å®¹å™¨æˆä¸ºflexå®¹å™¨ */
.message-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
    min-width: 0;
    width: 100%; /* å æ»¡å¯ç”¨å®½åº¦ï¼Œè¿™æ ·align-itemsæ‰èƒ½ç”Ÿæ•ˆ */
}

/* 2. æ°”æ³¡æ¨¡å¼ï¼šå‘é€æ¶ˆæ¯å³å¯¹é½ */
.message-row.sent .message-content {
    align-items: flex-end;
}

/* 3. æ°”æ³¡æ¨¡å¼ï¼šæ¥æ”¶æ¶ˆæ¯å·¦å¯¹é½ */
.message-row.received .message-content {
    align-items: flex-start;
}

/* 4. ç®€æ´æ¨¡å¼ï¼šå¼ºåˆ¶æ‰€æœ‰æ¶ˆæ¯å·¦å¯¹é½ */
.chat-page.simple-style .message-row.sent .message-content,
.chat-page.simple-style .message-row.received .message-content {
    align-items: flex-start !important;
}

/* ========== ç»“æŸï¼šä¿®å¤æ°”æ³¡å¯¹é½é—®é¢˜ ========== */

/* --- 1. æ¶ˆæ¯è¡Œçš„åŸºç¡€å¸ƒå±€ --- */
.message-row {
    display: flex;
    max-width: 100%;
    /*gap: 12px;*/
    margin: 8px 0;
    align-items: flex-start;
}

/* --- 2. æ°”æ³¡æ¨¡å¼ï¼šæ¥æ”¶æ¶ˆæ¯ï¼ˆå¤´åƒåœ¨å·¦ï¼Œå·¦å¯¹é½ï¼‰--- */
.message-row.received {
    flex-direction: row;
    justify-content: flex-start;
}

/* --- 3. æ°”æ³¡æ¨¡å¼ï¼šå‘é€æ¶ˆæ¯ï¼ˆå¤´åƒåœ¨å³ï¼Œå³å¯¹é½ï¼‰--- */
.message-row.sent {
    flex-direction: row-reverse;
    justify-content: flex-end;
}

/* --- 4. ç®€æ´æ¨¡å¼ï¼šæ‰€æœ‰æ¶ˆæ¯éƒ½å·¦å¯¹é½ï¼Œå¤´åƒéƒ½åœ¨å·¦ --- */
.chat-page.simple-style .message-row.sent,
.chat-page.simple-style .message-row.received {
    flex-direction: row !important;
    justify-content: flex-start !important;
}


/* --- 5. æ¶ˆæ¯æ°”æ³¡æ ·å¼ --- */
.chat-bubble {
    max-width: calc(100vw - 120px);
    width: fit-content;
    padding: 12px;
    border-radius: 20px;
    font-size: 16px;
    line-height: 1.2;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    word-break: break-word;
    display: flex; /* 1. å£°æ˜ä¸º Flex å®¹å™¨ */
    flex-direction: column; /* 2. è®¾ç½®ä¸»è½´ä¸ºå‚ç›´æ–¹å‘ */
    gap: 8px;
}

/* --- 6. å›¾ç‰‡æ¶ˆæ¯æ ·å¼ --- */
.chat-bubble.image-only {
    padding: 0;
    background: transparent;
    box-shadow: none;
    max-width: 65%;
    border-radius: 12px;
    overflow: hidden;
}

.chat-bubble.image-only img {
    display: block;
    max-width: 240px;
    width: 100%;
    height: auto;
    border-radius: 12px;
}

/* --- 7. æ¥æ”¶æ¶ˆæ¯æ°”æ³¡é¢œè‰² --- */
.message-row.received .chat-bubble {
    background: #e9e9eb;
    color: #000;
    border-bottom-left-radius: 5px;
}

/* --- 8. å‘é€æ¶ˆæ¯æ°”æ³¡é¢œè‰² --- */
.message-row.sent .chat-bubble {
    background: #0A84FF;
    color: white;
    border-bottom-right-radius: 5px;
}

/* --- 9. å›¾ç‰‡æ¶ˆæ¯æ— ç‰¹æ®Šé¢œè‰² --- */
.message-row .chat-bubble.image-only {
    background: transparent;
    border-radius: 12px;
}


.message-row:hover .delete-msg-btn {
    opacity: 1;
}

.delete-msg-btn:hover {
    background: #fecaca;
    color: #b91c1c;
}

.chat-input-area {
    display: flex;
    flex-direction: column; /* æ ¸å¿ƒä¿®æ”¹ï¼šè®©å­å…ƒç´ å‚ç›´æ’åˆ— */
    align-items: stretch; /* è®©å­å…ƒç´ å®½åº¦æ’‘æ»¡ */
    gap: 8px; /* å¼•ç”¨é¢„è§ˆæ¡†å’Œè¾“å…¥è¡Œä¹‹é—´çš„é—´è· */
    padding: 8px 12px;
    background: #fff;
    border-top: 1px solid #e5e5e5;
    flex-shrink: 0;
}

.chat-input-main-row {
    display: flex;
    align-items: center; /* å‚ç›´å±…ä¸­å¯¹é½ */
    gap: 8px; /* æŒ‰é’®å’Œè¾“å…¥æ¡†ä¹‹é—´çš„é—´è· */
    width: 100%; /* ç¡®ä¿å®ƒæ’‘æ»¡çˆ¶å®¹å™¨ */
}

.chat-input-area input {
    flex: 1;
    padding: 10px 16px;
    border: none;
    background: #f0f2f5;
    border-radius: 20px;
    font-size: 16px;
    outline: none;
}

/* ========== å¼€å§‹ï¼š .chat-action-btn è§„åˆ™ ========== */

.chat-input-area .chat-action-btn {
    width: 38px;
    height: 38px;
    padding: 0;
    border: none;
    border-radius: 50%;
    /* ç»Ÿä¸€æ‰€æœ‰éä¸»æŒ‰é’®çš„èƒŒæ™¯è‰² */
    background: #f0f2f5;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

/* é»˜è®¤éšè—æ–°çš„å‘é€æŒ‰é’® */

#sendMsgBtn {
    display: none;
}

/* å½“è¾“å…¥æ¡†æœ‰å†…å®¹æ—¶ï¼Œé€šè¿‡JSæ·»åŠ  .has-text ç±»æ¥æ˜¾ç¤ºå‘é€æŒ‰é’® */

.chat-input-area.has-text #sendMsgBtn {
    display: flex; /* ä½¿ç”¨ flex ä¿æŒå±…ä¸­ */
}

/* åŒæ—¶éšè—ä¿¡å°æŒ‰é’® */

.chat-input-area.has-text #getReplyBtn {
    display: none;
}

/* é‡æ–°å®šä¹‰ primary æŒ‰é’®çš„æ ·å¼ï¼Œç¡®ä¿å®ƒåªä½œç”¨äºæˆ‘ä»¬æœŸæœ›çš„æŒ‰é’®ä¸Š */

#sendMsgBtn.primary {
    background: #0A84FF;
}

#sendMsgBtn.primary svg {
    fill: white;
}

.chat-input-area .chat-action-btn svg {
    width: 20px;
    height: 20px;
    fill: #6c757d;
}

.chat-settings-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1006;
    display: flex;
    flex-direction: column;
}

.chat-settings-page.show {
    transform: translateX(0);
}

/* ===== é«˜çº§ç®€çº¦èŠå¤©ç•Œé¢æ ·å¼ - ç»“æŸ ===== */

/* 1. å¼•ç”¨é¢„è§ˆæ¡ (è¾“å…¥æ—¶) */
.quote-preview {
    display: none; /* é»˜è®¤éšè— */
    padding: 8px 12px;
    background-color: #f0f2f5; /* ç™½è‰²èƒŒæ™¯ */
    border-radius: 12px;
    border: none;
    align-items: flex-start; /* å‚ç›´æ–¹å‘é¡¶éƒ¨å¯¹é½ */
    gap: 8px;
}

.quote-preview.show {
    display: flex; /* å½“æœ‰ .show ç±»æ—¶æ˜¾ç¤º */
}

.quote-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.quote-sender {
    font-size: 14px;
    font-weight: 600;
    color: #333;
}

.quote-text {
    font-size: 14px;
    color: #666;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* è¶…å‡ºéƒ¨åˆ†æ˜¾ç¤ºçœç•¥å· */
}

.quote-close-btn {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: #cccccc;
    color: white;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    line-height: 1;
    flex-shrink: 0;
    transition: background-color 0.2s;
}

.quote-close-btn:hover {
    background-color: #aaaaaa;
}

/* 2. æœ€ç»ˆæ¸²æŸ“çš„å¼•ç”¨æ¶ˆæ¯æ ·å¼ (å‘å‡ºæ—¶) */
.quoted-message-wrapper {
    background: rgba(0, 0, 0, 0.1);
    padding: 8px 12px;
    /*margin-bottom: 8px;*/
    border-radius: 8px;
    border-left: 3px solid #0A84FF; /* å·¦ä¾§çš„è“è‰²æŒ‡ç¤ºæ¡ */
    display: flex;
    flex-direction: column;
    gap: 2px;
}

/* æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼ŒæŒ‡ç¤ºæ¡é¢œè‰²ä¸åŒ */
.message-row.received .quoted-message-wrapper {
    border-left-color: #a0a0a0;
}


.quoted-sender {
    font-size: 14px;
    font-weight: 600;
    color: #0A84FF; /* è“è‰²é«˜äº®å‘é€è€… */
}

.message-row.received .quoted-sender {
    color: #555; /* æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œå‘é€è€…é¢œè‰²ä¸åŒ */
}


.quoted-text {
    font-size: 14px;
    color: inherit; /* ç»§æ‰¿æ°”æ³¡çš„æ–‡å­—é¢œè‰² */
    opacity: 0.8;
    /* é˜²æ­¢è¿‡é•¿çš„å¼•ç”¨æ–‡æœ¬æ’‘ç ´æ°”æ³¡ */
    word-break: break-word;
}

/* 3. ä¸»æ¶ˆæ¯æ–‡æœ¬æ ·å¼ï¼ˆå¼•ç”¨æ¶ˆæ¯ä¸‹æ–¹çš„æ–°æ¶ˆæ¯ï¼‰ */
.main-message-text {
    margin-top: 4px; /* å’Œå¼•ç”¨å†…å®¹ä¹‹é—´ç•™å‡ºä¸€ç‚¹ç©ºéš™ */
}


.phone {
    width: 375px;
    height: 812px;
    background: #000;
    border-radius: 40px;
    padding: 12px;
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4);
    position: relative;
    margin: auto;
}

.phone::before {
    content: '';
    position: absolute;
    top: 12px;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 28px;
    background: #000;
    border-radius: 0 0 20px 20px;
    z-index: 999;
}

/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µå…¨æ–°çš„ CSS ä»£ç  ========== */

/* å½“ body æ ‡ç­¾æ‹¥æœ‰ fullscreen-enabled ç±»æ—¶ï¼Œæ¿€æ´»ä»¥ä¸‹æ ·å¼ */

body.fullscreen-enabled .phone {
    width: 100vw; /* è§†å£å®½åº¦ï¼Œå æ»¡æ•´ä¸ªæµè§ˆå™¨çª—å£å®½åº¦ */
    height: 100vh; /* è§†å£é«˜åº¦ï¼Œå æ»¡æ•´ä¸ªæµè§ˆå™¨çª—å£é«˜åº¦ */
    border-radius: 0; /* ç§»é™¤åœ†è§’ */
    padding: 0; /* ç§»é™¤å†…è¾¹è· */
    background: transparent; /* è¾¹æ¡†èƒŒæ™¯å˜é€æ˜ */
    box-shadow: none; /* ç§»é™¤é˜´å½± */
    margin: 0; /* ç§»é™¤å¤–è¾¹è·ï¼Œç¡®ä¿å®Œå…¨è´´åˆ */
}

body.fullscreen-enabled .screen {
    border-radius: 0; /* å±å¹•ä¹Ÿç§»é™¤åœ†è§’ï¼Œä»¥åŒ¹é…çˆ¶å®¹å™¨ */
}

/* ç§»é™¤åˆ˜æµ·å±çš„é»‘è‰²é®æŒ¡ */

body.fullscreen-enabled .phone::before {
    display: none;
}

/* åŒæ—¶è®© body åœ¨å…¨å±æ—¶æ²¡æœ‰å†…è¾¹è· */

body.fullscreen-enabled {
    padding: 0;
}

.screen {
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #fef5f9 0%, #f0e6f5 100%);
    border-radius: 30px;
    overflow: hidden;
    position: relative;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    transition: background-image 0.5s ease-in-out;

    /* ğŸ”¥ğŸ”¥ğŸ”¥ åœ¨è¿™é‡Œæ·»åŠ è¿™ä¸¤è¡Œå¼ºåˆ¶è£å‰ªä¿®å¤ä»£ç  ğŸ”¥ğŸ”¥ğŸ”¥ */
    /* 1. è¿™è¡Œä»£ç åˆ©ç”¨é®ç½©å¼ºåˆ¶æŒ‰ç…§ border-radius å½¢çŠ¶è£å‰ªå­å…ƒç´  */
    -webkit-mask-image: -webkit-radial-gradient(white, black);

    /* 2. è¿™è¡Œä»£ç å¼€å¯ GPU åŠ é€Ÿï¼Œç¡®ä¿è£å‰ªåœ¨æ¸²æŸ“å±‚ç”Ÿæ•ˆï¼Œé˜²æ­¢é—ªçƒ */
    transform: translate3d(0, 0, 0);
}



.pages-wrapper {
    display: flex;
    width: 100%;
    height: 100%;
    will-change: transform;
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.pages-wrapper.no-transition {
    transition: none;
}

.page {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
}

.status-bar {
    display: flex;
    justify-content: space-between;
    padding: 40px 20px 12px;
    font-size: 18px;
    font-weight: 600;
    color: #1a1a1a;
    flex-shrink: 0;
    position: relative;
    z-index: 100;
}

.status-icons {
    display: flex;
    align-items: baseline;
    gap: 10px;
}

.status-icon-svg {
    width: 25px;
    height: 25px;
    fill: currentColor;
    display: block;
}

.battery-container {
    display: flex;
    align-items: center;
    gap: 1px;
    position: relative;
    top: -5px;
}

.battery-icon {
    position: relative;
    width: 34px;
    height: 17px;
}

.battery-icon svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.battery-level {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    left: 2px;
    right: 6px;
    height: 8px;
    background-color: #1a1a1a;
    border-radius: 2px;
    width: 0%;
    transition: width 0.5s ease;
}

.battery-level.low {
    background-color: #ff4757;
}

.charging-bolt {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 9px;
    height: 9px;
    fill: #1a1a1a;
    display: none;
}

.battery-container.charging .charging-bolt {
    display: block;
}

.battery-container.charging .battery-level {
    display: none;
}

.battery-text {
    font-size: 12px;
    font-weight: 600;
    line-height: 12px;
}

.time-weather-section {
    flex-shrink: 0;
    /* å·¦å³è¾¹è·ä» 20px å‡å°‘åˆ° 8px */
    padding: 0 8px 12px;
    position: relative;
    z-index: 50;
}

.top-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 12px;
    border-bottom: 1px solid rgba(168, 201, 245, 0.15);
}

.location-display {
    display: flex;
    align-items: center;
    gap: 6px;
}

.location-icon {
    font-size: 16px;
}

.location-text {
    font-size: 14px;
    color: #666;
    font-weight: 600;
}

.weather-display {
    cursor: pointer;
    padding: 6px 12px;
    border-radius: 12px;
    background: rgba(168, 201, 245, 0.1);
    transition: all 0.2s;
}

.weather-display:hover {
    background: rgba(168, 201, 245, 0.2);
    transform: scale(1.05);
}

.current-weather-icon {
    font-size: 28px;
    display: block;
}

.mood-section {
    display: flex;
    flex-direction: column;
    gap: 6px;
    cursor: pointer;
    padding: 12px;
    border-radius: 12px;
    background: linear-gradient(135deg, rgba(255, 240, 245, 0.5), rgba(255, 230, 240, 0.3));
    transition: all 0.2s;
}

.mood-section:hover {
    background: linear-gradient(135deg, rgba(255, 240, 245, 0.7), rgba(255, 230, 240, 0.5));
    transform: scale(1.02);
}

.mood-label {
    font-size: 11px;
    color: #888;
    font-weight: 600;
}

.mood-text {
    font-size: 15px;
    color: #333;
    font-weight: 500;
    min-height: 20px;
}

.mood-text.empty {
    color: #aaa;
    font-style: italic;
}

.weather-popup {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    border-radius: 16px;
    padding: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    z-index: 100;
    min-width: 200px;
}

.weather-popup-title {
    font-size: 13px;
    color: #666;
    font-weight: 600;
    margin-bottom: 12px;
    text-align: center;
}

.weather-options {
    display: flex;
    gap: 16px;
    justify-content: center;
}

.weather-option {
    font-size: 36px;
    cursor: pointer;
    padding: 8px;
    border-radius: 12px;
    transition: all 0.2s;
    opacity: 0.4;
}

.weather-option:hover {
    transform: scale(1.15);
    opacity: 0.7;
}

.weather-option.active {
    opacity: 1;
    background: rgba(168, 201, 245, 0.15);
    transform: scale(1.1);
}


.grid-container {
    flex: 1;
    padding: 12px 8px 120px;
    display: grid;
    /* ğŸ”´ ä¿®æ”¹ç‚¹ 1ï¼šæ”¹ä¸º 2 åˆ— */
    grid-template-columns: repeat(2, 1fr);
    /* ğŸ”´ ä¿®æ”¹ç‚¹ 2ï¼šæ”¹ä¸º 3 è¡Œ */
    grid-template-rows: repeat(3, 1fr);
    gap: 8px;
    position: relative;
    overflow-y: visible;
    align-content: start;
}

.grid-container::-webkit-scrollbar {
    display: none;
}

.app-icon {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    gap: 8px;
    cursor: pointer;
    transition: transform 0.15s ease;
    z-index: 10;
    user-select: none;
    padding: 4px;
}

.app-icon:active:not(.dragging) {
    transform: scale(0.95);
}

.app-icon.dragging {
    z-index: 150;
    opacity: 0.85;
    transform: scale(1.08) rotate(1deg);
    transition: none;
}

/* 3. æ ¸å¿ƒï¼šæ”¾å¤§åº”ç”¨å›¾æ ‡å®¹å™¨ */
.icon-wrapper {
    /* å°ºå¯¸ä» 62px å¢åŠ åˆ° 76px */
    width: 76px;
    height: 76px;
    flex-shrink: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
    /* åœ†è§’ç¨å¾®åŠ å¤§ */
    border-radius: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    /* å†…éƒ¨å›¾æ ‡/æ–‡å­—å­—ä½“æ”¾å¤§ */
    font-size: 38px;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08),
    0 1px 4px rgba(168, 201, 245, 0.15);
    pointer-events: none;
    overflow: hidden;
}

.icon-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.badge {
    position: absolute;
    top: -2px;
    right: 4px;
    background: #ff4757;
    color: white;
    border-radius: 10px;
    padding: 2px 5px;
    min-width: 18px;
    font-size: 10px;
    font-weight: 600;
    text-align: center;
    z-index: 15;
    box-shadow: 0 2px 4px rgba(255, 71, 87, 0.3);
    pointer-events: none;
}

.app-label {
    /* å­—ä½“ç¨å¾®åŠ å¤§ */
    font-size: 13px;
    color: #FFF;
    text-shadow: -1px -1px 0 rgba(165, 42, 42, 0.5),
    1px -1px 0 rgba(165, 42, 42, 0.5),
    -1px 1px 0 rgba(165, 42, 42, 0.5),
    1px 1px 0 rgba(165, 42, 42, 0.5);
    text-align: center;
    /* å…è®¸æ–‡å­—æ›´å®½ä¸€ç‚¹ */
    max-width: 84px;
    overflow: visible;
    white-space: nowrap;
    font-weight: 500;
    pointer-events: none;
    line-height: 1.2;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
}


.page-dots {
    position: absolute;
    bottom: 95px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 7px;
    z-index: 200;
}

.dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    backdrop-filter: blur(2px);
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.dot.active {
    background: rgba(255, 255, 255, 0.9);
    width: 18px;
    border-radius: 3.5px;
}



.edit-hint {
    position: absolute;
    top: 65px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 20px;
    border-radius: 22px;
    font-size: 12px;
    width: 200px;
    text-align: center;
    font-weight: 500;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 300;
    backdrop-filter: blur(10px);
}

.edit-hint.show {
    opacity: 1;
}

#editHint2 {
    display: none;
}

.settings-page, .config-page, .beautify-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1000;
    display: flex;
    flex-direction: column;
}

.settings-page.show, .config-page.show, .beautify-page.show {
    transform: translateX(0);
}

.config-page {
    z-index: 1001;
}

.settings-header {
    display: flex;
    align-items: center;
    padding: 45px 20px 20px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

.back-btn {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    background: rgba(168, 201, 245, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    transition: all 0.2s;
    color: #333;
    font-weight: bold;
}

.back-btn:active {
    transform: scale(0.9);
    background: rgba(168, 201, 245, 0.25);
}

.settings-title {
    flex: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    color: #333;
    margin-right: 36px;
}

.settings-content {
    flex: 1;
    overflow-y: auto;
    padding: 12px 0;
}

.settings-content::-webkit-scrollbar {
    display: none;
}

.settings-section {
    margin-bottom: 20px;
}

.section-title {
    padding: 12px 20px 8px;
    font-size: 12px;
    color: #666;
    font-weight: 600;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

.settings-item {
    background: white;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: background 0.2s;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.settings-item:first-of-type {
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.settings-item:last-of-type {
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
    border-bottom: none;
}

.settings-item:active {
    background: #f8f9fa;
}

.settings-icon {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    margin-right: 14px;
}

.settings-info {
    flex: 1;
}

.settings-label {
    font-size: 15px;
    color: #333;
    font-weight: 600;
    margin-bottom: 2px;
}

.settings-desc {
    font-size: 12px;
    color: #888;
}

.settings-arrow {
    font-size: 16px;
    color: #bbb;
    font-weight: bold;
}

.form-group {
    background: white;
    padding: 20px;
    margin-bottom: 2px;
}

.form-group:first-of-type {
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.form-group:last-of-type {
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
}

.voice-setting-section,
.sweetheart-field .voice-setting-input,
.library-section .voice-setting-input { /* ä¸ºç»Ÿä¸€è§’è‰²å¡å’Œå¯†å‹å¡ç‰‡å¢åŠ æ ·å¼ */
    margin-top: 10px;
}
.voice-setting-label,
.sweetheart-label .label-text { /* æ ‡ç­¾æ ·å¼å¤ç”¨ç°æœ‰ */
    font-size: 14px;
    font-weight: 600;
    color: #333; /* å¯ä»¥æ ¹æ®ä¸»é¢˜è°ƒæ•´ */
    margin-bottom: 8px;
}
.voice-setting-input,
.sweetheart-input,
.library-input { /* è¾“å…¥æ¡†æ ·å¼å¤ç”¨ç°æœ‰ */
    width: 100%;
    padding: 10px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.2s;
}
.voice-setting-input:focus,
.sweetheart-input:focus,
.library-input:focus {
    outline: none;
    border-color: #a8c9f5;
}

.form-label {
    display: block;
    font-size: 13px;
    color: #666;
    margin-bottom: 8px;
    font-weight: 600;
}

.form-input, .form-select {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.2s;
}

.form-input:focus, .form-select:focus {
    outline: none;
    border-color: #a8c9f5;
}

.btn-group {
    display: flex;
    gap: 8px;
    margin: 20px;
}

.save-btn, .test-btn, .fetch-btn {
    flex: 1;
    padding: 14px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s;
}

.save-btn {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.test-btn {
    background: linear-gradient(135deg, #4facfe, #00f2fe);
    color: white;
}

.fetch-btn {
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    color: white;
}

.save-btn:active, .test-btn:active, .fetch-btn:active {
    transform: scale(0.98);
}


.config-details {
    flex: 1;
    min-width: 0;
}

.delete-config-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #f1f2f6;
    border: none;
    color: #a4b0be;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-left: 12px;
    transition: background 0.2s ease,
    color 0.2s ease,
    transform 0.2s ease;
}

.delete-config-btn:hover {
    background: #ff4757;
    color: white;
    transform: scale(1.1) rotate(90deg);
}


.config-name {
    font-size: 15px;
    font-weight: 600;
    color: #333;
    margin-bottom: 4px;
}

.config-url {
    font-size: 12px;
    color: #888;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.add-new-btn {
    width: 100%;
    padding: 14px;
    background: white;
    border: 2px dashed #ddd;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    color: #888;
    cursor: pointer;
    transition: all 0.2s;
}

.add-new-btn:hover {
    border-color: #667eea;
    color: #667eea;
}

.app-preview-list {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
}

.app-preview-item {
    background: white;
    padding: 16px;
    margin-bottom: 12px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.preview-header {
    display: flex;
    align-items: center;
    margin-bottom: 12px;
}

.preview-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(255, 255, 255, 0.92));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    margin-right: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    overflow: hidden;
}

.preview-icon img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.preview-name {
    font-size: 15px;
    font-weight: 600;
    color: #333;
}

.upload-section {
    display: flex;
    gap: 8px;
    margin-top: 8px;
}

.upload-btn, .url-input-btn {
    flex: 1;
    padding: 8px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 12px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    background: white;
    font-weight: 600;
    color: #666;
}

.upload-btn:hover, .url-input-btn:hover {
    border-color: #a8c9f5;
    color: #667eea;
}

.file-input {
    display: none;
}

.url-input-box {
    margin-top: 8px;
    display: none;
}

.url-input-box.show {
    display: block;
}

.url-input-field {
    width: 100%;
    padding: 8px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 12px;
    margin-bottom: 6px;
}

.url-input-field:focus {
    outline: none;
    border-color: #a8c9f5;
}

.confirm-btn {
    width: 100%;
    padding: 8px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
}

.status-message {
    margin-top: 8px;
    font-size: 11px;
    color: #28a745;
    font-weight: 600;
}

.status-message.error {
    color: #dc3545;
}

.delete-time-btn, .delete-weather-btn, .delete-widget-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px;
    height: 24px;
    background: rgba(255, 71, 87, 0.9);
    border-radius: 50%;
    display: none;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    z-index: 250;
}

.time-card {
    position: relative;
}

.time-card.show-delete .delete-time-btn {
    display: flex;
}

.weather-card.show-delete .delete-weather-btn {
    display: flex;
}

.saved-widget-item {
    background: white;
    padding: 16px;
    margin-bottom: 12px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.saved-widget-name {
    font-size: 13px;
    font-weight: 600;
    color: #333;
    margin-bottom: 8px;
}

.restore-btn {
    flex: 1;
    padding: 8px;
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 12px;
    cursor: pointer;
}

.delete-saved-btn {
    flex: 1;
    padding: 8px;
    background: #f5f5f5;
    color: #666;
    border: none;
    border-radius: 8px;
    font-size: 12px;
    cursor: pointer;
}

/* ========== æ–°å¢ï¼šæ–‡ä»¶å¤¹æµ®å±‚æ ·å¼ ========== */
.folder-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(15px) saturate(180%);
    -webkit-backdrop-filter: blur(15px) saturate(180%);
    z-index: 500;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.folder-overlay.show {
    opacity: 1;
    visibility: visible;
}

.folder-modal {
    background: rgba(255, 255, 255, 0.8);
    border-radius: 24px;
    width: calc(100% - 40px);
    padding: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    transform: scale(0.95);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.folder-overlay.show .folder-modal {
    transform: scale(1);
}

.folder-header {
    text-align: center;
    padding-bottom: 16px;
}

/* ========== æ–°å¢ï¼šæ–‡ä»¶å¤¹åç§°ç¼–è¾‘æ ·å¼ (ä¿®æ­£ç‰ˆ) ========== */
#folderNameInput {
    /* ç»§æ‰¿çˆ¶å…ƒç´ çš„å­—ä½“æ ·å¼ */
    font-size: inherit;
    font-weight: inherit;
    color: inherit;
    font-family: inherit;

    /* ç§»é™¤è¾“å…¥æ¡†é»˜è®¤å¤–è§‚ */
    border: none;
    background: transparent;

    /* æ–‡æœ¬å±…ä¸­ */
    text-align: center;

    /* ç§»é™¤ç‚¹å‡»æ—¶çš„è½®å»“çº¿ */
    outline: none;

    /* å®½åº¦æ’‘æ»¡ï¼Œä¸æ ‡é¢˜ä¸€è‡´ */
    width: 100%;
    padding: 0;
    margin: 0;

    /* æ·»åŠ ä¸€ä¸ªç»†å¾®çš„ä¸‹åˆ’çº¿ï¼Œæç¤ºç”¨æˆ·æ­£åœ¨ç¼–è¾‘ */
    border-bottom: 2px solid #a0a0a0;
}

/* å½“æ–‡ä»¶å¤¹å¤´éƒ¨å¤„äºç¼–è¾‘çŠ¶æ€æ—¶ */
.folder-header.is-editing #folderName {
    display: none; /* éšè—åŸå§‹æ ‡é¢˜ */
}

.folder-header.is-editing #folderNameInput {
    /* â–¼â–¼â–¼ æ ¸å¿ƒä¿®æ­£ç‚¹åœ¨è¿™é‡Œ â–¼â–¼â–¼ */
    display: block !important; /* æ˜¾ç¤ºè¾“å…¥æ¡†ï¼Œå¹¶å¼ºåˆ¶è¦†ç›–å†…è”æ ·å¼ */
}


#folderName {
    font-size: 20px;
    font-weight: 600;
    color: #1d1d1f;
    margin: 0;
}

.folder-grid-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 14px;
    align-content: start;
}

/* æ–‡ä»¶å¤¹æµ®å±‚ä¸­å›¾æ ‡çš„æ ·å¼, å®ƒå¤ç”¨äº†.app-iconçš„ç»“æ„ */
.folder-grid-container .app-icon {
    position: relative; /* ä»absoluteæ”¹ä¸ºrelativeï¼Œé€‚åº”gridå¸ƒå±€ */
    top: auto;
    left: auto;
    width: auto;
    height: auto;
}

/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µå…¨æ–°çš„CSSä»£ç  ========== */

.folder-mini-icon img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* ç¡®ä¿å›¾ç‰‡ä¸å˜å½¢åœ°å¡«æ»¡å®¹å™¨ */
    border-radius: 4px; /* ç»™å°å›¾æ ‡ä¹ŸåŠ ä¸Šä¸€ç‚¹åœ†è§’ï¼Œæ›´ç¾è§‚ */
}

/* ========== ç»“æŸï¼šç²˜è´´å…¨æ–°çš„CSSä»£ç  ========== */


.contacts-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
    transform: translateY(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1002;
    display: flex;
    flex-direction: column;
}

.contacts-page.show {
    transform: translateY(0);
}

/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µã€ä¿®æ­£ç‰ˆã€‘CSS ä»£ç  ========== */

.contacts-header {
    display: flex;
    align-items: center;
    padding: 45px 20px 20px;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    position: relative;
    z-index: 10; /* <<< --- æ–°å¢ï¼šæå‡å¤´éƒ¨çš„å †å å±‚çº§ --- <<< */
}

.contacts-search {
    flex: 1;
    padding: 10px 16px;
    background: rgba(168, 201, 245, 0.1);
    border: none;
    border-radius: 20px;
    font-size: 14px;
    margin: 0 12px;
}

.contacts-search:focus {
    outline: none;
    background: rgba(168, 201, 245, 0.2);
}

.add-contact-btn {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    background: rgba(168, 201, 245, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    transition: all 0.2s;
    color: #333;
    font-weight: bold;
}

.add-contact-btn:active {
    transform: scale(0.9);
    background: rgba(168, 201, 245, 0.25);
}

.contact-menu {
    position: absolute;
    top: 100%;
    right: 20px;
    margin-top: 8px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    overflow: hidden;
    display: none;
    z-index: 1003;
    min-width: 160px;
}

.contact-menu.show {
    display: block;
}

.contact-menu-item {
    padding: 14px 20px;
    cursor: pointer;
    transition: background 0.2s;
    font-size: 14px;
    color: #333;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.contact-menu-item:last-child {
    border-bottom: none;
}

.contact-menu-item:active {
    background: #f8f9fa;
}

.contacts-list {
    flex: 1;
    overflow-y: auto;
    padding: 12px 0;
}

.contacts-list::-webkit-scrollbar {
    display: none;
}

.contact-item {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    background: white;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    cursor: pointer;
    transition: background 0.2s;
}

.contact-item:active {
    background: #f8f9fa;
}

.contact-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea, #764ba2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: white;
    margin-right: 12px;
    flex-shrink: 0;
}

.contact-info {
    flex: 1;
    min-width: 0;
}

.contact-name {
    font-size: 15px;
    font-weight: 600;
    color: #333;
    margin-bottom: 2px;
}

.contact-status {
    font-size: 12px;
    color: #888;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.contact-badge {
    background: #ff4757;
    color: white;
    border-radius: 10px;
    padding: 2px 8px;
    min-width: 18px;
    font-size: 11px;
    font-weight: 600;
    text-align: center;
}

.wallpaper-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 12px;
    padding: 0 20px;
}

.wallpaper-thumbnail {
    width: 100%;
    padding-top: 150%;
    border-radius: 12px;
    background-size: cover;
    background-position: center;
    cursor: pointer;
    border: 3px solid transparent;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transition: all 0.2s ease;
    position: relative;
}

.wallpaper-thumbnail:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
}

.wallpaper-thumbnail.active {
    border-color: #667eea;
    transform: scale(1.02);
}

.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    z-index: 3000 !important;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    backdrop-filter: blur(5px);
    overscroll-behavior: contain;
}

.modal-overlay.show {
    opacity: 1;
    visibility: visible;
}

.character-card-modal {
    background: #fff;
    border: 6px solid #000;
    border-radius: 24px;
    width: 100%;
    max-width: 330px;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
    display: flex;
    flex-direction: column;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    transform: scale(0.95);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.modal-overlay.show .character-card-modal {
    transform: scale(1);
}

.character-card-content {
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

/* é¡¶éƒ¨ä¿¡æ¯åŒºï¼šç®€å•çš„ä¸¤åˆ— Flex å¸ƒå±€ */
.top-info-section {
    display: flex;
    gap: 16px; /* å·¦å³ä¸¤åˆ—çš„é—´è· */
    align-items: flex-start;
}

/* 1. å·¦ä¾§å¤´åƒï¼šå›ºå®šå®½åº¦ï¼Œä¸æ”¶ç¼© */
.character-avatar {
    flex-shrink: 0;
    width: 90px;
    height: 90px;
    border: 2px solid #eee;
    border-radius: 12px;
    background: #f8f8f8;
    cursor: pointer;
    overflow: hidden;
}

.character-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* 2. å³ä¾§æ ¸å¿ƒä¿¡æ¯ï¼šå æ®æ‰€æœ‰å‰©ä½™ç©ºé—´ */
.core-details {
    flex: 1; /* å…³é”®ï¼šå æ®æ‰€æœ‰å‰©ä½™ç©ºé—´ */
    min-width: 0; /* å®‰å…¨æªæ–½ï¼Œé˜²æ­¢å†…å®¹æº¢å‡º */
    display: flex;
    flex-direction: column;
    gap: 12px; /* å§“åå’Œæ€§åˆ«é€‰é¡¹ä¹‹é—´çš„å‚ç›´é—´è· */
    padding-top: 4px; /* å¾®è°ƒï¼Œè®©å§“åè¾“å…¥æ¡†ä¸å¤´åƒé¡¶éƒ¨æ›´åè°ƒ */
}

.core-details input[type="text"] {
    width: 100%;
    border: none;
    border-bottom: 2px solid #ccc;
    padding: 6px 0;
    font-size: 20px;
    font-weight: bold;
    background: transparent;
    color: #000;
}

.core-details input[type="text"]:focus {
    outline: none;
    border-bottom-color: #000;
}

/* æ€§åˆ«é€‰é¡¹ï¼šæ¨ªå‘æ’åˆ— */
.character-gender-selection {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    gap: 18px; /* åŠ å¤§é€‰é¡¹é—´è·ï¼Œæ›´ç¾è§‚ */
    align-items: center;
}

.character-gender-selection label {
    display: flex;
    align-items: center;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: #555;
}

.character-gender-selection input {
    margin-right: 6px;
}


.persona-section {
    width: 100%;
}

.persona-section textarea {
    width: 100%;
    height: 100px;
    padding: 12px;
    border: 2px solid #eee;
    border-radius: 12px;
    background: #f8f8f8;
    font-size: 14px;
    color: #333;
    resize: vertical;
    transition: border-color 0.2s, background-color 0.2s;
}

.persona-section textarea:focus {
    outline: none;
    border-color: #aaa;
    background: #fff;
}

.character-card-footer {
    display: flex;
    background: #f8f8f8;
    border-top: 2px solid #eee;
    border-bottom-left-radius: 20px;
    border-bottom-right-radius: 20px;
    overflow: hidden;
}

.character-card-btn {
    flex: 1;
    padding: 14px;
    border: none;
    background: transparent;
    font-size: 15px;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s;
    color: #888;
}

.character-card-btn:hover {
    background: #eee;
}

.character-card-btn.save {
    background: #000;
    color: #fff;
}

.character-card-btn.save:hover {
    background: #333;
}

.contact-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* â–¼â–¼â–¼ ç¬¬2æ­¥ï¼šåœ¨è¿™é‡Œç²˜è´´æ–°å¢çš„CSSä»£ç  â–¼â–¼â–¼ */
/* ========== è§’è‰²å¡ä¸­çš„ä¸–ç•Œä¹¦åŒºåŸŸæ ·å¼ ========== */
.character-card-content {
    max-height: 70vh; /* é™åˆ¶æœ€å¤§é«˜åº¦ï¼Œä¸ºæ»šåŠ¨æ¡åšå‡†å¤‡ */
    overflow-y: auto; /* è¶…å‡ºéƒ¨åˆ†å¯æ»šåŠ¨ */
}

.character-card-content::-webkit-scrollbar {
    width: 6px;
}

.character-card-content::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
}

.character-card-content::-webkit-scrollbar-track {
    background: #f1f1f1;
}

.character-worldbook-section {
    margin-top: 10px;
}

.char-wb-toggle {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background-color: #f8f8f8;
    border: 2px solid #eee;
    border-radius: 8px;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.2s;
}

.char-wb-toggle:hover {
    background-color: #f0f0f0;
}

.char-wb-toggle-label {
    font-size: 14px;
    font-weight: 600;
    color: #333;
}

.char-wb-toggle-arrow {
    font-size: 12px;
    color: #888;
    transition: transform 0.3s ease;
}

.char-wb-toggle-arrow.open {
    transform: rotate(180deg);
}

.char-wb-list {
    margin-top: 8px;
    padding: 8px;
    background: #fdfdfd;
    border: 2px solid #eee;
    border-radius: 10px;
    max-height: 150px;
    overflow-y: auto;
}

.char-wb-item {
    display: flex;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid #f0f0f0;
    cursor: pointer;
}

.char-wb-item:last-child {
    border-bottom: none;
}

.char-wb-item input[type="checkbox"] {
    margin-right: 10px;
    cursor: pointer;
    accent-color: #555; /* è®©å¤é€‰æ¡†é¢œè‰²æ›´æ­ */
}

.char-wb-item label {
    flex: 1;
    cursor: pointer;
    font-size: 14px;
    color: #555;
}

/* â–²â–²â–² CSSä»£ç ç²˜è´´ç»“æŸ â–²â–²â–² */


.contact-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.avatar-action-sheet.show {
    opacity: 1;
    visibility: visible;
}

.action-sheet-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
}

.action-sheet-options {
    position: relative;
    z-index: 1;
    background: #f0f2f5;
    padding: 8px;
    margin: 8px;
    border-radius: 14px;
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border: none;
    outline: none;
    box-shadow: none;
}

.avatar-action-sheet.show .action-sheet-options {
    transform: translateY(0);
}


.success-modal {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 2500;
    display: none;
    justify-content: center;
    align-items: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    backdrop-filter: blur(4px);
}

.success-modal.show {
    opacity: 1;
}

.modal-content {
    background: white;
    padding: 24px 32px;
    border-radius: 16px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.success-modal.show .modal-content {
    transform: scale(1);
}

.modal-content h3 {
    margin: 0 0 8px;
    font-size: 18px;
    color: #333;
}

.modal-content p {
    margin: 0;
    font-size: 14px;
    color: #666;
}

/* --- å¤åˆ¶å¹¶ç²˜è´´è¿™æ®µä»£ç  --- */

.settings-item {
    justify-content: space-between;
}

.settings-action {
    flex-shrink: 0;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 44px;
    height: 24px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 24px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 2px;
    bottom: 2px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: #667eea;
}

input:checked + .slider:before {
    transform: translateX(20px);
}

/* ========== æ™®é€šèŠå¤©çš„æ¶ˆæ¯æ“ä½œèœå• ========== */
.chat-page .message-action-sheet {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1020;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.chat-page .message-action-sheet.show {
    opacity: 1;
    visibility: visible;
}

.chat-page .message-action-sheet .action-sheet-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
}

.chat-page .message-action-sheet .action-sheet-options {
    position: relative;
    z-index: 1;
    background: #f0f2f5;
    padding: 8px;
    margin: 8px;
    border-radius: 14px;
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.chat-page .message-action-sheet.show .action-sheet-options {
    transform: translateY(0);
}

/* ========== å¯†å‹èŠå¤©çš„æ¶ˆæ¯æ“ä½œèœå• ========== */
.sweetheart-chat-page .message-action-sheet {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1020;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.sweetheart-chat-page .message-action-sheet.show {
    opacity: 1;
    visibility: visible;
}

.sweetheart-chat-page .message-action-sheet .action-sheet-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
}

.sweetheart-chat-page .message-action-sheet .action-sheet-options {
    position: relative;
    z-index: 1;
    background: #f0f2f5;
    padding: 8px;
    margin: 8px;
    border-radius: 14px;
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.sweetheart-chat-page .message-action-sheet.show .action-sheet-options {
    transform: translateY(0);
}


/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µå…¨æ–°çš„ CSS ä»£ç  ========== */

/* å¯†å‹èŠå¤©è®¾ç½®é¡µé¢ - ä¸»å®¹å™¨ */
.chat-settings-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transform: translateX(100%); /* é»˜è®¤ä»å³ä¾§éšè— */
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1007; /* å±‚çº§é«˜äºèŠå¤©é¡µé¢ï¼Œä½äºæ¨¡æ€æ¡† */
    display: flex;
    flex-direction: column;
}

/* å½“æœ‰ .show ç±»æ—¶æ»‘å…¥ */
.chat-settings-page.show {
    transform: translateX(0);
}

/* å¯†å‹èŠå¤©è®¾ç½®é¡µé¢çš„ç‰¹å®šä¸»é¢˜ */
#sweetheartChatSettingsPage {
    background: linear-gradient(180deg, #FFF0F5 0%, #FFE4E9 100%); /* å¯çˆ±çš„ç²‰è‰²æ¸å˜ */
}

#sweetheartChatSettingsPage .settings-header {
    background: linear-gradient(135deg, #FFB6C1, #FFC0D9); /* å¤´éƒ¨ä½¿ç”¨æ›´æ·±çš„ç²‰è‰² */
}

#sweetheartChatSettingsPage .settings-title {
    color: white; /* æ ‡é¢˜æ–‡å­—ä¸ºç™½è‰² */
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

#sweetheartChatSettingsPage .back-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

#sweetheartChatSettingsPage .section-title {
    color: #C7828F; /* èŠ‚æ ‡é¢˜ä½¿ç”¨ç²‰æ£•è‰² */
}

#sweetheartChatSettingsPage .settings-item {
    background: rgba(255, 255, 255, 0.8); /* é€‰é¡¹ä½¿ç”¨åŠé€æ˜ç™½è‰² */
    border-radius: 12px;
    margin: 0 16px 8px; /* ä¸ºé€‰é¡¹æ·»åŠ åœ†è§’å’Œè¾¹è· */
    border-bottom: none; /* ç§»é™¤é»˜è®¤çš„ä¸‹åˆ’çº¿ */
}

#sweetheartChatSettingsPage .settings-item:first-of-type {
    border-radius: 12px;
}

#sweetheartChatSettingsPage .settings-item:last-of-type {
    border-radius: 12px;
}

#sweetheartChatSettingsPage .settings-label {
    color: #8D6E63; /* é€‰é¡¹æ ‡ç­¾ä½¿ç”¨æ£•è‰² */
}

#sweetheartChatSettingsPage .settings-desc {
    color: #BCAAA4; /* æè¿°æ–‡å­—ä½¿ç”¨æµ…æ£•è‰² */
}

#sweetheartChatSettingsPage .settings-arrow {
    color: #FFC0D9; /* ç®­å¤´ä½¿ç”¨ç²‰è‰² */
}

/* ========== ç»“æŸï¼šç²˜è´´å…¨æ–°çš„ CSS ä»£ç  ========== */

/* style.css */

/* ========== ä»£ç å—ä¸å¤åˆ¶æŒ‰é’®æ ·å¼ (æŒ‰é’®åœ¨preå†…éƒ¨ç‰ˆ) ========== */

/* 1. ä»£ç å—åŒ…è£…å™¨ */
.code-block-wrapper {
    position: relative;
    display: block;
    margin: 0;
    width: 100%;
    max-width: 100%;
}

/* 2. pre å…ƒç´ æ ·å¼ - ä½œä¸ºæŒ‰é’®çš„å®šä½å®¹å™¨ */
.code-block-wrapper pre {
    /*!* é‡è¦ï¼špre éœ€è¦ä½œä¸ºå®šä½å®¹å™¨ *!*/
    /*position: relative;*/

    /* åŸºç¡€æ ·å¼ */
    background-color: #1e1e1e;
    color: #d4d4d4;
    /* å¢åŠ é¡¶éƒ¨å†…è¾¹è·ï¼Œä¸ºæŒ‰é’®ç•™å‡ºç©ºé—´ */
    padding: 36px 12px 12px 12px; /* ä»36pxå¢åŠ åˆ°45px */
    border-radius: 8px;
    font-family: 'Consolas', 'Monaco', 'Menlo', monospace;
    font-size: 13px;
    line-height: 1.5;

    /* å¸ƒå±€æ ·å¼ */
    margin: 0;
    width: 100%;
    box-sizing: border-box;

    /* æ–‡æœ¬å¤„ç† */
    white-space: pre-wrap;
    word-break: break-all;
    overflow-x: auto;

    /* ç¡®ä¿ pre æ˜¯å—çº§å…ƒç´  */
    display: block;
}

/* 3. å¤åˆ¶æŒ‰é’® - å®šä½åœ¨preå†…éƒ¨é¡¶éƒ¨ */
.copy-code-btn {
    /* ç»å¯¹å®šä½åœ¨ pre å†…éƒ¨çš„å³ä¸Šè§’ */
    position: absolute;
    top: 8px; /* è·ç¦»é¡¶éƒ¨çš„è·ç¦» */
    right: 8px; /* è·ç¦»å³è¾¹çš„è·ç¦»ï¼Œä¸preçš„paddingå¯¹é½ */
    z-index: 10;

    /* è°ƒå¤§æŒ‰é’®å°ºå¯¸ */
    min-width: auto;
    height: auto;
    padding: 6px 8px; /* ä» 6px 10px å¢åŠ åˆ° 8px 14px */

    /* å¤–è§‚æ ·å¼ */
    background: rgba(255, 255, 255, 0.12); /* ç¨å¾®æé«˜ä¸é€æ˜åº¦ */
    border: 1px solid rgba(255, 255, 255, 0.25);
    border-radius: 8px; /* ç¨å¾®å¢å¤§åœ†è§’ */
    color: #b0b0b0; /* ç¨å¾®æäº®é¢œè‰² */

    /* ä½¿ç”¨ flexbox ç¡®ä¿å†…å®¹å®Œç¾å±…ä¸­ */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px; /* å¢åŠ å›¾æ ‡å’Œæ–‡å­—çš„é—´è· */

    /* è°ƒå¤§å­—ä½“ */
    font-size: 14px !important; /* ä»12pxå¢åŠ åˆ°14px */
    font-weight: 500; /* ç¨å¾®åŠ ç²— */
    line-height: 1;
    white-space: nowrap;

    /* äº¤äº’æ ·å¼ */
    cursor: pointer;
    opacity: 0;
    transition: all 0.2s ease-in-out;

    /* æ·»åŠ è½»å¾®é˜´å½±ï¼Œå¢åŠ å±‚æ¬¡æ„Ÿ */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* 4. SVG å›¾æ ‡æ ·å¼ - è°ƒå¤§å°ºå¯¸ */
.copy-code-btn svg {
    /* å¢å¤§å›¾æ ‡å°ºå¯¸ */
    width: 16px; /* ä»14pxå¢åŠ åˆ°16px */
    height: 16px;

    /* ç¡®ä¿ä¸ä¼šè¢«å‹ç¼©æˆ–æ‹‰ä¼¸ */
    flex-shrink: 0;
    flex-grow: 0;

    /* é¢œè‰²ç»§æ‰¿ */
    fill: currentColor;

    /* å‚ç›´å¯¹é½ */
    vertical-align: middle;
    display: block;
}

/* 5. æŒ‰é’®æ–‡æœ¬æ ·å¼ */
.copy-code-btn span {
    font-size: inherit;
    line-height: 1;
    vertical-align: middle;
    font-weight: inherit;
}

/* 6. é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæŒ‰é’® */
.code-block-wrapper:hover .copy-code-btn {
    opacity: 1;
}

/* 7. æŒ‰é’®æ‚¬åœæ•ˆæœ */
.copy-code-btn:hover {
    background: rgba(255, 255, 255, 0.18);
    color: #e0e0e0;
    border-color: rgba(255, 255, 255, 0.3);
    /* æ‚¬åœæ—¶ç¨å¾®æ”¾å¤§ */
    transform: scale(1.05);
}

/* 8. æŒ‰é’®æŒ‰ä¸‹æ•ˆæœ */
.copy-code-btn:active {
    transform: scale(0.98);
}

/* 9. å¤åˆ¶æˆåŠŸçŠ¶æ€ */
.copy-code-btn.copied {
    background-color: #28a745;
    color: white;
    border-color: #28a745;
    opacity: 1;
}

/* 10. ç‰¹æ®Šæƒ…å†µï¼šå½“ä»£ç å—åœ¨èŠå¤©æ°”æ³¡ä¸­æ—¶ */
.chat-bubble .code-block-wrapper {
    margin: -12px;
    width: calc(100% + 24px);
}

/* 11. ç¡®ä¿æ°”æ³¡åªåŒ…å«ä»£ç å—æ—¶çš„æ ·å¼æ­£ç¡® */
.chat-bubble:has(.code-block-wrapper) {
    padding: 0;
    background: transparent;
}

/* 12. ä»£ç æ»šåŠ¨æ¨¡å¼çš„ç‰¹æ®Šå¤„ç† */
body.code-scrolling-enabled .code-block-wrapper pre {
    white-space: pre;
    word-break: normal;
    overflow-x: auto;
    /* â–¼â–¼â–¼ æ–°å¢ä»¥ä¸‹å…³é”®æ ·å¼ â–¼â–¼â–¼ */
    /* å…è®¸ IOS è®¾å¤‡æƒ¯æ€§æ»šåŠ¨ï¼Œæ»‘åŠ¨æ›´æµç•… */
    -webkit-overflow-scrolling: touch;
    /* æ˜ç¡®å‘Šè¯‰æµè§ˆå™¨æ¨ªå‘æ»‘åŠ¨æ˜¯å…è®¸çš„ï¼Œä¸è¦è¢«çˆ¶çº§ JS æ•è· */
    touch-action: pan-x;
    /* â–²â–²â–² æ–°å¢ç»“æŸ â–²â–²â–² */
    /* æ»šåŠ¨æ¨¡å¼ä¸‹å¯èƒ½éœ€è¦æ›´å¤šé¡¶éƒ¨ç©ºé—´ */
    padding-top: 50px;
}

/* 13. ç¡®ä¿æŒ‰é’®ä¸ä¼šå½±å“ä»£ç å†…å®¹çš„å¸ƒå±€ */
.code-block-wrapper pre code {
    display: block;
    /* ç¡®ä¿ä»£ç å†…å®¹ä¸ä¼šä¸æŒ‰é’®é‡å  */
    position: relative;
    z-index: 1;
}

/* ========== ä»£ç å—æ°”æ³¡å¯¹é½ä¿®å¤ ========== */

/* 1. å½“æ°”æ³¡å†…åªåŒ…å«ä»£ç å—æ—¶ï¼Œç§»é™¤æ°”æ³¡çš„é»˜è®¤æ ·å¼ */
.chat-bubble:has(.code-block-wrapper:only-child) {
    padding: 0 !important;
    background: transparent !important;
    box-shadow: none !important;
    border-radius: 0 !important;
    max-width: 100%; /* å…è®¸ä»£ç å—ä½¿ç”¨å…¨éƒ¨å¯ç”¨å®½åº¦ */
}

/* 2. ç¡®ä¿ä»£ç å—æœ¬èº«æœ‰æ­£ç¡®çš„åœ†è§’å’Œé˜´å½± */
.chat-bubble .code-block-wrapper:only-child pre {
    border-radius: 12px; /* ä¸æ™®é€šæ°”æ³¡ä¸€è‡´çš„åœ†è§’ */
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05); /* ä¸æ™®é€šæ°”æ³¡ä¸€è‡´çš„é˜´å½± */
}

/* 3. ä¿®å¤ä»£ç å—çš„å®½åº¦ï¼Œç¡®ä¿ä¸æ™®é€šæ°”æ³¡ä¸€è‡´ */
.message-row .code-block-wrapper {
    max-width: calc(100vw - 120px); /* ä¸æ™®é€šæ°”æ³¡çš„ max-width ä¿æŒä¸€è‡´ */
    width: fit-content;
}

/* 4. ç¡®ä¿ä»£ç å—åœ¨å‘é€/æ¥æ”¶æ—¶çš„å¯¹é½æ­£ç¡® */
.message-row.sent .code-block-wrapper {
    margin-left: auto; /* å‘é€çš„ä»£ç å—å³å¯¹é½ */
}

.message-row.received .code-block-wrapper {
    margin-right: auto; /* æ¥æ”¶çš„ä»£ç å—å·¦å¯¹é½ */
}

/* 5. ç§»é™¤ä¹‹å‰å¯èƒ½å¯¼è‡´é—®é¢˜çš„è´Ÿè¾¹è· */
.chat-bubble .code-block-wrapper {
    margin: 0 !important; /* è¦†ç›–ä¹‹å‰çš„ margin: -12px */
    width: 100% !important; /* è¦†ç›–ä¹‹å‰çš„ calc(100% + 24px) */
}

/* 6. å¦‚æœæµè§ˆå™¨ä¸æ”¯æŒ :has é€‰æ‹©å™¨ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ */
@supports not selector(:has(*)) {
    /* ä¸ºåªåŒ…å«ä»£ç å—çš„æ°”æ³¡æ·»åŠ ç‰¹æ®Šç±»ï¼ˆéœ€è¦åœ¨ JS ä¸­é…åˆæ·»åŠ ï¼‰ */
    .chat-bubble.code-only {
        padding: 0 !important;
        background: transparent !important;
        box-shadow: none !important;
        border-radius: 0 !important;
    }

    .chat-bubble.code-only .code-block-wrapper pre {
        border-radius: 12px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }
}

/* 7. ç¡®ä¿ç®€æ´æ¨¡å¼ä¸‹ä»£ç å—ä¹Ÿèƒ½æ­£ç¡®æ˜¾ç¤º */
.chat-page.simple-style .code-block-wrapper pre {
    background-color: #1e1e1e; /* ä¿æŒæ·±è‰²èƒŒæ™¯ */
    padding: 45px 12px 12px 12px; /* ä¿æŒåŸæœ‰å†…è¾¹è· */
}

/* 8. è°ƒæ•´ä»£ç æ»šåŠ¨æ¨¡å¼çš„ç‰¹æ®Šå¤„ç† */
body.code-scrolling-enabled .code-block-wrapper {
    max-width: calc(100vw - 120px);
}


/* ========== å¼€å§‹ï¼šåˆ†æ®µé€‰æ‹©å™¨UIæ ·å¼ ========== */

.segmented-control {
    display: flex;
    background-color: #e9e9eb;
    border-radius: 8px;
    padding: 2px;
}

.segmented-option {
    flex: 1;
    padding: 6px 0;
    text-align: center;
    font-size: 13px;
    font-weight: 600;
    color: #555;
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.2s ease-in-out;
}

.segmented-option.active {
    background-color: white;
    color: #000;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}





/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µå…¨æ–°çš„ CSS ä»£ç å— ========== */

/* 1. è°ƒæ•´è¾“å…¥åŒºåŸŸï¼Œä¸ºæ–°æŒ‰é’®è…¾å‡ºç©ºé—´ */

.chat-input-area {
    position: relative; /* è¿™æ˜¯è®©èœå•å®šä½çš„å…³é”®ï¼ */
}

/* 2. é™„ä»¶èœå•å®¹å™¨çš„æ ·å¼ */

.attachment-menu {
    position: absolute; /* ç›¸å¯¹äº .chat-input-area å®šä½ */
    bottom: 60px; /* å®šä½åœ¨è¾“å…¥æ¡†ä¸Šæ–¹ */
    left: 12px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    display: flex;
    gap: 16px;
    padding: 12px;

    /* é»˜è®¤éšè—çš„åŠ¨ç”»å±æ€§ */
    opacity: 0;
    transform: translateY(10px);
    visibility: hidden;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 10;
}

/* 3. å½“èœå•æ‹¥æœ‰ .show ç±»æ—¶ï¼Œå°†å®ƒæ˜¾ç¤ºå‡ºæ¥ */

.attachment-menu.show {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
}

/* 4. èœå•ä¸­æ¯ä¸ªé€‰é¡¹çš„æ ·å¼ */

.attachment-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

/* 5. é€‰é¡¹ä¸­çš„å›¾æ ‡æ ·å¼ */

.attachment-icon {
    width: 56px;
    height: 56px;
    background-color: #f0f2f5;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    transition: transform 0.2s;
}

.attachment-item:hover .attachment-icon {
    transform: scale(1.05);
}

/* 6. é€‰é¡¹ä¸­çš„æ–‡å­—æ ‡ç­¾æ ·å¼ */

.attachment-label {
    font-size: 12px;
    color: #6c757d;
    font-weight: 500;
}

/* 7. è°ƒæ•´æ—§çš„ #addMsgBtnï¼Œç°åœ¨å®ƒå˜æˆäº†â€œ+â€æŒ‰é’®ï¼Œæ‰€ä»¥æ ·å¼ä¹Ÿéœ€è¦æ”¹ä¸€ä¸‹ */

#addMsgBtn {
    display: none; /* éšè—æ—§çš„æ·»åŠ æŒ‰é’®ï¼Œç°åœ¨è¢«å‘é€æŒ‰é’®æ›¿ä»£ */
}

/* === çŒ«å’ªèƒ¡é¡»æ—¶é—´å¡ç‰‡CSS - å¼€å§‹ === */

/* 1. å¤–å±‚ .time-card å®¹å™¨ä¿æŒç›¸å¯¹å®šä½ï¼Œä½œä¸ºèƒ¡é¡»çš„å®šä½é”šç‚¹ */
.time-card {
    position: relative;
    padding: 0;
    overflow: visible;
    background: none;
    border: none;
    box-shadow: none;
    backdrop-filter: none;
    margin-bottom: 24px;
}

/* éšè—ä¸å†éœ€è¦çš„æ—§å…ƒç´  */
.time-card .card-background-wrapper {
    display: none;
}

.time-card .final-time-container::before,
.time-card .final-time-container::after {
    display: none;
}

/* 2. æ–°å¢çš„ .whiskers-bg å±‚ï¼Œè¿™æ˜¯å®ç°æ•ˆæœçš„æ ¸å¿ƒ */
.whiskers-bg {
    position: relative; /* ä½œä¸ºèƒ¡é¡»ä¼ªå…ƒç´ çš„å®šä½å‚è€ƒ */
    width: 75%; /* æ§åˆ¶å¡ç‰‡å®½åº¦ï¼Œæ¯”ä¹‹å‰çª„ä¸€ç‚¹æ›´å¯çˆ± */
    margin: 0 auto; /* æ°´å¹³å±…ä¸­ */
    padding: 12px 20px;
    /* æ ¸å¿ƒï¼šæ£•è‰²èƒŒæ™¯ */
    background: #A1887F; /* ä¸€ä¸ªæŸ”å’Œçš„æ£•è‰² */
    border-radius: 20px; /* å¯çˆ±çš„åœ†è§’ */
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12); /* æŸ”å’Œçš„é˜´å½± */
    border: 2px solid #ffffff; /* æ·»åŠ ç™½è‰²è¾¹æ¡†å¢åŠ è´¨æ„Ÿ */

    /* ä¸ºèƒ¡é¡»ç•™å‡ºç©ºé—´ */
    margin-left: auto;
    margin-right: auto;
}

/* 3. ä½¿ç”¨ä¼ªå…ƒç´ åˆ›å»ºå·¦è¾¹çš„ä¸¤æ¡èƒ¡é¡» */
.whiskers-bg::before {
    content: '';
    position: absolute;
    z-index: -1; /* å°†èƒ¡é¡»ç½®äºèƒŒæ™¯å±‚ä¹‹ä¸‹ */
    top: 50%;

    /* å®šä½åˆ°å·¦è¾¹å¹¶ä¼¸å‡ºå»ä¸€ç‚¹ */
    left: -20px;

    /* èƒ¡é¡»çš„å°ºå¯¸ */
    width: 40px;
    height: 10px; /* ä¸¤æ¡èƒ¡é¡»ä¹‹é—´çš„é—´è· */

    /* ç”¨è¾¹æ¡†ç”»å‡ºä¸¤æ¡çº¿ */
    border-top: 2.5px solid #FFC0D9; /* ç²‰è‰² */
    border-bottom: 2.5px solid #FFC0D9; /* ç²‰è‰² */

    /* æ—‹è½¬å’Œå‚ç›´å±…ä¸­ */
    transform: translateY(-50%) rotate(-20deg);
}

/* 4. ä½¿ç”¨ä¼ªå…ƒç´ åˆ›å»ºå³è¾¹çš„ä¸¤æ¡èƒ¡é¡» */
.whiskers-bg::after {
    content: '';
    position: absolute;
    z-index: -1;
    top: 50%;

    /* å®šä½åˆ°å³è¾¹å¹¶ä¼¸å‡ºå»ä¸€ç‚¹ */
    right: -20px;

    width: 40px;
    height: 10px;
    border-top: 2.5px solid #FFC0D9;
    border-bottom: 2.5px solid #FFC0D9;

    /* å‘ç›¸åæ–¹å‘æ—‹è½¬ */
    transform: translateY(-50%) rotate(20deg);
}


/* 5. å†…éƒ¨çš„æ—¶é—´å®¹å™¨ .final-time-containerï¼Œç°åœ¨åªè´Ÿè´£å¸ƒå±€ï¼Œä¸å†æœ‰èƒŒæ™¯è‰² */
.time-card .final-time-container {
    display: flex;
    flex-direction: row;
    align-items: baseline;
    justify-content: center;
    gap: 10px;
    /* ç§»é™¤æ‰€æœ‰èƒŒæ™¯ã€è¾¹æ¡†å’Œé˜´å½±æ ·å¼ */
    width: 100%;
    margin: 0;
    padding: 0;
    background: none;
    backdrop-filter: none;
    border-radius: 0;
    border: none;
    box-shadow: none;
    position: relative;
    z-index: 2;
}

/* 6. è°ƒæ•´æ—¶é—´å­—ä½“é¢œè‰²ï¼Œç¡®ä¿åœ¨æ£•è‰²èƒŒæ™¯ä¸Šæ¸…æ™°å¯è§ */
#finalMainTime {
    font-size: 38px;
    font-weight: 700;
    color: #FFF; /* æ”¹ä¸ºç™½è‰² */
    line-height: 1;
    margin: 0;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2); /* è½»å¾®çš„é˜´å½±å¢åŠ å¯è¯»æ€§ */
    letter-spacing: -1px;
}

/* 7. è°ƒæ•´æ—¥æœŸå­—ä½“é¢œè‰² */
#finalMainDate {
    font-size: 13px;
    font-weight: 600;
    color: #F5EFE6; /* ä¸€ä¸ªéå¸¸æµ…çš„ç±³ç™½è‰²ï¼Œä¸ä¸»æ—¶é—´æœ‰åŒºåˆ† */
    margin: 0;
    padding-bottom: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* === çŒ«å’ªèƒ¡é¡»æ—¶é—´å¡ç‰‡CSS - ç»“æŸ === */


.card-divider {
    border-bottom: 2px dashed #eee;
    text-align: center;
    margin: 16px 0;
    position: relative;
}

.divider-text {
    position: relative;
    top: 10px;
    background: #fff;
    padding: 0 12px;
    font-size: 12px;
    font-weight: 600;
    color: #aaa;
}

#user-name {
    /* è®©ç”¨æˆ·æ˜µç§°è¾“å…¥æ¡†å’Œè§’è‰²åè¾“å…¥æ¡†æ ·å¼ä¸€è‡´ */
    width: 100%;
    border: none;
    border-bottom: 2px solid #ccc;
    padding: 6px 0;
    font-size: 20px;
    font-weight: bold;
    background: transparent;
    color: #000;
    transition: border-color 0.2s;
}

#user-name:focus {
    outline: none;
    border-bottom-color: #000;
}

/* åœ¨"å¯çˆ±å¡ç‰‡èƒŒæ™¯CSS"ä¹‹å‰æ·»åŠ è¿™æ®µ */
.weather-card {
    border-radius: 22px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    box-shadow: 0 4px 20px rgba(168, 201, 245, 0.15);
    border: 1px solid rgba(168, 201, 245, 0.2);
    position: relative;
    backdrop-filter: blur(10px);
}

.weather-card {
    position: relative; /* ç¡®ä¿å¡ç‰‡æˆä¸ºå†…éƒ¨ç»å¯¹å®šä½å…ƒç´ çš„é”šç‚¹ */
    overflow: hidden; /* éšè—è¶…å‡ºå¡ç‰‡åœ†è§’çš„èƒŒæ™¯ */
    background: none; /* ç§»é™¤å¡ç‰‡è‡ªèº«çš„èƒŒæ™¯è‰²/æ¸å˜ */
    border: none; /* ç§»é™¤å¡ç‰‡è‡ªèº«çš„è¾¹æ¡† */
    padding: 0; /* ç§»é™¤å†…è¾¹è·ï¼Œå› ä¸ºå†…å®¹éœ€è¦é‡æ–°å®šä½ */
}

.weather-card > * {
    position: relative;
    z-index: 2; /* ç¡®ä¿å†…å®¹å±‚çº§é«˜äºèƒŒæ™¯ */
}

/* 2. ç¡®ä¿æ‰€æœ‰å†…å®¹éƒ½åœ¨èƒŒæ™¯ä¹‹ä¸Š */
.weather-card > .mood-section {
    padding: 20px;
}

.weather-card > .top-row {
    padding-top: 20px;
}

.weather-card > .mood-section {
    padding-bottom: 20px;
}

.weather-card > .weather-popup {
    /* ä¿®æ­£å¼¹çª—ä½ç½®é—®é¢˜ */
    left: calc(50% - 12px);
}

/* 3. èƒŒæ™¯çš„åŒ…è£¹å®¹å™¨æ ·å¼ */
.card-background-wrapper {
    position: absolute; /* ç»å¯¹å®šä½ï¼Œè„±ç¦»æ–‡æ¡£æµ */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1; /* åœ¨å†…å®¹ä¹‹ä¸‹ */
}

.card-background-wrapper .top-gingham-bg {
    height: 50%;
    background-color: white;
    background-image: linear-gradient(to right, rgba(255, 192, 203, 0.6) 50%, transparent 50%),
    linear-gradient(to bottom, rgba(255, 192, 203, 0.6) 50%, transparent 50%);
    background-size: 30px 30px; /* æ ¼å­å°ºå¯¸è°ƒå°ä¸€äº›ä»¥é€‚åº”å¡ç‰‡ */
}

.card-background-wrapper .bottom-stripes-bg {
    height: 50%;
    background-color: #fffafc;
    background-image: repeating-linear-gradient(
            90deg,
            #ffeaf0, #ffeaf0 15px,
            #fffafc 15px, #fffafc 30px
    );
}

.card-background-wrapper .drip-divider {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 40px; /* æ»´è½æ•ˆæœé«˜åº¦ */
    transform: translateY(-50%);
}

.card-background-wrapper .drip-divider::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 100%;
    mask-size: 100% 100%;
    -webkit-mask-size: 100% 100%;
    background: linear-gradient(to top, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.15) 50%, transparent);
    border: 1px solid rgba(255, 255, 255, 0.5);
    border-bottom: none;
    filter: drop-shadow(0 2px 4px rgba(220, 150, 160, 0.15));
}

/* 6. ä¸­é—´çš„æ³¢æµªå¥¶æ²¹åˆ†å‰²çº¿ */
.drip-divider {
    position: absolute;
    top: 52%; /* ç²¾ç¡®è°ƒæ•´åˆ†å‰²çº¿çš„ä½ç½® */
    left: 0;
    width: 100%;
    height: 30px; /* æ§åˆ¶æ³¢æµªçš„é«˜åº¦ */
    /* ä½¿ç”¨å†…è”SVGä½œä¸ºèƒŒæ™¯å›¾ç‰‡æ¥åˆ›å»ºå½¢çŠ¶ */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 10'%3E%3Cpath d='M0 2 Q 10 7, 20 3 Q 30 0, 40 4 Q 50 8, 60 5 Q 70 2, 80 6 Q 90 10, 100 5 L100 0 L0 0 Z' fill='rgba(255,255,255,0.7)'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-size: 100% 100%;
    /* ä½¿ç”¨ backdrop-filter åˆ¶ä½œç£¨ç ‚ç»ç’ƒè´¨æ„Ÿ */
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px); /* å…¼å®¹ Safari */
}

/* ---å¯çˆ±å¡ç‰‡èƒŒæ™¯CSS - ç»“æŸ--- */
/* BUG ä¿®å¤ï¼šå¼ºåˆ¶å¤©æ°”å¡ç‰‡å†…çš„åˆ é™¤æŒ‰é’®ä½¿ç”¨ç»å¯¹å®šä½ï¼Œé˜²æ­¢å…¶å½±å“å¡ç‰‡é«˜åº¦ */
.weather-card > .delete-weather-btn {
    position: absolute;
    z-index: 250;
}


/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µå…¨æ–°çš„CSSä»£ç  ========== */

.avatar-action-sheet {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1011; /* æ¯”å¡ç‰‡é«˜ï¼Œæ¯”æ¨¡æ€æ¡†è¦†ç›–å±‚ä½ */
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    /* é»˜è®¤éšè— */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.avatar-action-sheet.show {
    opacity: 1;
    visibility: visible;
}

.action-sheet-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
}

.action-sheet-options {
    position: relative;
    z-index: 1;
    padding: 0;
    margin: 8px;
    /* åŠ¨ç”»æ•ˆæœï¼šä»ä¸‹æ–¹æ»‘å…¥ */
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.avatar-action-sheet.show .action-sheet-options {
    transform: translateY(0);
}

/* ========== æ™®é€šèŠå¤©èœå•æ ·å¼ ========== */
.chat-page .message-action-sheet .action-option {
    background: #fff;
    padding: 16px;
    text-align: center;
    font-size: 16px;
    font-weight: 500;
    color: #007aff;
    cursor: pointer;
    border-bottom: 1px solid #e5e5e5;
    border-left: none;
    border-right: none;
    border-top: none;
}

.chat-page .message-action-sheet .action-option:first-child {
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.chat-page .message-action-sheet .action-option:last-child {
    border-bottom: none;
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
}

.chat-page .message-action-sheet .action-option.cancel {
    background: #fff;
    margin-top: 8px;
    border-radius: 12px;
    font-weight: 600;
}

.chat-page .message-action-sheet .action-option.destructive {
    color: #ff3b30;
}

/* ========== å¯†å‹èŠå¤©èœå•æ ·å¼ ========== */
.sweetheart-chat-page .message-action-sheet .action-option {
    background: #fff;
    padding: 16px;
    text-align: center;
    font-size: 16px;
    font-weight: 500;
    color: #007aff;
    cursor: pointer;
    border-bottom: 1px solid #e5e5e5;
    border-left: none;
    border-right: none;
    border-top: none;
}

.sweetheart-chat-page .message-action-sheet .action-option:first-child {
    border-top-left-radius: 12px;
    border-top-right-radius: 12px;
}

.sweetheart-chat-page .message-action-sheet .action-option:last-child {
    border-bottom: none;
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
}

.sweetheart-chat-page .message-action-sheet .action-option.cancel {
    background: #fff;
    margin-top: 8px;
    border-radius: 12px;
    font-weight: 600;
}

.sweetheart-chat-page .message-action-sheet .action-option.destructive {
    color: #ff3b30;
}


/* ========== ç»“æŸï¼šç²˜è´´å…¨æ–°çš„CSSä»£ç  ========== */
/* ç¡®ä¿IDåŒºåŸŸä¸ä¼šæŒ¤å‹ä¸­é—´å†…å®¹ */
.character-id {
    font-size: 12px;
    color: #888;
    margin-top: auto;
    font-family: 'Menlo', 'Monaco', monospace;
    flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
    max-width: 80px; /* é™åˆ¶æœ€å¤§å®½åº¦ */
    word-break: break-all; /* å…è®¸IDæ¢è¡Œ */
}

/* æ”¹è¿›æ€§åˆ«é€‰æ‹©çš„æ ·å¼ */
.character-gender-selection {
    color: #555;
    font-size: 14px;
    display: flex;
    gap: 12px;
    margin-top: 4px;
}

.character-gender-selection label {
    display: flex;
    align-items: center;
    cursor: pointer;
    font-weight: 500;
}

.character-gender-selection input {
    margin-right: 6px;
}

/* ç¡®ä¿æ ¸å¿ƒè¯¦æƒ…åŒºåŸŸæœ‰è¶³å¤Ÿç©ºé—´ */
.core-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
    min-width: 0; /* å…è®¸å†…å®¹æ”¶ç¼© */
}

/* ç¡®ä¿å§“åè¾“å…¥æ¡†ä¸ä¼šè¢«æŒ¤å‹ */
.core-details input[type="text"] {
    width: 100%;
    border: none;
    border-bottom: 2px solid #ccc;
    padding: 6px 0;
    font-size: 20px;
    font-weight: bold;
    background: transparent;
    color: #000;
    transition: border-color 0.2s;
    min-width: 0; /* é‡è¦ï¼šå…è®¸è¾“å…¥æ¡†æ”¶ç¼© */
}


/* ========== å¼€å§‹ï¼šæ–°å¢çš„å¯†å‹åˆ—è¡¨é¡µé¢æ ·å¼ ========== */

/* 1. é¡µé¢ä¸»å®¹å™¨æ ·å¼ (ç²‰è‰²åˆ°è¤è‰²çš„å¯çˆ±æ¸å˜) */
.sweetheart-list-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #F8E8EE 0%, #EEDDD3 100%); /* æŸ”å’Œçš„ç²‰-è¤æ¸å˜ */
    transform: translateY(100%); /* é»˜è®¤ä»ä¸‹æ–¹éšè— */
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1008; /* ä¸å…¶ä»–é¡µé¢å±‚çº§ç±»ä¼¼ */
    display: flex;
    flex-direction: column;
}

/* 2. å½“æœ‰ .show ç±»æ—¶ï¼Œé¡µé¢æ»‘å…¥ */
.sweetheart-list-page.show {
    transform: translateY(0);
}

/* 3. å¤´éƒ¨æ ·å¼ */
.sweetheart-list-header {
    display: flex;
    align-items: center;
    padding: 45px 20px 20px;
    background: rgba(255, 245, 240, 0.7); /* åŠé€æ˜çš„æŸ”ç²‰è‰² */
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(161, 136, 127, 0.1); /* æŸ”å’Œçš„æ£•è‰²é˜´å½± */
    flex-shrink: 0;
    position: relative;
    z-index: 10;
}

/* 4. æ ‡é¢˜æ ·å¼ (ä½¿ç”¨æ·±è¤è‰²æ–‡å­—) */
.sweetheart-list-title {
    flex: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    color: #A1887F; /* æ¸©é¦¨çš„æ·±è¤è‰² */
    margin-right: 36px; /* ä¸ºè¿”å›æŒ‰é’®ç•™å‡ºç©ºé—´ */
}

/* 5. åˆ—è¡¨å®¹å™¨æ ·å¼ */
.sweetheart-list-content {
    flex: 1;
    overflow-y: auto;
    padding-top: 12px;
}

.sweetheart-list-content::-webkit-scrollbar {
    display: none;
}

/* 6. æ¯ä¸ªè”ç³»äººé¡¹ç›®çš„æ ·å¼ */
.sweetheart-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 20px;
    margin: 0 12px 10px;
    background: rgba(255, 255, 255, 0.8); /* åŠé€æ˜ç™½è‰²ï¼Œå¢åŠ å±‚æ¬¡æ„Ÿ */
    border-radius: 16px;
    box-shadow: 0 4px 12px rgba(161, 136, 127, 0.1);
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid rgba(255, 255, 255, 0.9);
}

.sweetheart-item:active {
    transform: scale(0.97);
    background: rgba(255, 255, 255, 1);
}

/* 7. å¤´åƒæ ·å¼ (å¸¦æœ‰å¯çˆ±çš„ç²‰è‰²è¾¹æ¡†) */
.sweetheart-avatar {
    width: 52px;
    height: 52px;
    border-radius: 50%;
    flex-shrink: 0;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    background: #fff;
    border: 2px solid #FFC0D9; /* å¯çˆ±çš„ç²‰è‰²è¾¹æ¡† */
}

.sweetheart-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* 8. å§“åå’ŒçŠ¶æ€çš„å®¹å™¨ */
.sweetheart-info {
    flex: 1;
    min-width: 0;
}

/* 9. å§“åæ ·å¼ */
.sweetheart-name {
    font-size: 16px;
    font-weight: 600;
    color: #8D6E63; /* æ¯”æ ‡é¢˜ç•¥æµ…çš„æ£•è‰² */
    margin-bottom: 2px;
}

/* 10. çŠ¶æ€/æœ€åæ¶ˆæ¯æ ·å¼ */
.sweetheart-status {
    font-size: 13px;
    color: #BCAAA4; /* æŸ”å’Œçš„æµ…æ£•ç°è‰² */
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* ========== ç»“æŸï¼šæ–°å¢çš„å¯†å‹åˆ—è¡¨é¡µé¢æ ·å¼ ========== */
/* ========== å¯†å‹è§’è‰²å¡ - ç²‰è¤è‰²å¯çˆ±é£æ ¼ ========== */

/* å¼¹çª—å®¹å™¨ */
#sweetheartCardModal {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(161, 136, 127, 0.5);
    z-index: 3000 !important;
    display: none;
    justify-content: center;
    align-items: center;
    padding: 20px;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    backdrop-filter: blur(5px);
}

#sweetheartCardModal.show {
    opacity: 1;
    visibility: visible;
    display: flex;
}

/* å¡ç‰‡ä¸»ä½“ */
.sweetheart-card-modal {
    background: linear-gradient(180deg, #FFF5F5 0%, #FFE8E8 100%);
    border: 4px solid #FFB6C1;
    border-radius: 24px;
    width: 100%;
    max-width: 340px;
    max-height: 85vh;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(255, 182, 193, 0.4);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

#sweetheartCardModal.show .sweetheart-card-modal {
    transform: scale(1);
}

/* é¡¶éƒ¨è£…é¥°æ¡ */
.sweetheart-card-header {
    background: linear-gradient(135deg, #FFB6C1, #FFC0D9);
    padding: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    border-bottom: 3px solid #FF9AAD;
}

.header-deco {
    font-size: 20px;
    animation: float 2s ease-in-out infinite;
}

.header-deco:nth-child(3) {
    animation-delay: 0.5s;
}

@keyframes float {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-5px);
    }
}

.header-title {
    font-size: 18px;
    font-weight: 700;
    color: white;
    text-shadow: 0 2px 4px rgba(161, 136, 127, 0.3);
}

/* å†…å®¹åŒºåŸŸ */
.sweetheart-card-content {
    padding: 20px;
    max-height: 60vh;
    overflow-y: auto;
}

.sweetheart-card-content::-webkit-scrollbar {
    width: 6px;
}

.sweetheart-card-content::-webkit-scrollbar-track {
    background: #FFE8E8;
}

.sweetheart-card-content::-webkit-scrollbar-thumb {
    background: #FFB6C1;
    border-radius: 3px;
}

/* å¤´åƒåŒºåŸŸ */
.sweetheart-avatar-section {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
}

.sweetheart-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 4px solid #FFB6C1;
    overflow: hidden;
    position: relative;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(255, 182, 193, 0.4);
    transition: transform 0.2s ease;
}

.sweetheart-avatar:hover {
    transform: scale(1.05);
}

.sweetheart-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* ========== ç»Ÿä¸€è§’è‰²å¡æ ·å¼ä¿®è¡¥ ========== */
/* ========== ç»Ÿä¸€è§’è‰²å¡æ ·å¼ä¿®è¡¥ ========== */

/* å¤´åƒä¸Šçš„æ‚¬æµ®æç¤º */
.avatar-overlay {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    background: rgba(0,0,0,0.5);
    color: white;
    font-size: 12px;
    text-align: center;
    padding: 2px 0;
    pointer-events: none;
}

/* æ‰©å±•å­—æ®µåŒºåŸŸ */
.char-wb-list input.form-input,
.char-wb-list textarea.form-input {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 13px;
    background-color: #fff;
    margin-bottom: 8px; /* é—´è· */
}

/* æ€§åˆ«é€‰æ‹©å¾®è°ƒ */
.character-gender-selection label {
    margin-right: 10px;
    font-size: 13px;
    cursor: pointer;
}

/* é€‚é…ä¸åŒå±å¹•é«˜åº¦ */
.character-card-modal {
    max-height: 90vh; /* å¢åŠ æœ€å¤§é«˜åº¦åˆ©ç”¨ç‡ */
}


/* è¡¨å•å­—æ®µ */
.sweetheart-field {
    margin-bottom: 16px;
}

.sweetheart-label {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
    font-size: 14px;
    font-weight: 600;
    color: #8D6E63;
}

.label-icon {
    font-size: 16px;
}

.required-star {
    color: #FF6B9D;
    font-weight: bold;
}

/* è¾“å…¥æ¡† */
.sweetheart-input,
.sweetheart-textarea {
    width: 100%;
    padding: 12px 14px;
    border: 2px solid #FFD1DC;
    border-radius: 12px;
    font-size: 14px;
    font-family: inherit;
    background: white;
    transition: all 0.2s ease;
}

.sweetheart-input:focus,
.sweetheart-textarea:focus {
    outline: none;
    border-color: #FFB6C1;
    box-shadow: 0 0 0 3px rgba(255, 182, 193, 0.2);
}

.sweetheart-textarea {
    resize: vertical;
    min-height: 80px;
}

/* å¿…å¡«å­—æ®µæ ·å¼ */
.required-field .sweetheart-input,
.required-field .sweetheart-textarea {
    border-color: #FFB6C1;
    background: #FFFAFA;
}

/* ä¸–ç•Œä¹¦æŠ˜å åŒºåŸŸ */
.sweetheart-label-toggle {
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    padding: 8px 12px;
    background: #FFF0F5;
    border-radius: 10px;
    transition: background 0.2s;
    user-select: none;
}

.sweetheart-label-toggle:hover {
    background: #FFE4E9;
}

.toggle-arrow {
    font-size: 12px;
    color: #FFB6C1;
    transition: transform 0.3s ease;
}

.toggle-arrow.open {
    transform: rotate(180deg);
}

.sweetheart-worldbooks-list {
    margin-top: 12px;
    padding: 12px;
    background: white;
    border: 2px solid #FFD1DC;
    border-radius: 10px;
    max-height: 180px;
    overflow-y: auto;
}

.sweetheart-wb-item {
    display: flex;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid #FFF0F5;
    cursor: pointer;
    transition: background 0.2s;
}

.sweetheart-wb-item:last-child {
    border-bottom: none;
}

.sweetheart-wb-item:hover {
    background: #FFF5F8;
}

.sweetheart-wb-item input[type="checkbox"] {
    margin-right: 10px;
    cursor: pointer;
    width: 18px;
    height: 18px;
    accent-color: #FFB6C1;
}

.sweetheart-wb-item label {
    flex: 1;
    cursor: pointer;
    font-size: 14px;
    color: #8D6E63;
}

/* åº•éƒ¨æŒ‰é’® */
.sweetheart-card-footer {
    display: flex;
    padding: 16px;
    gap: 12px;
    background: #FFF0F5;
    border-top: 2px solid #FFD1DC;
}

.sweetheart-btn {
    flex: 1;
    padding: 14px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.btn-cancel {
    background: white;
    color: #BCAAA4;
    border: 2px solid #E0D5D1;
}

.btn-cancel:hover {
    background: #F5F5F5;
    transform: translateY(-2px);
}

.btn-cancel:active {
    transform: translateY(0);
}

.btn-save {
    background: linear-gradient(135deg, #FFB6C1, #FF9AAD);
    color: white;
    box-shadow: 0 4px 12px rgba(255, 182, 193, 0.4);
}

.btn-save:hover {
    background: linear-gradient(135deg, #FF9AAD, #FF8BA0);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(255, 182, 193, 0.5);
}

.btn-save:active {
    transform: translateY(0);
}

/* ========== æ­¥éª¤1ï¼šåœ¨è¿™é‡Œç²˜è´´â€œå¯†å‹ä¸“å±â€èŠå¤©ä¸»é¢˜CSS ========== */
/* ========== å¯†å‹ä¸“ç”¨èŠå¤©é¡µé¢æ ·å¼ ========== */

.sweetheart-chat-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #FFF0F5 0%, #FFE4E9 100%);
    z-index: 1005;
    display: flex;
    flex-direction: column;
    transform: translateY(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.sweetheart-chat-page.show {
    transform: translateY(0);
}

/* å¤´éƒ¨æ ·å¼ - ç²‰è‰²æ¸å˜ */
.sweetheart-chat-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 45px 12px 12px;
    background: linear-gradient(135deg, #FFB6C1, #FFC0D9);
    box-shadow: 0 2px 8px rgba(212, 165, 165, 0.3);
    flex-shrink: 0;
}

.sweetheart-chat-title {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    font-size: 17px;
    font-weight: 600;
    color: white;
    margin: 0;
    text-shadow: 0 1px 3px rgba(161, 136, 127, 0.3);
}

/* æ¶ˆæ¯åŒºåŸŸ - å¸¦å¿ƒå½¢å›¾æ¡ˆèƒŒæ™¯ */
.sweetheart-chat-messages {
    flex: 1; /* ä¿æŒï¼šå æ»¡å¯ç”¨å‚ç›´ç©ºé—´ */
    overflow-y: auto; /* ä¿æŒï¼šå½“å†…å®¹è¶…å‡ºæ—¶æ»šåŠ¨ */
    min-height: 0; /* âœ¨ è¿™æ˜¯è§£å†³é—®é¢˜çš„å…³é”®ï¼å…è®¸æ­¤åŒºåŸŸæ”¶ç¼© */
    /* ... å…¶ä»–æ ·å¼ä¿æŒä¸å˜ ... */
    padding: 10px;
    display: flex;
    flex-direction: column;
    background-color: #FDF6F8;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23F8E8EE' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}

.sweetheart-chat-messages::-webkit-scrollbar {
    display: none;
}

/* æˆ‘æ–¹å‘é€çš„æ°”æ³¡ - ç²‰è‰²æ¸å˜ */
.sweetheart-chat-page .message-row.sent .chat-bubble {
    background: linear-gradient(135deg, #FFB6C1, #FF9AAD);
    color: white;
    box-shadow: 0 3px 8px rgba(255, 182, 193, 0.3);
}

/* å¯¹æ–¹å‘é€çš„æ°”æ³¡ - ç™½è‰²å¸¦ç²‰è¾¹ */
.sweetheart-chat-page .message-row.received .chat-bubble {
    background: #FFFFFF;
    color: #8D6E63;
    border: 1px solid #FFE4E9;
    box-shadow: 0 2px 6px rgba(161, 136, 127, 0.08);
}

/* è¾“å…¥åŒºåŸŸ */
.sweetheart-chat-input-area {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
    padding: 8px 12px;
    background: linear-gradient(180deg, #FFF5F8 0%, #FFFFFF 100%);
    border-top: 1px solid #FFE8E8;
    flex-shrink: 0;
    position: relative; /* æ–°å¢ */
    z-index: 10; /* æ–°å¢ï¼šç¡®ä¿è¾“å…¥åŒºåŸŸåœ¨æœ€ä¸Šå±‚ */
}

.sweetheart-chat-input-area input {
    flex: 1;
    padding: 10px 16px;
    border: 1px solid #FFD1DC;
    background: white;
    border-radius: 20px;
    font-size: 16px;
    outline: none;
}

/* ğŸ”§ ä¿®å¤ï¼šç¡®ä¿è¾“å…¥æ¡†å¯ä»¥è·å¾—ç„¦ç‚¹å’Œæ¥æ”¶è¾“å…¥ */
.sweetheart-chat-input-area input {
    pointer-events: auto; /* ç¡®ä¿å¯ä»¥ç‚¹å‡» */
    user-select: text; /* ç¡®ä¿å¯ä»¥é€‰æ‹©æ–‡æœ¬ */
    -webkit-user-select: text; /* Safariå…¼å®¹ */
}

.sweetheart-chat-input-area input:disabled {
    pointer-events: none;
    opacity: 0.6;
}


.sweetheart-chat-input-area input:focus {
    border-color: #FFB6C1;
    box-shadow: 0 0 0 3px rgba(255, 182, 193, 0.2);
}

/* æŒ‰é’®æ ·å¼ */
/* ğŸ”§ ä¿®å¤ï¼šç¡®ä¿å¯†å‹èŠå¤©ç•Œé¢çš„é™„ä»¶æŒ‰é’®SVGå›¾æ ‡å¯è§ */
.sweetheart-chat-input-area .chat-action-btn {
    width: 38px;
    height: 38px;
    padding: 0;
    border: none;
    border-radius: 50%;
    background: #f0f2f5;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.sweetheart-chat-input-area .chat-action-btn svg {
    width: 20px;
    height: 20px;
    fill: #6c757d;
}

.sweetheart-chat-input-area .chat-action-btn.primary {
    background: linear-gradient(135deg, #FFB6C1, #FF9AAD);
    display: none; /* é»˜è®¤éšè— */
}

.sweetheart-chat-input-area.has-text .chat-action-btn.primary {
    display: flex;
}

.sweetheart-chat-input-area.has-text #sweetheartGetReplyBtn {
    display: none;
}

.sweetheart-chat-input-area .chat-action-btn.primary svg {
    fill: white;
}

/* å¯†å‹è®¾ç½®é¡µé¢ */
#sweetheartChatSettingsPage {
    background: linear-gradient(180deg, #FFF0F5 0%, #FFE4E9 100%);
}

#sweetheartChatSettingsPage .settings-header {
    background: linear-gradient(135deg, #FFB6C1, #FFC0D9);
}

#sweetheartChatSettingsPage .settings-title {
    color: white;
}

/* ä¸ºå¯†å‹èŠå¤©è¾“å…¥åŒºæŒ‰é’®å†…çš„å›¾ç‰‡å›¾æ ‡è®¾ç½®æ ·å¼ */
.sweetheart-chat-input-area .chat-action-btn img {
    width: 28px; /* è®¾ç½®å›¾ç‰‡å®½åº¦ */
    height: 28px; /* è®¾ç½®å›¾ç‰‡é«˜åº¦ */
    object-fit: contain; /* ç¡®ä¿å›¾ç‰‡å®Œæ•´æ˜¾ç¤ºä¸è¢«è£å‰ª */
    transition: transform 0.2s ease;
}

/* é¼ æ ‡æ‚¬åœæ—¶ç¨å¾®æ”¾å¤§å›¾ç‰‡ */
.sweetheart-chat-input-area .chat-action-btn:hover img {
    transform: scale(1.15);
}

/* ========== ã€æœ€ç»ˆä¿®æ­£ç‰ˆã€‘æ°”æ³¡æ ·å¼ä¿®æ­£ ========== */

/* 1. åœ¨æ‰€æœ‰æ°”æ³¡æ¨¡å¼ä¸‹ï¼Œå¼ºåˆ¶éšè—æ˜µç§°å…ƒç´  */
.chat-page:not(.simple-style) .message-sender-name,
.sweetheart-chat-page .message-sender-name {
    display: none;
}

/* 2. ã€æ ¸å¿ƒä¿®å¤ã€‘åœ¨æ‰€æœ‰æ°”æ³¡æ¨¡å¼ä¸‹ï¼Œç§»é™¤çˆ¶å®¹å™¨çš„gapï¼Œå½»åº•æ¶ˆé™¤ç©ºç™½ */
.chat-page:not(.simple-style) .message-content,
.sweetheart-chat-page .message-content {
    gap: 0;
}

/* 3. åœ¨ç®€æ´æ¨¡å¼ä¸‹ï¼Œå†æŠŠgapåŠ å›æ¥ï¼Œä¿è¯æ˜µç§°å’Œæ¶ˆæ¯æ–‡æœ¬æœ‰é—´è· */
.chat-page.simple-style .message-content {
    gap: 4px;
}

/* ====================================
   è¯­éŸ³æ¡æ¶ˆæ¯æ ·å¼
   ==================================== */

/* è¯­éŸ³æ°”æ³¡å®¹å™¨ - ç»§æ‰¿ chat-bubble çš„åŸºç¡€æ ·å¼ */
.voice-message-bubble {
    padding: 8px 14px;
    border-radius: 20px;
    cursor: pointer;
    max-width: 80%;
    transition: background-color 0.2s ease-in-out;
    display: flex;
    flex-direction: column;
    overflow: hidden !important; /* ç¡®ä¿è¿›åº¦æ¡ä¸ä¼šæº¢å‡ºæ°”æ³¡åœ†è§’ */
    position: relative !important; /* ä¸ºè¿›åº¦æ¡çš„ç»å¯¹å®šä½æä¾›å‚è€ƒ */
    z-index: 1;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1); /* æ·»åŠ ç‚¹å‡»åé¦ˆ */
    touch-action: manipulation; /* ä¼˜åŒ–è§¦æ‘¸å“åº” */
}

/* è¯­éŸ³æ¶ˆæ¯ä¸»ä½“å†…å®¹ï¼ˆæ’­æ”¾å›¾æ ‡ã€æ³¢å½¢ã€æ—¶é•¿ï¼‰ */
.voice-main-content {
    display: flex;
    align-items: center;
    gap: 10px;
    position: relative; /* ç¡®ä¿voice-barçš„å®šä½æ­£å¸¸ */
    z-index: 1; /* ç¡®ä¿å†…å®¹åœ¨è¿›åº¦æ¡ä¹‹ä¸Š */
    height: 28px; /* ç¡®ä¿æœ‰è¶³å¤Ÿé«˜åº¦ï¼Œé˜²æ­¢è¢«é®æŒ¡ */
}

/* æ’­æ”¾å›¾æ ‡ */
.voice-play-icon {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    cursor: pointer !important; /* ä¿æŒæŒ‡é’ˆæ ·å¼ */
    /* === æ–°å¢/ä¿®æ”¹çš„æ ·å¼ === */
    border: none; /* ç§»é™¤è¾¹æ¡† */
    background: transparent; /* èƒŒæ™¯é€æ˜ */
    outline: none; /* ç§»é™¤èšç„¦æ—¶çš„è½®å»“ */
    padding: 0; /* ç§»é™¤å†…è¾¹è· */
    transition: transform 0.2s; /* åŠ¨ç”»æ•ˆæœï¼šç‚¹å‡»æ—¶ä¼šç¨å¾®ç¼©å° */
    position: relative !important;
    z-index: 20 !important;
    pointer-events: auto;
    touch-action: manipulation !important;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1) !important;
}

.voice-play-icon svg {
    width: 20px; /* ç¨å¾®å¤§ä¸€ç‚¹ */
    height: 20px;
    /* fill é¢œè‰²å°†ç”± JS åŠ¨æ€è®¾ç½®æˆ–æ ¹æ®çˆ¶å…ƒç´ ç»§æ‰¿ */
    transition: transform 0.2s ease-in-out, fill 0.2s ease-in-out; /* è®©å›¾æ ‡æœ¬èº«çš„åŠ¨ç”»æ›´å¹³æ»‘ */
}

/* æ’­æ”¾æŒ‰é’®æ‚¬åœæ•ˆæœ */
.voice-play-icon:hover {
    opacity: 0.8;
}

/* ç‚¹å‡»æ—¶çš„ç¼©æ”¾æ•ˆæœ */
.voice-play-icon:active {
    transform: scale(0.9);
}

/* æ’­æ”¾çŠ¶æ€çš„å›¾æ ‡åŠ¨ç”» */
.voice-play-icon.playing svg path {
    /* æš‚åœå›¾æ ‡çš„è·¯å¾„ */
    d: path('M6 19h4V5H6v14zm8-14v14h4V5h-4z');
    transition: d 0.2s ease-in-out; /* è·¯å¾„å˜æ¢åŠ¨ç”» */
}

/* æ¨¡æ‹Ÿè¯­éŸ³æ³¢å½¢æ¡ */
/* è¯­éŸ³æ³¢å½¢æ¡å®¹å™¨ */
.voice-bar {
    flex: 1;
    height: 20px;
    display: flex;
    align-items: center;
    position: relative; /* ç¡®ä¿.voice-baræ˜¯disclosure-arrowçš„å®šä½çˆ¶å…ƒç´  */
    overflow: hidden;
    border-radius: 5px;
    background: transparent;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    z-index: 1; /* ç¡®ä¿åœ¨disclosure-arrowä¸‹æ–¹ */
    cursor: pointer !important;
    padding: 5px 0; /* å¢åŠ ç‚¹å‡»åŒºåŸŸ */
    margin: -5px 0; /* è¡¥å¿padding */
}

.voice-bar::before { /* é™æ€æ³¢å½¢å›¾çš„èƒŒæ™¯ (æœªæ’­æ”¾éƒ¨åˆ†) */
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    /* é»˜è®¤æ³¢å½¢é¢œè‰² */
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><rect x="0" y="5" width="4" height="10" fill="%23ccc"/><rect x="7" y="2" width="4" height="16" fill="%23ccc"/><rect x="14" y="8" width="4" height="4" fill="%23ccc"/><rect x="21" y="0" width="4" height="20" fill="%23ccc"/><rect x="28" y="6" width="4" height="8" fill="%23ccc"/><rect x="35" y="4" width="4" height="12" fill="%23ccc"/><rect x="42" y="10" width="4" height="0" fill="%23ccc"/><rect x="49" y="3" width="4" height="14" fill="%23ccc"/><rect x="56" y="7" width="4" height="6" fill="%23ccc"/><rect x="63" y="1" width="4" height="18" fill="%23ccc"/><rect x="70" y="9" width="4" height="2" fill="%23ccc"/><rect x="77" y="5" width="4" height="10" fill="%23ccc"/><rect x="84" y="2" width="4" height="16" fill="%23ccc"/><rect x="91" y="8" width="4" height="4" fill="%23ccc"/></svg>');
    background-size: contain;
    background-repeat: repeat-x;
    opacity: 0.5; /* é™æ€æ³¢å½¢å›¾æ·¡ä¸€ç‚¹ */
}

.voice-bar:hover {
    opacity: 0.8;
}

/* æ¥æ”¶æ¶ˆæ¯çš„é™æ€æ³¢å½¢å›¾é¢œè‰² */
.message-row.received .voice-bar::before {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><rect x="0" y="5" width="4" height="10" fill="%23666"/><rect x="7" y="2" width="4" height="16" fill="%23666"/><rect x="14" y="8" width="4" height="4" fill="%23666"/><rect x="21" y="0" width="4" height="20" fill="%23666"/><rect x="28" y="6" width="4" height="8" fill="%23666"/><rect x="35" y="4" width="4" height="12" fill="%23666"/><rect x="42" y="10" width="4" height="0" fill="%23666"/><rect x="49" y="3" width="4" height="14" fill="%23666"/><rect x="56" y="7" width="4" height="6" fill="%23666"/><rect x="63" y="1" width="4" height="18" fill="%23666"/><rect x="70" y="9" width="4" height="2" fill="%23666"/><rect x="77" y="5" width="4" height="10" fill="%23666"/><rect x="84" y="2" width="4" height="16" fill="%23666"/><rect x="91" y="8" width="4" height="4" fill="%23666"/></svg>');
}

/* æ¥æ”¶æ¶ˆæ¯çš„è¿›åº¦æ¡é¢œè‰² */
.message-row.received .voice-progress-fill {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><rect x="0" y="5" width="4" height="10" fill="%23000"/><rect x="7" y="2" width="4" height="16" fill="%23000"/><rect x="14" y="8" width="4" height="4" fill="%23000"/><rect x="21" y="0" width="4" height="20" fill="%23000"/><rect x="28" y="6" width="4" height="8" fill="%23000"/><rect x="35" y="4" width="4" height="12" fill="%23000"/><rect x="42" y="10" width="4" height="0" fill="%23000"/><rect x="49" y="3" width="4" height="14" fill="%23000"/><rect x="56" y="7" width="4" height="6" fill="%23000"/><rect x="63" y="1" width="4" height="18" fill="%23000"/><rect x="70" y="9" width="4" height="2" fill="%23000"/><rect x="77" y="5" width="4" height="10" fill="%23000"/><rect x="84" y="2" width="4" height="16" fill="%23000"/><rect x="91" y="8" width="4" height="4" fill="%23000"/></svg>');
}

/* è¯­éŸ³æ—¶é•¿ */
.voice-duration {
    font-size: 13px;
    font-weight: 500;
    flex-shrink: 0;
    position: relative;
    z-index: 1; /* ç¡®ä¿å†…å®¹åœ¨è¿›åº¦æ¡ä¹‹ä¸Š */
    cursor: pointer !important;
    padding: 5px;
    margin: -5px;
    user-select: none;
}

.voice-duration:hover {
    opacity: 0.7;
}

/* å¯†å‹èŠå¤©ä¸»é¢˜ä¸‹çš„è¯­éŸ³æ¡æ ·å¼ */
.sweetheart-chat-page .message-row.sent .voice-message-bubble {
    background: linear-gradient(135deg, #FFB6C1, #FF9AAD);
    color: white;
    box-shadow: 0 3px 8px rgba(255, 182, 193, 0.3);
}
.sweetheart-chat-page .message-row.sent .voice-play-icon svg {
    fill: white;
}
/* å¯†å‹å‘é€çš„é™æ€è¯­éŸ³æ¡çš„é¢œè‰² */
.sweetheart-chat-page .message-row.sent .voice-bar::before {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><rect x="0" y="5" width="4" height="10" fill="%23fff"/><rect x="7" y="2" width="4" height="16" fill="%23fff"/><rect x="14" y="8" width="4" height="4" fill="%23fff"/><rect x="21" y="0" width="4" height="20" fill="%23fff"/><rect x="28" y="6" width="4" height="8" fill="%23fff"/><rect x="35" y="4" width="4" height="12" fill="%23fff"/><rect x="42" y="10" width="4" height="0" fill="%23fff"/><rect x="49" y="3" width="4" height="14" fill="%23fff"/><rect x="56" y="7" width="4" height="6" fill="%23fff"/><rect x="63" y="1" width="4" height="18" fill="%23fff"/><rect x="70" y="9" width="4" height="2" fill="%23fff"/><rect x="77" y="5" width="4" height="10" fill="%23fff"/><rect x="84" y="2" width="4" height="16" fill="%23fff"/><rect x="91" y="8" width="4" height="4" fill="%23fff"/></svg>');
}
/* å¯†å‹å‘é€çš„è¿›åº¦æ¡é¢œè‰² */
.sweetheart-chat-page .message-row.sent .voice-progress-fill {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><rect x="0" y="5" width="4" height="10" fill="%23FFC0D9"/><rect x="7" y="2" width="4" height="16" fill="%23FFC0D9"/><rect x="14" y="8" width="4" height="4" fill="%23FFC0D9"/><rect x="21" y="0" width="4" height="20" fill="%23FFC0D9"/><rect x="28" y="6" width="4" height="8" fill="%23FFC0D9"/><rect x="35" y="4" width="4" height="12" fill="%23FFC0D9"/><rect x="42" y="10" width="4" height="0" fill="%23FFC0D9"/><rect x="49" y="3" width="4" height="14" fill="%23FFC0D9"/><rect x="56" y="7" width="4" height="6" fill="%23FFC0D9"/><rect x="63" y="1" width="4" height="18" fill="%23FFC0D9"/><rect x="70" y="9" width="4" height="2" fill="%23FFC0D9"/><rect x="77" y="5" width="4" height="10" fill="%23FFC0D9"/><rect x="84" y="2" width="4" height="16" fill="%23FFC0D9"/><rect x="91" y="8" width="4" height="4" fill="%23FFC0D9"/></svg>');
}
.sweetheart-chat-page .message-row.received .voice-message-bubble {
    background: #FFFFFF;
    color: #8D6E63;
    border: 1px solid #FFE4E9;
    box-shadow: 0 2px 6px rgba(161, 136, 127, 0.08);
}
.sweetheart-chat-page .message-row.received .voice-play-icon svg {
    fill: #8D6E63;
}
/* å¯†å‹æ¥æ”¶çš„é™æ€è¯­éŸ³æ¡çš„é¢œè‰² */
.sweetheart-chat-page .message-row.received .voice-bar::before {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><rect x="0" y="5" width="4" height="10" fill="%238D6E63"/><rect x="7" y="2" width="4" height="16" fill="%238D6E63"/><rect x="14" y="8" width="4" height="4" fill="%238D6E63"/><rect x="21" y="0" width="4" height="20" fill="%238D6E63"/><rect x="28" y="6" width="4" height="8" fill="%238D6E63"/><rect x="35" y="4" width="4" height="12" fill="%238D6E63"/><rect x="42" y="10" width="4" height="0" fill="%238D6E63"/><rect x="49" y="3" width="4" height="14" fill="%238D6E63"/><rect x="56" y="7" width="4" height="6" fill="%238D6E63"/><rect x="63" y="1" width="4" height="18" fill="%238D6E63"/><rect x="70" y="9" width="4" height="2" fill="%238D6E63"/><rect x="77" y="5" width="4" height="10" fill="%238D6E63"/><rect x="84" y="2" width="4" height="16" fill="%238D6E63"/><rect x="91" y="8" width="4" height="4" fill="%238D6E63"/></svg>');
}
/* å¯†å‹æ¥æ”¶çš„è¿›åº¦æ¡é¢œè‰² */
.sweetheart-chat-page .message-row.received .voice-progress-fill {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><rect x="0" y="5" width="4" height="10" fill="%23BCAAA4"/><rect x="7" y="2" width="4" height="16" fill="%23BCAAA4"/><rect x="14" y="8" width="4" height="4" fill="%23BCAAA4"/><rect x="21" y="0" width="4" height="20" fill="%23BCAAA4"/><rect x="28" y="6" width="4" height="8" fill="%23BCAAA4"/><rect x="35" y="4" width="4" height="12" fill="%23BCAAA4"/><rect x="42" y="10" width="4" height="0" fill="%23BCAAA4"/><rect x="49" y="3" width="4" height="14" fill="%23BCAAA4"/><rect x="56" y="7" width="4" height="6" fill="%23BCAAA4"/><rect x="63" y="1" width="4" height="18" fill="%23BCAAA4"/><rect x="70" y="9" width="4" height="2" fill="%23BCAAA4"/><rect x="77" y="5" width="4" height="10" fill="%23BCAAA4"/><rect x="84" y="2" width="4" height="16" fill="%23BCAAA4"/><rect x="91" y="8" width="4" height="4" fill="%23BCAAA4"/></svg>');
}

/* è½¬å†™æ–‡å­—åŒºåŸŸ */
.voice-transcription {
    margin-top: 10px;
    padding-top: 8px;
    border-top: 1px dashed rgba(255, 255, 255, 0.4);
    font-size: 13px;
    line-height: 1.5;
    position: relative;
    z-index: 0;
    pointer-events: none; /* æ–‡å­—åŒºåŸŸä¸æ¥æ”¶ç‚¹å‡»äº‹ä»¶ */
    /* è¿™é‡Œå¾ˆé‡è¦ï¼šè®¾ç½®position: relative; ä½¿å¾—ä¸‰è§’å½¢å¯ä»¥ç›¸å¯¹å®šä½åˆ°è¿™ä¸ªåŒºåŸŸï¼Œå¹¶ä¸”å…è®¸æ–‡å­—å†…å®¹æ­£å¸¸æ˜¾ç¤º */
    cursor: pointer !important;
    user-select: text; /* å…è®¸é€‰æ‹©æ–‡å­— */
}

.voice-transcription:hover {
    background-color: rgba(0, 0, 0, 0.05);
}

.voice-transcription .voice-text {
    pointer-events: auto; /* ä½†æ–‡å­—æœ¬èº«å¯ä»¥è¢«é€‰ä¸­ */
}

/* AI æ¥æ”¶åˆ°çš„è¯­éŸ³æ¡æ ·å¼ */
.message-row.received .voice-message-bubble {
    background: #e9e9eb; /* æ¥æ”¶æ¶ˆæ¯æ°”æ³¡è‰² */
    color: #333;
}
.message-row.received .voice-play-icon svg {
    fill: #333;
}
.message-row.received .voice-transcription {
    border-top-color: rgba(0, 0, 0, 0.2);
    color: #333;
}

/* ç”¨æˆ·å‘é€çš„è¯­éŸ³æ¡æ ·å¼ */
.message-row.sent .voice-message-bubble {
    background: linear-gradient(135deg, #0A84FF, #0066CC); /* å‘é€æ¶ˆæ¯æ°”æ³¡è‰² */
    color: white;
}
.message-row.sent .voice-play-icon svg {
    fill: white;
}
.message-row.sent .voice-transcription {
    border-top-color: rgba(255, 255, 255, 0.4);
    color: white;
}
/*.message-row.sent .disclosure-arrow {*/
/*    color: rgba(255, 255, 255, 0.6);*/
/*}*/

.voice-message-bubble:active {
    filter: brightness(0.9);
}


/* æ’­æ”¾çŠ¶æ€åŠ¨ç”» */
.play-tts-btn.playing svg path {
    d: path('M6 19h4V5H6v14zm8-14v14h4V5h-4z'); /* åŠ¨ç”»åˆ°æš‚åœå›¾æ ‡ */
}
/* åœ†å½¢è¿›åº¦æ¡ */
.play-tts-btn .circle-progress {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    transform: rotate(-90deg); /* ä»é¡¶éƒ¨å¼€å§‹ */
}
.play-tts-btn .circle-progress circle {
    stroke-linecap: round;
    transition: stroke-dashoffset 0.1s linear;
}

/* å°† TTS æŒ‰é’®é›†æˆåˆ°æ¶ˆæ¯æµä¸­ */
.message-row {
    flex-wrap: nowrap; /* é˜²æ­¢TTSæŒ‰é’®æ¢è¡Œ */
}
/* AIæ¶ˆæ¯çš„TTSæŒ‰é’®éœ€è¦åœ¨æ°”æ³¡å·¦ä¾§ */
.message-row.received .message-content + .message-actions {
    margin-left: 0;
    margin-right: -8px; /* å¾®è°ƒé—´è· */
    color: #555;
    order: 3; /* å°†æ’­æ”¾æŒ‰é’®æ’åœ¨å†…å®¹çš„åé¢ */
}
/* æˆ‘çš„æ¶ˆæ¯çš„TTSæŒ‰é’®éœ€è¦åœ¨æ°”æ³¡å³ä¾§ */
.message-row.sent .message-content + .message-actions {
    margin-left: -8px; /* å¾®è°ƒé—´è· */
    margin-right: 0;
    color: white;
    order: -1; /* å°†æ’­æ”¾æŒ‰é’®æ’åœ¨å†…å®¹çš„å·¦è¾¹ï¼Œå› ä¸ºflex-direction:row-reverseåœ¨å‘é€æ¶ˆæ¯æ—¶ */
}
/* é’ˆå¯¹å¯†å‹èŠå¤©ï¼Œè°ƒæ•´TTSæŒ‰é’®çš„é¢œè‰² */
.sweetheart-chat-page .message-row.received .play-tts-btn {
    background: rgba(161, 136, 127, 0.1);
}

.sweetheart-chat-page .message-row.received .play-tts-btn:hover {
    background: rgba(161, 136, 127, 0.2);
}

.sweetheart-chat-page .message-row.received .play-tts-btn svg {
    fill: #8D6E63;
}
.sweetheart-chat-page .message-row.sent .play-tts-btn {
    background: rgba(255, 255, 255, 0.2);
}

.sweetheart-chat-page .message-row.sent .play-tts-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.sweetheart-chat-page .message-row.sent .play-tts-btn svg {
    fill: white;
}

/* åŠ è½½çŠ¶æ€çš„æ—‹è½¬åŠ¨ç”» */
@keyframes tts-spinner-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
.play-tts-btn .spinner {
    animation: tts-spinner-spin 1s linear infinite;
}
.play-tts-btn .spinner .path {
    stroke: currentColor;
    stroke-linecap: round;
    animation: dash 1.5s ease-in-out infinite;
}
@keyframes dash {
    0% {
        stroke-dasharray: 1, 150;
        stroke-dashoffset: 0;
    }
    50% {
        stroke-dasharray: 90, 150;
        stroke-dashoffset: -35;
    }
    100% {
        stroke-dasharray: 90, 150;
        stroke-dashoffset: -124;
    }
}

.message-row.received .message-actions {
    order: 3; /* TTS æŒ‰é’®åœ¨ç¬¬ä¸‰ä¸ªï¼ˆæœ€å³ï¼‰ */
    margin-left: 8px; /* TTS æŒ‰é’®ä¸å†…å®¹ä¹‹é—´é—´è· */
}
/* 3. å‘é€æ¶ˆæ¯ï¼ˆè‡ªå·±ï¼‰ï¼šTTS æŒ‰é’®åœ¨å·¦ï¼Œå¤´åƒåœ¨å³ï¼Œå†…å®¹å±…ä¸­ */
.message-row.sent {
    flex-direction: row-reverse; /* ä¿æŒ Dom é¡ºåºï¼šTTSæŒ‰é’®-å¤´åƒ-å†…å®¹ï¼Œä½†è§†è§‰ä¸Šä»å³å¾€å·¦æ’ */
    justify-content: flex-end; /* æ•´ä½“å³å¯¹é½ */
}
/* è°ƒæ•´å‘é€æ¶ˆæ¯çš„é¡ºåºå’Œé—´è· */
.message-row.sent .message-chat-avatar {
    order: 1; /* å¤´åƒåœ¨ç¬¬ä¸€ä¸ªï¼ˆæœ€å³ï¼‰ */
    margin-left: 8px; /* å¤´åƒä¸å†…å®¹ä¹‹é—´é—´è· */
}
.message-row.sent .message-content {
    order: 2; /* å†…å®¹åœ¨ç¬¬äºŒä¸ª */
}
.message-row.sent .message-actions {
    order: 3; /* TTS æŒ‰é’®åœ¨ç¬¬ä¸‰ä¸ªï¼ˆæœ€å·¦ï¼‰ */
    margin-right: 8px; /* TTS æŒ‰é’®ä¸å†…å®¹ä¹‹é—´é—´è· */
}

/* ========== ä¸–ç•Œé€‰æ‹©é¡µé¢æ ·å¼ ========== */
.world-select-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #E8F4F8 0%, #D4E9F0 100%);
    transform: translateY(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 2000;
    display: flex;
    flex-direction: column;
}

.world-select-page.show {
    transform: translateY(0);
}

.world-select-header {
    display: flex;
    align-items: center;
    padding: 45px 20px 30px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(76, 150, 175, 0.1);
}

.world-select-header .world-select-title {
    flex: 1;
    text-align: center;
    margin-right: 36px; /* ä¸ºè¿”å›æŒ‰é’®ç•™å‡ºç©ºé—´ï¼Œä¿æŒæ ‡é¢˜å±…ä¸­ */
}


.world-select-title {
    font-size: 22px;
    font-weight: 600;
    color: #2C6B8F;
    text-align: center;
}

.world-select-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.world-select-content::-webkit-scrollbar {
    display: none;
}

/* ä¸–ç•Œå¡ç‰‡ */
.world-card {
    background: white;
    border-radius: 20px;
    padding: 24px;
    box-shadow: 0 4px 12px rgba(44, 107, 143, 0.15);
    cursor: pointer;
    transition: transform 0.3s ease,
    box-shadow 0.3s ease,
    border-color 0.3s ease;
    border: 2px solid transparent;
}

.world-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(44, 107, 143, 0.25);
    border-color: #5FB3D6;
}

.world-card-icon {
    font-size: 48px;
    text-align: center;
    margin-bottom: 16px;
}

.world-card-name {
    font-size: 18px;
    font-weight: 600;
    color: #2C6B8F;
    text-align: center;
    margin-bottom: 8px;
}

.world-card-desc {
    font-size: 13px;
    color: #7FB5D1;
    text-align: center;
    line-height: 1.5;
}

.world-card-contacts {
    font-size: 12px;
    color: #999;
    text-align: center;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid #E8F4F8;
}

/* æ–°å»ºä¸–ç•ŒæŒ‰é’® */
.world-card.new-world {
    border: 2px dashed #5FB3D6;
    background: rgba(95, 179, 214, 0.05);
}



.world-worldbooks-list {
    margin-top: 12px;
    padding: 12px;
    background: white;
    border: 2px solid #B8D9E8;
    border-radius: 10px;
    max-height: 180px;
    overflow-y: auto;
}

.world-wb-item {
    display: flex;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid #F0F8FB;
    cursor: pointer;
    transition: background 0.2s;
}

.world-wb-item:last-child {
    border-bottom: none;
}

.world-wb-item:hover {
    background: #F8FCFD;
}

.world-wb-item input[type="checkbox"] {
    margin-right: 10px;
    cursor: pointer;
    width: 18px;
    height: 18px;
    accent-color: #5FB3D6;
}

.world-wb-item label {
    flex: 1;
    cursor: pointer;
    font-size: 14px;
    color: #2C6B8F;
}

.new-world-footer {
    display: flex;
    padding: 16px;
    gap: 12px;
    background: #F0F8FB;
    border-top: 2px solid #B8D9E8;
}

.world-btn {
    flex: 1;
    padding: 14px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.world-btn.btn-cancel {
    background: white;
    color: #7FB5D1;
    border: 2px solid #B8D9E8;
}

.world-btn.btn-cancel:hover {
    background: #F5F5F5;
    transform: translateY(-2px);
}

.world-btn.btn-save {
    background: linear-gradient(135deg, #5FB3D6, #4A9CBF);
    color: white;
    box-shadow: 0 4px 12px rgba(95, 179, 214, 0.4);
}

.world-btn.btn-save:hover {
    background: linear-gradient(135deg, #4A9CBF, #3D8AAD);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(95, 179, 214, 0.5);
}


/* ========== ä¸–ç•Œä¹¦é¡µé¢æ ·å¼ - å¼€å§‹ ========== */

/* 1. ä¸–ç•Œä¹¦ä¸»é¡µé¢å®¹å™¨ */
.worldbook-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #E8F5E9 0%, #F1F8E9 100%); /* æ¸…æ–°çš„ç»¿è‰²æ¸å˜ */
    transform: translateY(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1004;
    display: flex;
    flex-direction: column;
}

.worldbook-page.show {
    transform: translateY(0);
}

/* 2. å¤´éƒ¨å¯¼èˆªæ  */
.worldbook-header {
    display: flex;
    align-items: center;
    padding: 45px 20px 20px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.1);
    flex-shrink: 0;
}

.worldbook-title {
    flex: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    color: #4CAF50;
    margin-right: 36px;
}

/* 3. å†…å®¹åŒºåŸŸ */
.worldbook-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
}

.worldbook-content::-webkit-scrollbar {
    display: none;
}

/* 4. ç©ºçŠ¶æ€æç¤º */
.worldbook-empty {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: #81C784;
    padding: 40px 20px;
}

.worldbook-empty-icon {
    font-size: 64px;
    margin-bottom: 16px;
}

.worldbook-empty-text {
    font-size: 15px;
    line-height: 1.6;
    margin-bottom: 8px;
}

.worldbook-empty-hint {
    font-size: 13px;
    color: #A5D6A7;
}

/* 5. ä¸–ç•Œä¹¦æ¡ç›®åˆ—è¡¨ */
.worldbook-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.worldbook-item {
    background: white;
    padding: 16px;
    border-radius: 16px;
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.08);
    cursor: pointer;
    transition: all 0.2s ease;
    border-left: 4px solid #4CAF50;
}

.worldbook-item:active {
    transform: scale(0.98);
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.15);
}

.worldbook-item-title {
    font-size: 16px;
    font-weight: 600;
    color: #2E7D32;
    margin-bottom: 8px;
}

.worldbook-item-category {
    font-size: 12px;
    color: #81C784;
    background: #E8F5E9;
    padding: 4px 10px;
    border-radius: 12px;
    display: inline-block;
    margin-bottom: 8px;
}

.worldbook-item-preview {
    font-size: 13px;
    color: #66BB6A;
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

/* ========== ä¸–ç•Œä¹¦å¼¹çª—æ ·å¼ - å¼€å§‹ ========== */

.worldbook-modal {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    z-index: 1015;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    backdrop-filter: blur(5px);
}

.worldbook-modal.show {
    opacity: 1;
    visibility: visible;
}

.worldbook-modal-card {
    background: #fff;
    border-radius: 20px;
    width: 100%;
    max-width: 340px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.worldbook-modal.show .worldbook-modal-card {
    transform: scale(1);
}

.worldbook-modal-header {
    padding: 20px;
    border-bottom: 1px solid #E8F5E9;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.worldbook-modal-title {
    font-size: 18px;
    font-weight: 600;
    color: #2E7D32;
}

.worldbook-modal-close {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #F1F8E9;
    border: none;
    color: #4CAF50;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.worldbook-modal-close:hover {
    background: #E8F5E9;
    transform: rotate(90deg);
}

.worldbook-modal-body {
    padding: 20px;
}

.worldbook-form-group {
    margin-bottom: 20px;
}

.worldbook-form-label {
    display: block;
    font-size: 13px;
    font-weight: 600;
    color: #388E3C;
    margin-bottom: 8px;
}

.worldbook-form-input,
.worldbook-form-textarea {
    width: 100%;
    padding: 12px;
    border: 2px solid #C8E6C9;
    border-radius: 12px;
    font-size: 14px;
    color: #2E7D32;
    transition: border-color 0.2s;
    font-family: inherit;
}

.worldbook-form-input:focus,
.worldbook-form-textarea:focus {
    outline: none;
    border-color: #4CAF50;
}

.worldbook-form-textarea {
    min-height: 100px;
    resize: vertical;
}

.worldbook-modal-footer {
    padding: 16px 20px;
    border-top: 1px solid #E8F5E9;
    display: flex;
    gap: 12px;
}

.worldbook-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.worldbook-btn-cancel {
    background: #F1F8E9;
    color: #689F38;
}

.worldbook-btn-cancel:active {
    background: #E8F5E9;
}

.worldbook-btn-save {
    background: linear-gradient(135deg, #66BB6A, #43A047);
    color: white;
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
}

.worldbook-btn-save:active {
    transform: scale(0.97);
}

.worldbook-btn-delete {
    background: #FFEBEE;
    color: #E53935;
}

.worldbook-btn-delete:active {
    background: #FFCDD2;
}

/* åˆ†ç»„é€‰æ‹©å™¨æ ·å¼ */
.worldbook-category-selector {
    position: relative;
    cursor: pointer;
}

.category-selected {
    padding: 12px;
    border: 2px solid #C8E6C9;
    border-radius: 12px;
    background: white;
    font-size: 14px;
    color: #2E7D32;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.category-selected::after {
    content: 'â–¼';
    font-size: 12px;
    color: #81C784;
    transition: transform 0.3s;
}

.worldbook-category-selector.active .category-selected::after {
    transform: rotate(180deg);
}

.category-options {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 2px solid #C8E6C9;
    border-radius: 12px;
    margin-top: 4px;
    overflow: hidden;
    max-height: 0;
    opacity: 0;
    transition: all 0.3s ease;
    z-index: 10;
}

.worldbook-category-selector.active .category-options {
    max-height: 200px;
    opacity: 1;
}

.category-option {
    padding: 12px;
    font-size: 14px;
    color: #2E7D32;
    cursor: pointer;
    transition: background 0.2s;
}

.category-option:hover {
    background: #E8F5E9;
}

.category-option.selected {
    background: #C8E6C9;
    font-weight: 600;
}

/* åˆ†ç»„ç®¡ç†æŒ‰é’® */
.category-manage-btn {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    background: rgba(168, 201, 245, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.2s;
    color: #4CAF50;
    font-weight: bold;
    margin-left: 8px;
}

.category-manage-btn:active {
    transform: scale(0.9);
    background: rgba(168, 201, 245, 0.25);
}

/* ========== åˆ†ç»„ç®¡ç†é¡µé¢æ ·å¼ - å¼€å§‹ ========== */
/* ========== åˆ†ç±»ç®¡ç†é¡µé¢æ ·å¼ ========== */
.category-manage-page#classificationManagePage {
    z-index: 1006; /* ç¡®ä¿å±‚çº§æ¯”ä¸–ç•Œä¹¦é¡µé¢é«˜ */
}

/* 1. ä¸»é¡µé¢å®¹å™¨ */
.category-manage-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #FFE8E8 0%, #F5DDD3 100%); /* ç²‰è¤è‰²æ¸å˜ */
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1005;
    display: flex;
    flex-direction: column;
}

.category-manage-page.show {
    transform: translateX(0);
}

/* 2. å¤´éƒ¨å¯¼èˆª */
.category-manage-header {
    display: flex;
    align-items: center;
    padding: 45px 20px 20px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(161, 136, 127, 0.1);
    flex-shrink: 0;
}

.category-manage-title {
    flex: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    color: #A1887F;
    margin-right: 36px;
}

.add-category-btn {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    background: rgba(255, 192, 203, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    transition: all 0.2s;
    color: #D4A5A5;
    font-weight: bold;
}

.add-category-btn:active {
    transform: scale(0.9);
    background: rgba(255, 192, 203, 0.3);
}

/* 3. å†…å®¹åŒºåŸŸ */
.category-manage-content {
    flex: 1;
    overflow-y: auto;
    padding-top: 12px;
}

.category-manage-content::-webkit-scrollbar {
    display: none;
}

/* 4. ç©ºçŠ¶æ€ */
.category-empty {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: #D4A5A5;
    padding: 60px 20px;
}

.category-empty-icon {
    font-size: 64px;
    margin-bottom: 16px;
}

.category-empty-text {
    font-size: 15px;
    line-height: 1.6;
    margin-bottom: 8px;
}

.category-empty-hint {
    font-size: 13px;
    color: #E6C4B8;
}

/* 5. åˆ†ç»„åˆ—è¡¨ */
.category-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 0 20px 20px;
}

/* 6. åˆ†ç»„é¡¹ */
.category-item {
    background: white;
    border-radius: 16px;
    box-shadow: 0 2px 8px rgba(161, 136, 127, 0.08);
    overflow: hidden;
}

.category-item-header {
    display: flex;
    align-items: center;
    padding: 16px;
    cursor: pointer;
    transition: background 0.2s;
}

.category-item-header:active {
    background: #FFF5F5;
}

.category-item-icon {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    background: linear-gradient(135deg, #FFD1DC, #F5C9C9);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    margin-right: 12px;
    flex-shrink: 0;
}

.category-item-info {
    flex: 1;
    min-width: 0;
}

.category-item-name {
    font-size: 16px;
    font-weight: 600;
    color: #8D6E63;
    margin-bottom: 4px;
}

.category-item-count {
    font-size: 12px;
    color: #BCAAA4;
}

.category-item-arrow {
    font-size: 18px;
    color: #D4A5A5;
    transition: transform 0.3s;
}

.category-item.expanded .category-item-arrow {
    transform: rotate(90deg);
}

/* 7. ä¸–ç•Œä¹¦æ¡ç›®åˆ—è¡¨ */
.category-worldbooks {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background: #FFF8F5;
}

.category-item.expanded .category-worldbooks {
    max-height: 500px;
}

.worldbook-mini-item {
    padding: 12px 16px;
    border-top: 1px solid #FFE8E8;
    cursor: pointer;
    transition: background 0.2s;
}

.worldbook-mini-item:active {
    background: #FFEAEA;
}

.worldbook-mini-title {
    font-size: 14px;
    color: #8D6E63;
    margin-bottom: 4px;
}

.worldbook-mini-preview {
    font-size: 12px;
    color: #BCAAA4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* ========== æ–°å»ºåˆ†ç»„å¼¹çª—æ ·å¼ ========== */

.category-modal {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    z-index: 1016;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    backdrop-filter: blur(5px);
}

.category-modal.show {
    opacity: 1;
    visibility: visible;
}

.category-modal-card {
    background: #fff;
    border-radius: 20px;
    width: 100%;
    max-width: 340px;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.category-modal.show .category-modal-card {
    transform: scale(1);
}

.category-modal-header {
    padding: 20px;
    border-bottom: 1px solid #FFE8E8;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.category-modal-title {
    font-size: 18px;
    font-weight: 600;
    color: #8D6E63;
}

.category-modal-close {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #FFF5F5;
    border: none;
    color: #D4A5A5;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.category-modal-close:hover {
    background: #FFE8E8;
    transform: rotate(90deg);
}

.category-modal-body {
    padding: 20px;
}

.category-form-group {
    margin-bottom: 20px;
}

.category-form-label {
    display: block;
    font-size: 13px;
    font-weight: 600;
    color: #A1887F;
    margin-bottom: 8px;
}

.category-form-input,
.category-form-textarea {
    width: 100%;
    padding: 12px;
    border: 2px solid #FFD1DC;
    border-radius: 12px;
    font-size: 14px;
    color: #8D6E63;
    transition: border-color 0.2s;
    font-family: inherit;
}

.category-form-input:focus,
.category-form-textarea:focus {
    outline: none;
    border-color: #FFC0CB;
}

.category-form-textarea {
    min-height: 80px;
    resize: vertical;
}

.category-modal-footer {
    padding: 16px 20px;
    border-top: 1px solid #FFE8E8;
    display: flex;
    gap: 12px;
}

.category-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.category-btn-cancel {
    background: #FFF5F5;
    color: #D4A5A5;
}

.category-btn-cancel:active {
    background: #FFE8E8;
}

.category-btn-save {
    background: linear-gradient(135deg, #FFB6C1, #FFA5B8);
    color: white;
    box-shadow: 0 4px 12px rgba(255, 182, 193, 0.3);
}

.category-btn-save:active {
    transform: scale(0.97);
}

.category-btn-delete {
    background: #FFEBEE;
    color: #E53935;
}

.category-btn-delete:active {
    background: #FFCDD2;
}

/* ========== åˆ†ç»„ç®¡ç†æ ·å¼ - ç»“æŸ ========== */
/* ========== æ–°å¢ï¼šä¸–ç•Œåœ°å›¾åŠŸèƒ½æ ·å¼ ========== */
.world-map-preview-container {
    width: 100%;
    height: 120px;
    border: 2px dashed #B8D9E8;
    border-radius: 12px;
    background-color: rgba(255, 255, 255, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
}

.world-map-preview-container:hover {
    border-color: #5FB3D6;
    background-color: rgba(255, 255, 255, 0.9);
}

#worldMapPreview {
    width: 100%;
    height: 100%;
    object-fit: cover; /* å›¾ç‰‡ä¸å˜å½¢åœ°å¡«å……å®¹å™¨ */
}

#worldMapPlaceholder {
    font-size: 14px;
    font-weight: 500;
    color: #7FB5D1;
}

.world-map-options {
    display: none; /* é»˜è®¤éšè— */
    gap: 10px;
    margin-top: 10px;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(-5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.world-map-btn {
    flex: 1;
    padding: 10px;
    border: 2px solid #B8D9E8;
    border-radius: 10px;
    background: white;
    color: #2C6B8F;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s ease;
}

.world-map-btn:hover {
    border-color: #5FB3D6;
    background-color: #F0F8FB;
}


/* ========== ä¸–ç•Œä¹¦æ ·å¼ - ç»“æŸ ========== */
/* ========== æ•°ç åƒç´ çŒ«ç»„ä»¶æ ·å¼ - å¼€å§‹ ========== */

.cat-widget {
    position: absolute;
    width: 100%;
    height: 100%;
    /* èƒŒæ™¯å¯ä»¥æ ¹æ®å–œå¥½è°ƒæ•´ï¼Œè¿™é‡Œä¿ç•™äº†åŸæœ‰çš„å¯çˆ±é£æ ¼ */
    background: linear-gradient(135deg, #FFE5F0 0%, #FFF0F8 100%);
    border-radius: 22px;
    padding: 16px;
    overflow: visible;
    box-shadow: 0 6px 20px rgba(161, 136, 127, 0.15);
    border: 3px solid #FFB6C1;
}

/* åƒç´ çŒ«ä¸»ä½“å®¹å™¨ */
/* ç”¨è¿™æ®µå…¨æ–°çš„ä»£ç æ›¿æ¢æ—§çš„ .pixel-cat-body */
.pixel-cat-body {
    position: absolute;
    width: 68px;
    height: 72px; /* ç¨å¾®å¢åŠ é«˜åº¦ï¼Œä¸ºåŠ¨ç”»ç•™å‡ºç©ºé—´ */
    bottom: 40px; /* é‡æ–°å¾®è°ƒä½ç½® */
    left: 50%;
    transform: translateX(-50%);
    /* æ–°å¢ï¼šåº”ç”¨åŠ¨ç”» */
    animation: catBreathe 2.5s ease-in-out infinite;
}


/* ç”¨è¿™æ®µå…¨æ–°çš„ä»£ç æ›¿æ¢æ—§çš„ .pixel-cat-body::before */
/* ç²˜è´´è¿™æ®µå…¨æ–°çš„ä»£ç ï¼Œå®ƒåŒ…å«äº†æ–°çš„ç»˜åˆ¶é€»è¾‘å’ŒåŠ¨ç”»å®šä¹‰ */

/* ä½¿ç”¨ ::before ç»˜åˆ¶çŒ«å’ªçš„è½®å»“å’Œèº«ä½“ä¸»ä½“ */
.pixel-cat-body::before {
    content: '';
    position: absolute;
    width: 4px;
    height: 4px;
    /* è¿™æ¬¡æˆ‘ä»¬ç”¨çº¯é»‘è‰² #222 ä½œä¸ºåŸºå‡†é¢œè‰²æ¥ç”»è½®å»“ */
    background: #222;

    /* å…¨æ–°é‡ç»˜çš„åƒç´ å›¾ */
    box-shadow: /* è€³æœµ */ 4px -12px 0 #222, 8px -12px 0 #222, 12px -12px 0 #222,
    32px -12px 0 #222, 36px -12px 0 #222, 40px -12px 0 #222,
    0 -8px 0 #222, 4px -8px 0 #f2c1b1, 8px -8px 0 #f2c1b1, 12px -8px 0 #c6b9b3, 16px -8px 0 #222,
    28px -8px 0 #222, 32px -8px 0 #c6b9b3, 36px -8px 0 #f2c1b1, 40px -8px 0 #f2c1b1, 44px -8px 0 #222,
    -4px -4px 0 #222, 0 -4px 0 #c6b9b3, 4px -4px 0 #c6b9b3, 12px -4px 0 #a1928b, 16px -4px 0 #a1928b, 20px -4px 0 #222,
    24px -4px 0 #222, 28px -4px 0 #a1928b, 32px -4px 0 #a1928b, 40px -4px 0 #c6b9b3, 44px -4px 0 #c6b9b3, 48px -4px 0 #222,
    -4px 0 0 #222, 0 0 #c6b9b3, 4px 0 0 #c6b9b3, 8px 0 0 #f5efed, 12px 0 0 #f5efed, 16px 0 0 #f5efed, 20px 0 0 #f5efed, 24px 0 0 #f5efed, 28px 0 0 #f5efed, 32px 0 0 #f5efed, 36px 0 0 #f5efed, 40px 0 0 #c6b9b3, 44px 0 0 #c6b9b3, 48px 0 0 #222,
        /* çœ¼ç›å’Œè„¸é¢Š */ -8px 4px 0 #222, -4px 4px 0 #c6b9b3, 0 4px 0 #f2c1b1, 4px 4px 0 #f5efed, 8px 4px 0 #222, 12px 4px 0 #222, 16px 4px 0 #f5efed, 20px 4px 0 #f5efed, 24px 4px 0 #222, 28px 4px 0 #222, 32px 4px 0 #f5efed, 36px 4px 0 #f2c1b1, 40px 4px 0 #c6b9b3, 44px 4px 0 #222, 48px 4px 0 #222,
    -8px 8px 0 #222, -4px 8px 0 #c6b9b3, 0 8px 0 #c6b9b3, 4px 8px 0 #f5efed, 8px 8px 0 #f5efed, 12px 8px 0 #222, 16px 8px 0 #f5efed, 20px 8px 0 #f5efed, 24px 8px 0 #222, 28px 8px 0 #f5efed, 32px 8px 0 #f5efed, 36px 8px 0 #c6b9b3, 40px 8px 0 #c6b9b3, 44px 8px 0 #222,
    -4px 12px 0 #222, 0 12px 0 #f5efed, 4px 12px 0 #f5efed, 8px 12px 0 #4b3f3a, 12px 12px 0 #4b3f3a, 16px 12px 0 #f5efed, 20px 12px 0 #f5efed, 24px 12px 0 #4b3f3a, 28px 12px 0 #4b3f3a, 32px 12px 0 #f5efed, 36px 12px 0 #f5efed, 40px 12px 0 #222,
    0 16px 0 #222, 4px 16px 0 #f5efed, 8px 16px 0 #f5efed, 12px 16px 0 #f5efed, 16px 16px 0 #f5efed, 20px 16px 0 #f5efed, 24px 16px 0 #f5efed, 28px 16px 0 #f5efed, 32px 16px 0 #f5efed, 36px 16px 0 #222,
    4px 20px 0 #222, 8px 20px 0 #222, 12px 20px 0 #4b3f3a, 16px 20px 0 #e8ded8, 20px 20px 0 #4b3f3a, 24px 20px 0 #e8ded8, 28px 20px 0 #4b3f3a, 32px 20px 0 #222,
        /* èº«ä½“ */ 8px 24px 0 #222, 12px 24px 0 #f5efed, 16px 24px 0 #f5efed, 20px 24px 0 #f5efed, 24px 24px 0 #f5efed, 28px 24px 0 #c6b9b3, 32px 24px 0 #222,
    8px 28px 0 #f5efed, 12px 28px 0 #222, 16px 28px 0 #c6b9b3, 20px 28px 0 #f5efed, 24px 28px 0 #f5efed, 28px 28px 0 #222, 32px 28px 0 #a1928b, 36px 28px 0 #222, 40px 28px 0 #c6b9b3, 44px 28px 0 #222,
    4px 32px 0 #a1928b, 8px 32px 0 #f5efed, 12px 32px 0 #f5efed, 16px 32px 0 #f5efed, 20px 32px 0 #f5efed, 24px 32px 0 #e8ded8, 28px 32px 0 #a1928b, 32px 32px 0 #c6b9b3, 36px 32px 0 #a1928b, 40px 32px 0 #222,
    0 36px 0 #222, 4px 36px 0 #4b3f3a, 8px 36px 0 #f5efed, 12px 36px 0 #f5efed, 16px 36px 0 #e8ded8, 20px 36px 0 #f5efed, 24px 36px 0 #222, 28px 36px 0 #4b3f3a, 32px 36px 0 #4b3f3a,
    -4px 40px 0 #222, 0 40px 0 #a1928b, 4px 40px 0 #f5efed, 8px 40px 0 #222, 12px 40px 0 #f5efed, 16px 40px 0 #f5efed, 20px 40px 0 #222, 28px 40px 0 #222,
    -4px 44px 0 #222, 0 44px 0 #a1928b, 4px 44px 0 #f5efed, 8px 44px 0 #222, 12px 44px 0 #f5efed, 16px 44px 0 #f5efed, 20px 44px 0 #222,
    -4px 48px 0 #222, 0 48px 0 #222, 4px 48px 0 #222, 8px 48px 0 #222, 12px 48px 0 #222, 16px 48px 0 #222, 20px 48px 0 #222;

}

/* ä½¿ç”¨ ::after ç»˜åˆ¶å°¾å·´å’Œçœ¼ç›é«˜å…‰ */
.pixel-cat-body::after {
    content: '';
    position: absolute;
    width: 4px;
    height: 4px;
    background: white; /* åŸºå‡†ç‚¹æ˜¯çœ¼ç›é«˜å…‰ */
    top: 8px; /* è°ƒæ•´é«˜å…‰çš„å‚ç›´ä½ç½® */
    left: 12px;

    box-shadow: /* å¦ä¸€åªçœ¼ç›çš„é«˜å…‰ */ 16px 0 0 white,
        /* å°¾å·´ */ -20px 24px 0 #222, -16px 24px 0 #a1928b, -12px 24px 0 #a1928b, -8px 24px 0 #222,
    -24px 28px 0 #222, -20px 28px 0 #a1928b, -16px 28px 0 #8d7e78, -12px 28px 0 #a1928b, -8px 28px 0 #222,
    -24px 32px 0 #222, -20px 32px 0 #8d7e78, -16px 32px 0 #a1928b, -12px 32px 0 #222,
    -24px 36px 0 #222, -20px 36px 0 #222, -16px 36px 0 #222;
}

/* å®šä¹‰å‘¼å¸åŠ¨ç”» */
@keyframes catBreathe {
    0%, 100% {
        transform: translateX(-50%) translateY(0);
    }
    50% {
        transform: translateX(-50%) translateY(-2px); /* å‘ä¸Šè½»å¾®ç§»åŠ¨2åƒç´  */
    }
}


/* çŠ¶æ€æ•°æ®æ¡å®¹å™¨ */
.cat-stats-container {
    position: absolute;
    top: 12px;
    left: 12px;
    right: 12px;
    background: rgba(255, 255, 255, 0.9);
    padding: 10px 12px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    /* ğŸ”§ æ–°å¢ä¼˜åŒ– */
    backface-visibility: hidden;
    transform: translateZ(0);
    will-change: transform;
}

/* å•ä¸ªçŠ¶æ€æ¡ */
.cat-stat-item {
    margin-bottom: 8px;
    cursor: pointer;
    transition: transform 0.2s;
}

.cat-stat-item:hover {
    transform: scale(1.02);
}

.cat-stat-item:last-child {
    margin-bottom: 0;
}

/* çŠ¶æ€æ ‡ç­¾ */
.cat-stat-label {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 11px;
    font-weight: 600;
    color: #8D6E63;
    margin-bottom: 4px;
}

.cat-stat-value {
    font-size: 10px;
    color: #A1887F;
}

/* çŠ¶æ€æ¡èƒŒæ™¯ */
.cat-stat-bar-bg {
    height: 8px;
    background: #F5F5F5;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* çŠ¶æ€æ¡å¡«å…… */
.cat-stat-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #FFB6C1, #FF9AAD);
    border-radius: 10px;
    transition: width 0.3s ease;
    position: relative;
}

/* ä¸åŒçŠ¶æ€çš„é¢œè‰² */
.cat-stat-item[data-stat="happiness"] .cat-stat-bar-fill {
    background: linear-gradient(90deg, #FFD700, #FFA500);
}

.cat-stat-item[data-stat="hunger"] .cat-stat-bar-fill {
    background: linear-gradient(90deg, #90EE90, #32CD32);
}

.cat-stat-item[data-stat="energy"] .cat-stat-bar-fill {
    background: linear-gradient(90deg, #87CEEB, #4682B4);
}

.cat-stat-item[data-stat="cleanliness"] .cat-stat-bar-fill {
    background: linear-gradient(90deg, #DDA0DD, #BA55D3);
}

/* ğŸ”§ ä¼˜åŒ–åçš„é—ªå…‰æ•ˆæœ */
.cat-stat-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 50%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
    transform: translateX(-100%);
    will-change: transform; /* æç¤ºæµè§ˆå™¨ä¼˜åŒ–æ­¤å±æ€§ */
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% {
        transform: translateX(-100%);
    }
    100% {
        transform: translateX(400%);
    }
}


/* çŒ«å’ªå¯¹è¯æ°”æ³¡ */
.cat-speech-bubble {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    max-width: 75%;
    background: white;
    padding: 10px 14px;
    border-radius: 16px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    font-size: 13px;
    color: #8D6E63;
    line-height: 1.4;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
    border: 2px solid #FFB6C1;
}

.cat-speech-bubble:hover {
    background: #FFF5F5;
    transform: translateX(-50%) scale(1.03);
}

/* æ°”æ³¡å°å°¾å·´ */
.cat-speech-bubble::before {
    content: '';
    position: absolute;
    top: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 8px solid #FFB6C1;
}

.cat-speech-bubble::after {
    content: '';
    position: absolute;
    top: -5px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid white;
}

/* åˆ é™¤æŒ‰é’® */
.cat-widget .delete-widget-btn {
    display: none;
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px;
    height: 24px;
    background: rgba(255, 71, 87, 0.9);
    border-radius: 50%;
    color: white;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    z-index: 250;
    align-items: center;
    justify-content: center;
}

.cat-widget.show-delete .delete-widget-btn {
    display: flex;
}

/* ========== ä¿®å¤èŠå¤©æ°”æ³¡é¡¶éƒ¨ç©ºç™½é—®é¢˜ ========== */

/* 1. ç§»é™¤ä¸»æ¶ˆæ¯æ–‡æœ¬çš„é¡¶éƒ¨è¾¹è· */
.chat-bubble .main-message-text {
    margin-top: 0;
}

/* 2. å½“æœ‰å¼•ç”¨å†…å®¹æ—¶ï¼Œæ‰æ·»åŠ é—´è· */
.chat-bubble .quoted-message-wrapper + .main-message-text {
    margin-top: 4px;
}

/* 3. ç¡®ä¿æ°”æ³¡å†…ç¬¬ä¸€ä¸ªå…ƒç´ æ²¡æœ‰é¡¶éƒ¨è¾¹è· */
.chat-bubble > *:first-child {
    margin-top: 0;
}

/* 4. ç¡®ä¿æ°”æ³¡å†…æœ€åä¸€ä¸ªå…ƒç´ æ²¡æœ‰åº•éƒ¨è¾¹è· */
.chat-bubble > *:last-child {
    margin-bottom: 0;
}

/* 5. å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œå¯ä»¥å°è¯•å‡å°‘æ°”æ³¡çš„å†…è¾¹è· */
.chat-bubble {
    padding: 10px 12px; /* åŸæ¥æ˜¯ 12pxï¼Œç¨å¾®å‡å°‘é¡¶éƒ¨å†…è¾¹è· */
}

/* 6. ç¡®ä¿ä»£ç å—ä¹Ÿæ²¡æœ‰é¢å¤–çš„é¡¶éƒ¨è¾¹è· */
.chat-bubble .code-block-wrapper:first-child {
    margin-top: 0;
}

/* é’ˆå¯¹ç‰¹å®šçˆ¶å…ƒç´ å†…éƒ¨çš„ç›´æ¥å­çº§ <br> æ ‡ç­¾è¿›è¡Œéšè— */
.code-block-wrapper > br {
    display: none;
}


/* ========== å¯†å‹è®¾ç½®ç•Œé¢æ ·å¼ ========== */
.sweetheart-settings-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #FFF0F5 0%, #FFE4E9 100%);
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1009;
    display: flex;
    flex-direction: column;
}

.sweetheart-settings-page.show {
    transform: translateX(0);
}

/* åœ°å›¾ç¼–è¾‘é¡µé¢æ ·å¼ */
.map-editor-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #F5F5F5;
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1010;
    display: flex;
    flex-direction: column;
}

.map-editor-page.show {
    transform: translateX(0);
}

.map-editor-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 45px 20px 20px;
    background: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.map-editor-title {
    flex: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    color: #333;
}

.map-save-btn {
    padding: 8px 16px;
    background: #4FC3F7;
    color: white;
    border-radius: 16px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
}

/* ... existing code ... */

/* åœ°å›¾ç¼–è¾‘é¡µé¢æ ·å¼ */
/* ... existing styles for map-editor-page ... */

/* âœ¨ æ–°å¢ï¼šåœ°å›¾ä¸Šä¼ æŒ‰é’®æ ·å¼ */
.map-upload-btn {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    background: rgba(168, 201, 245, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    margin-right: 8px; /* ä¸ä¿å­˜æŒ‰é’®çš„é—´è· */
    transition: all 0.2s;
}

.map-upload-btn:active {
    transform: scale(0.9);
    background: rgba(168, 201, 245, 0.25);
}

.map-editor-content {
    flex: 1;
    overflow: auto;
    padding: 20px;
}

/* ä¿®æ”¹åœ°å›¾å®¹å™¨æ ·å¼ - è‡ªé€‚åº”å›¾ç‰‡ */
.map-container {
    position: relative;
    width: 100%;
    background: white;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    cursor: crosshair;
    /* ç§»é™¤å›ºå®šé«˜åº¦ï¼Œè®©å®¹å™¨è‡ªé€‚åº”å†…å®¹ */
    display: inline-block;
}

#worldMapImage {
    width: 100%;
    height: auto;
    display: block;
    max-height: 60vh; /* é™åˆ¶æœ€å¤§é«˜åº¦ */
    object-fit: contain; /* ä¿æŒå›¾ç‰‡æ¯”ä¾‹ */
}

/* åœ°å›¾ä¸ºç©ºæ—¶çš„å ä½æ ·å¼ */
.map-container.empty {
    min-height: 400px;
    background: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
}

.map-container.empty::before {
    content: 'è¯·å…ˆè®¾ç½®ä¸–ç•Œåœ°å›¾';
    color: #999;
    font-size: 14px;
}

/* ä¿®æ”¹å¤§å¤´é’ˆæ ·å¼ï¼Œæ·»åŠ æ‹–åŠ¨çŠ¶æ€ */
.map-pin {
    position: absolute;
    width: 32px;
    height: 32px;
    cursor: pointer;
    transform: translate(-50%, -100%);
    transition: transform 0.2s;
    z-index: 10;
    user-select: none; /* é˜²æ­¢é€‰ä¸­æ–‡å­— */
    -webkit-user-select: none;
}

.map-pin.dragging {
    cursor: grabbing;
    transform: translate(-50%, -100%) scale(1.3);
    z-index: 100;
    transition: none;
}

.map-pin:hover:not(.dragging) {
    transform: translate(-50%, -100%) scale(1.2);
}

/* æ‹–åŠ¨æ—¶çš„æç¤º */
.drag-hint {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 12px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s, visibility 0.3s;
    z-index: 1000;
}

.drag-hint.show {
    opacity: 1;
    visibility: visible;
}

.map-pin:hover {
    transform: translate(-50%, -100%) scale(1.2);
}

.map-pin-icon {
    width: 100%;
    height: 100%;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.map-pin-label {
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 600;
    white-space: nowrap;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    opacity: 0;
    transition: opacity 0.2s;
}

.map-pin:hover .map-pin-label {
    opacity: 1;
}

.map-hint {
    margin-top: 16px;
    text-align: center;
    font-size: 13px;
    color: #666;
}

/* åœ°ç‚¹ç¼–è¾‘å¼¹çª—æ ·å¼ */
.location-modal-card {
    background: white;
    border-radius: 20px;
    width: 90%;
    max-width: 320px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

#locationModal.show .location-modal-card {
    transform: scale(1);
}

.location-modal-header {
    padding: 20px;
    border-bottom: 1px solid #E0E0E0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.location-modal-content {
    padding: 20px;
}

.location-field {
    margin-bottom: 16px;
}

.location-label {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
    font-size: 14px;
    font-weight: 600;
    color: #333;
}

.location-input,
.location-textarea,
.location-select {
    width: 100%;
    padding: 10px;
    border: 2px solid #E0E0E0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.2s;
}

.location-input:focus,
.location-textarea:focus,
.location-select:focus {
    outline: none;
    border-color: #4FC3F7;
}

.location-modal-footer {
    display: flex;
    gap: 12px;
    padding: 16px 20px;
    border-top: 1px solid #E0E0E0;
}

.location-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-delete {
    background: #FFE8E8;
    color: #FF5252;
}

.btn-save {
    background: #4FC3F7;
    color: white;
}

.modal-close-btn {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #F5F5F5;
    border: none;
    font-size: 18px;
    cursor: pointer;
}

/* â–¼â–¼â–¼ æ­¥éª¤äºŒï¼šåœ¨è¿™é‡Œç²˜è´´æ–°çš„CSSæ ·å¼ â–¼â–¼â–¼ */

/* 1. ä¸ºå¯†å‹èŠå¤©ä¸»é¡µé¢æ·»åŠ èƒŒæ™¯å›¾ç›¸å…³çš„æ ·å¼å’Œè¿‡æ¸¡æ•ˆæœ */
.sweetheart-chat-page {
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    /* ä¸ºèƒŒæ™¯å›¾åˆ‡æ¢æ·»åŠ ä¸€ä¸ªæŸ”å’Œçš„æ·¡å…¥æ·¡å‡ºåŠ¨ç”» */
    transition: background-image 0.5s ease-in-out, transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* 2. è®©æ¶ˆæ¯åŒºåŸŸçš„èƒŒæ™¯åŠé€æ˜ï¼Œè¿™æ ·æ‰èƒ½é€å‡ºä¸‹æ–¹çš„èƒŒæ™¯å›¾ */
.sweetheart-chat-messages {
    /* å°†çº¯è‰²èƒŒæ™¯æ”¹ä¸ºå¸¦é€æ˜åº¦çš„ç‰ˆæœ¬ */
    background-color: rgba(253, 246, 248, 0.85);
    /* å¦‚æœèƒŒæ™¯å›¾æ¯”è¾ƒäº®ï¼Œå¯ä»¥ä½¿ç”¨åŠé€æ˜çš„é»‘è‰²é®ç½©æ¥å‹æš—ï¼Œæå‡æ–‡å­—å¯è¯»æ€§ */
    /* background-color: rgba(0, 0, 0, 0.1); */

    /* æ·»åŠ ç£¨ç ‚ç»ç’ƒæ•ˆæœï¼Œè®©è´¨æ„Ÿæ›´é«˜çº§ */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px); /* å…¼å®¹ Safari */
}

/* â–²â–²â–² æ­¥éª¤äºŒï¼šç²˜è´´ç»“æŸ â–²â–²â–² */
/* ========== å¯†å‹èŠå¤©è®¾ç½® - AIè®°å¿†è½®æ•°æ­¥è¿›å™¨æ ·å¼ ========== */
.number-stepper {
    display: flex;
    align-items: center;
    background-color: #f0f2f5;
    border-radius: 8px;
    border: 1px solid #e0e4e8;
    overflow: hidden;
}

.stepper-btn {
    width: 28px;
    height: 28px;
    border: none;
    background-color: transparent;
    color: #8D6E63; /* ä½¿ç”¨ä¸»é¢˜æ£•è‰² */
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s;
}

.stepper-btn:hover {
    background-color: #e8eaed;
}

.stepper-input {
    width: 40px;
    height: 28px;
    border: none;
    border-left: 1px solid #e0e4e8;
    border-right: 1px solid #e0e4e8;
    text-align: center;
    font-size: 14px;
    font-weight: 600;
    color: #8D6E63;
    background-color: #fff;
    /* éšè—åŸç”Ÿæ•°å­—è¾“å…¥æ¡†çš„ç®­å¤´ */
    -moz-appearance: textfield;
}

.stepper-input::-webkit-outer-spin-button,
.stepper-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}

/* ========== ä¸–ç•Œè®¾å®šç¼–è¾‘é¡µé¢æ ·å¼ ========== */
.world-settings-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #E8F4F8 0%, #D4E9F0 100%);
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1011;
    display: flex;
    flex-direction: column;
}

.world-settings-page.show {
    transform: translateX(0);
}

.world-settings-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 45px 20px 20px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 8px rgba(76, 150, 175, 0.1);
}

.world-settings-title {
    flex: 1;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    color: #2C6B8F;
}

.world-settings-save-btn {
    padding: 8px 16px;
    background: linear-gradient(135deg, #5FB3D6, #4A9CBF);
    color: white;
    border-radius: 16px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.world-settings-save-btn:hover {
    transform: scale(1.05);
}

.world-settings-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

.world-settings-field {
    margin-bottom: 20px;
}

.field-label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
    font-size: 14px;
    font-weight: 600;
    color: #2C6B8F;
}

.label-icon {
    font-size: 18px;
}

.field-input,
.field-textarea,
.field-select {
    width: 100%;
    padding: 12px 14px;
    border: 2px solid #B8D9E8;
    border-radius: 12px;
    font-size: 14px;
    font-family: inherit;
    background: white;
    transition: all 0.2s ease;
}

.field-input:focus,
.field-textarea:focus,
.field-select:focus {
    outline: none;
    border-color: #5FB3D6;
    box-shadow: 0 0 0 3px rgba(95, 179, 214, 0.2);
}

.field-textarea {
    resize: vertical;
    min-height: 80px;
}

.field-select {
    cursor: pointer;
}

/* ========== å¼€å§‹ï¼šç²˜è´´è¿™æ®µå…¨æ–°çš„CSS ========== */

/* è®©å¯†å‹èŠå¤©è¾“å…¥åŒºåŸŸä¹Ÿèƒ½æˆä¸ºé™„ä»¶èœå•çš„å®šä½å‚è€ƒç‚¹ */
.sweetheart-chat-input-area {
    position: relative;
}

/* ç¡®ä¿é™„ä»¶èœå•åœ¨å¯†å‹èŠå¤©ç•Œé¢ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ */
.sweetheart-chat-input-area .attachment-menu {
    position: absolute;
    bottom: 60px; /* å®šä½åœ¨è¾“å…¥æ¡†ä¸Šæ–¹ */
    left: 12px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(161, 136, 127, 0.15); /* ä½¿ç”¨ä¸»é¢˜è‰²é˜´å½± */
    display: flex;
    gap: 16px;
    padding: 12px;
    opacity: 0;
    transform: translateY(10px);
    visibility: hidden;
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 10;
}

.sweetheart-chat-input-area .attachment-menu.show {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
}

/* ========== ç»“æŸï¼šç²˜è´´å…¨æ–°çš„CSS ========== */
/* ========== æ°”æ³¡åº“é¡µé¢æ ·å¼ ========== */

.bubble-library-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #f0f4f8 0%, #d9e2ec 100%);
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1003;
    display: flex;
    flex-direction: column;
}

.bubble-library-page.show {
    transform: translateX(0);
}

/* Tabåˆ‡æ¢ */
.bubble-tab-container {
    display: flex;
    gap: 8px;
    padding: 12px 20px 0;
    background: transparent;
}

.bubble-tab {
    flex: 1;
    padding: 12px;
    text-align: center;
    font-size: 14px;
    font-weight: 600;
    color: #666;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 12px 12px 0 0;
    cursor: pointer;
    transition: all 0.2s;
}

.bubble-tab.active {
    color: #333;
    background: white;
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05);
}

/* ç¼–è¾‘å™¨å®¹å™¨ */
.bubble-editor-container {
    padding: 0 20px 20px;
}

/* ä»£ç è¾“å…¥åŒºåŸŸ */
.bubble-code-section {
    background: white;
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.bubble-code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.bubble-code-label {
    font-size: 14px;
    font-weight: 600;
    color: #333;
}

.bubble-example-btn {
    padding: 6px 12px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.bubble-example-btn:active {
    transform: scale(0.95);
}

.bubble-code-input {
    width: 100%;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 12px;
    line-height: 1.5;
    color: #333;
    background: #f8f9fa;
    resize: vertical;
    transition: border-color 0.2s;
}

.bubble-code-input:focus {
    outline: none;
    border-color: #667eea;
    background: white;
}

/* æ“ä½œæŒ‰é’® */
.bubble-action-buttons {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.bubble-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.bubble-btn-preview {
    background: linear-gradient(135deg, #4facfe, #00f2fe);
    color: white;
}

.bubble-btn-apply {
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    color: white;
}

.bubble-btn-reset {
    background: #f1f2f6;
    color: #666;
}

.bubble-btn:active {
    transform: scale(0.97);
}

/* å¸®åŠ©è¯´æ˜ */
.bubble-help-section {
    padding: 0 20px;
}

.bubble-help-content {
    background: white;
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.bubble-help-content p {
    margin: 8px 0;
    font-size: 13px;
    color: #666;
    line-height: 1.6;
}

/* ========== é¢„è§ˆæ¡†æ ·å¼ ========== */

.bubble-preview-box {
    margin-top: 12px;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 2px dashed #e0e0e0;
}

.preview-label {
    font-size: 12px;
    color: #666;
    margin-bottom: 8px;
    font-weight: 600;
}

.preview-chat-container {
    background: white;
    padding: 12px;
    border-radius: 8px;
    min-height: 50px;
}

.preview-message {
    display: flex;
    margin: 4px 0;
}

.preview-message.sent {
    justify-content: flex-end;
}

.preview-message.received {
    justify-content: flex-start;
}

.preview-bubble {
    max-width: 70%;
    padding: 10px 14px;
    border-radius: 16px;
    font-size: 14px;
    word-break: break-word;
    /* é»˜è®¤æ ·å¼ */
    background: #e9e9eb;
    color: #333;
}

.preview-message.sent .preview-bubble {
    background: #0A84FF;
    color: white;
}

/* ========== é¢„è®¾åº“æ ·å¼ ========== */

.preset-library-section {
    margin-top: 24px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 12px;
    padding: 16px;
}

.preset-library-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.preset-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.preset-empty {
    text-align: center;
    padding: 40px 20px;
    color: #999;
    font-size: 13px;
}

.preset-card {
    background: white;
    border-radius: 12px;
    padding: 14px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    transition: all 0.2s;
}

.preset-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    transform: translateY(-2px);
}

.preset-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.preset-name {
    font-size: 14px;
    font-weight: 600;
    color: #333;
}

.preset-date {
    font-size: 11px;
    color: #999;
}

.preset-preview-mini {
    display: flex;
    gap: 8px;
    margin-bottom: 10px;
    padding: 8px;
    background: #f8f9fa;
    border-radius: 8px;
}

.mini-bubble {
    flex: 1;
    padding: 6px 10px;
    border-radius: 12px;
    font-size: 11px;
    text-align: center;
    /* é»˜è®¤æ ·å¼ä¼šè¢«å†…è”æ ·å¼è¦†ç›– */
}

.preset-actions {
    display: flex;
    gap: 8px;
}

.preset-btn {
    flex: 1;
    padding: 8px;
    border: none;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.apply-btn {
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    color: white;
}

.apply-btn:active {
    transform: scale(0.95);
}

.delete-btn {
    background: #ffe5e5;
    color: #ff4757;
}

.delete-btn:active {
    transform: scale(0.95);
    background: #ffcccc;
}

/* ä¿®æ”¹ä¿å­˜é¢„è®¾æŒ‰é’®æ ·å¼ */
.bubble-btn-save-preset {
    background: linear-gradient(135deg, #f093fb, #f5576c);
    color: white;
}

.delete-btn {
    background: #ffe5e5;
    color: #ff4757;
}

/* â–¼â–¼â–¼ åœ¨è¿™é‡Œç²˜è´´æ–°æ ·å¼ â–¼â–¼â–¼ */
.preset-tag {
    flex: 1;
    padding: 8px;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    text-align: center;
    background: #e9ecef;
    color: #868e96;
    user-select: none; /* ä¸å¯é€‰ä¸­ */
}

/* â–²â–²â–² ç²˜è´´ç»“æŸ â–²â–²â–² */
/* ====================================
   1. ä¿®å¤ï¼šå¤´éƒ¨çŠ¶æ€æŒ‰é’®æ ·å¼ (è®©æŒ‰é’®é‡æ–°æ˜¾ç¤ºå‡ºæ¥)
   ==================================== */
.status-btn {
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    border-radius: 8px;
    transition: background-color 0.2s;
    /* ç¡®ä¿æŒ‰é’®åœ¨å¤´éƒ¨çš„å¸ƒå±€ä¸­å ä½ */
    flex-shrink: 0;
}

.status-btn:hover {
    background-color: rgba(255, 255, 255, 0.2);
}

.status-btn svg {
    width: 22px;
    height: 22px;
    fill: white; /* è¿™é‡Œçš„é¢œè‰²å–å†³äºä½ çš„ Header èƒŒæ™¯ã€‚å¦‚æœæ˜¯æµ…è‰²Headerï¼Œè¿™é‡Œå¯èƒ½è¦æ”¹ #333 */
    opacity: 0.9;
    transition: opacity 0.2s;
}

/* é’ˆå¯¹å¯†å‹èŠå¤©ï¼ˆç²‰è‰²ä¸»é¢˜ï¼‰çš„ç‰¹æ®Šé€‚é… */
.sweetheart-chat-header .status-btn svg {
    fill: white; /* åœ¨ç²‰è‰²æ¸å˜èƒŒæ™¯ä¸Šç”¨ç™½è‰²å›¾æ ‡ */
}

/* ====================================
   2. æ–°å¢ï¼šè®°å¿†HUD (æ‚¬æµ®è¡¨æ ¼) æ ·å¼
   ==================================== */
.memory-hud {
    position: absolute;
    top: 75px; /* ä½äºå¤´éƒ¨ä¸‹æ–¹ */
    right: 12px; /* é å³æ‚¬æµ® */
    width: 280px;

    /* ç£¨ç ‚ç»ç’ƒè´¨æ„Ÿ */
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);

    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(161, 136, 127, 0.15); /* æŸ”å’Œé˜´å½± */
    border: 1px solid rgba(255, 255, 255, 0.8);
    z-index: 900; /* é«˜äºæ¶ˆæ¯å†…å®¹ */
    padding: 12px 16px;

    /* é»˜è®¤éšè—çŠ¶æ€ */
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px) scale(0.95);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    pointer-events: none;
}

/* æ˜¾ç¤ºçŠ¶æ€ */
.memory-hud.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
    pointer-events: auto;
}

.memory-hud-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px dashed rgba(141, 110, 99, 0.2);
}

.hud-title {
    font-size: 13px;
    font-weight: 700;
    color: #8D6E63; /* æ£•è‰²ä¸»é¢˜æ–‡å­— */
    display: flex;
    align-items: center;
    gap: 6px;
}

.hud-edit-btn {
    font-size: 14px;
    cursor: pointer;
    color: #BCAAA4;
    transition: color 0.2s;
}
.hud-edit-btn:hover { color: #8D6E63; }

/* è¡¨æ ¼æ ·å¼ */
.memory-table-container {
    max-height: 200px; /* é˜²æ­¢å†…å®¹å¤ªé•¿é®æŒ¡èŠå¤© */
    overflow-y: auto;
}

.memory-table {
    width: 100%;
    border-collapse: collapse;
}

.memory-table th {
    text-align: left;
    font-size: 11px;
    color: #BCAAA4;
    padding-bottom: 6px;
    font-weight: 500;
}

.memory-table td {
    font-size: 12px;
    color: #5D4037;
    padding: 6px 0;
    vertical-align: top;
    line-height: 1.4;
    border-bottom: 1px solid rgba(0,0,0,0.03);
}

.memory-table tr:last-child td {
    border-bottom: none;
}

/* ç¬¬ä¸€è¡Œï¼ˆæœ€æ–°çŠ¶æ€ï¼‰é«˜äº® */
.memory-table tr:first-child td {
    color: #E91E63;
    font-weight: 600;
}
/* ========== æç®€è®°å¿†ç¼–è¾‘å¼¹çª—æ ·å¼ ========== */
.simple-edit-card {
    background: #fff;
    width: 85%;
    max-width: 320px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 40px rgba(161, 136, 127, 0.2);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    border: 2px solid #FFD1DC; /* ç²‰è‰²è¾¹æ¡† */
}

#simpleStatusEditModal.show .simple-edit-card {
    transform: scale(1);
}

.simple-edit-header {
    background: linear-gradient(135deg, #FFB6C1, #FFC0D9);
    padding: 16px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.simple-edit-header h3 {
    margin: 0;
    font-size: 16px;
    color: white;
    font-weight: 600;
}

.simple-edit-header .close-btn {
    color: white;
    font-size: 24px;
    cursor: pointer;
    line-height: 1;
}

.simple-edit-body {
    padding: 20px;
    background: #FFF5F8; /* ææ·¡ç²‰è‰²èƒŒæ™¯ */
}

.simple-input-group {
    margin-bottom: 16px;
}

.simple-input-group label {
    display: block;
    font-size: 13px;
    color: #8D6E63; /* æ£•è‰²æ–‡å­— */
    margin-bottom: 8px;
    font-weight: 600;
}

.simple-input-group input,
.simple-input-group textarea {
    width: 100%;
    padding: 10px;
    border: 2px solid #FFE4E9;
    border-radius: 10px;
    font-size: 14px;
    color: #5D4037;
    background: white;
    font-family: inherit;
    transition: border-color 0.2s;
}

.simple-input-group input:focus,
.simple-input-group textarea:focus {
    outline: none;
    border-color: #FF9AAD;
}

.simple-edit-footer {
    padding: 16px 20px;
    display: flex;
    gap: 12px;
    background: white;
    border-top: 1px solid #FFE4E9;
}

.simple-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.simple-btn.cancel {
    background: #F5F5F5;
    color: #999;
}

.simple-btn.save {
    background: linear-gradient(135deg, #FFB6C1, #FF9AAD);
    color: white;
    box-shadow: 0 4px 10px rgba(255, 182, 193, 0.4);
}

.simple-btn.save:active {
    transform: scale(0.95);
}

/* ========== HTMLæ¸²æŸ“æ°”æ³¡æ ·å¼ - å¼€å§‹ ========== */

/* style.css (ä¿®æ­£åçš„ä»£ç ) */

/* 1. æ¸²æŸ“æ°”æ³¡å®¹å™¨ï¼šç§»é™¤å›ºå®šé«˜åº¦ï¼Œæ”¹ä¸º auto */
.render-bubble {
    padding: 0;
    overflow: hidden;
    background: #fff;
    width: 300px;
    height: auto !important; /* ä¿æŒè‡ªé€‚åº” */
    min-height: 100px;

    /* ğŸ”¥ å…³é”®ä¿®å¤ï¼šè®¾ç½®æœ€å¤§é«˜åº¦ï¼Œé˜²æ­¢æ— é™å¢é•¿ */
    max-height: 500px;
    overflow-y: auto; /* å†…å®¹è¿‡é•¿æ—¶æ˜¾ç¤ºæ»šåŠ¨æ¡ */

    display: flex;
    flex-direction: column;
    transition: height 0.2s ease;
}


/* 2. iframe æ ·å¼ï¼šç¡®ä¿å®ƒæ˜¯å—çº§å…ƒç´  */
.render-iframe {
    width: 100%;
    /* height: 100%;  <-- åˆ é™¤è¿™ä¸ªï¼Œç”± JS åŠ¨æ€æ§åˆ¶å†…è”æ ·å¼ */
    border: none;
    display: block;
    overflow: hidden; /* éšè— iframe å†…éƒ¨æ»šåŠ¨æ¡ */
}

/* 3. åœ¨å¯†å‹èŠå¤©ç•Œé¢ï¼Œç»™æ¸²æŸ“æ°”æ³¡ä¸€ä¸ªå¯çˆ±çš„è¾¹æ¡† */
.sweetheart-chat-page .render-bubble {
    border: 2px solid #FFC0D9;
    box-shadow: 0 4px 12px rgba(255, 182, 193, 0.3);
}

/* ========== é’ˆå¯¹ iframe æ¶ˆæ¯çš„äº‹ä»¶æ•è·è¦†ç›–å±‚ ========== */
.iframe-event-capture-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10; /* ç¡®ä¿åœ¨ iframe ä¸Šæ–¹ */
    cursor: pointer; /* é¼ æ ‡æ ·å¼ï¼Œæç¤ºå¯äº¤äº’ */
    background: transparent; /* å®Œå…¨é€æ˜ */
    pointer-events: auto; /* å…³é”®ï¼šå§‹ç»ˆæ•è·äº‹ä»¶ */
}


/* ========== HTMLæ¸²æŸ“æ°”æ³¡æ ·å¼ - ç»“æŸ ========== */
/* ========== è”ç³»äººåº“é¡µé¢æ ·å¼ (æœ€ç»ˆç‰ˆ) ========== */
.contact-library-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #f0f2f5; /* æ›´ç®€æ´çš„èƒŒæ™¯è‰² */
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1004; /* æ¯”è®¾ç½®é¡µé«˜ä¸€çº§ */
    display: flex;
    flex-direction: column;
}

.contact-library-page.show {
    transform: translateX(0);
}

.contact-library-page .settings-header {
    background: #fff;
}

.contact-library-content {
    flex: 1;
    overflow-y: auto;
}

.contact-library-content::-webkit-scrollbar {
    display: none;
}

.contact-library-search-wrapper {
    padding: 12px 20px;
    background: #f0f2f5;
    position: sticky;
    top: 0;
    z-index: 5;
}

.contact-library-search {
    width: 100%;
    padding: 12px 18px;
    border: none;
    border-radius: 22px;
    background: #fff;
    font-size: 14px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.contact-library-search:focus {
    outline: none;
    box-shadow: 0 0 0 2px #cce4ff;
}

#contactLibraryList {
    padding: 0 0 20px;
}

.contact-library-section-title {
    padding: 16px 20px 8px;
    font-size: 13px;
    font-weight: 600;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.contact-library-item {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    background: white;
    cursor: pointer;
    transition: background 0.2s;
    border-bottom: 1px solid #f0f2f5;
}

.contact-library-item:active {
    background: #f8f9fa;
}

.contact-library-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    margin-right: 14px;
    flex-shrink: 0;
    overflow: hidden;
    background: #e9ecef;
}

.contact-library-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.contact-library-info {
    flex: 1;
    min-width: 0;
}

.contact-library-name {
    font-size: 16px;
    font-weight: 600;
    color: #333;
}

.contact-library-type {
    font-size: 12px;
    color: #888;
}

.contact-library-type.sweetheart {
    color: #ff6384;
}

.contact-library-item .settings-arrow {
    font-size: 16px;
    color: #ccc;
    font-weight: bold;
}

/* ========== å·¦æ»‘åˆ é™¤åŠŸèƒ½ CSS (ä¿®æ­£ç‰ˆ) å¼€å§‹ ========== */

/* 1. æ»‘åŠ¨é¡¹çš„é€šç”¨å¤–å±‚åŒ…è£¹å®¹å™¨ */
.contact-item-wrapper,
.sweetheart-item-wrapper {
    position: relative;
    overflow: hidden;
    background-color: #ff3b30; /* iOSé£æ ¼çš„çº¢è‰²åˆ é™¤èƒŒæ™¯ */
    transition: all 0.2s ease-out; /* ç”¨äºåˆ é™¤æ—¶çš„åŠ¨ç”» */
}

/* ä¸ºæ™®é€šè”ç³»äººåˆ—è¡¨é¡¹è®¾ç½®è¾¹è·å’Œåœ†è§’ */
.contact-item-wrapper {
    margin: 0; /* æ™®é€šè”ç³»äººåˆ—è¡¨é¡¹ä¹‹é—´ç”±borderåˆ†éš”ï¼Œä¸éœ€è¦å¤–è¾¹è· */
}

/* ä¸ºå¯†å‹åˆ—è¡¨é¡¹è®¾ç½®è¾¹è·å’Œåœ†è§’ */
.sweetheart-item-wrapper {
    margin: 0 12px 10px;
    border-radius: 16px;
}

/* 2. å¯æ»‘åŠ¨çš„å†…å®¹å±‚ */
.contact-item-content,
.sweetheart-item-content {
    position: relative;
    z-index: 2;
    background: white; /* æ ¸å¿ƒä¿®æ­£ï¼šç¡®ä¿å†…å®¹å±‚æœ‰åšå®çš„ä¸é€æ˜èƒŒæ™¯ */
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

/* æ™®é€šè”ç³»äººå†…å®¹å±‚çš„æ ·å¼ */
.contact-item-content {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    cursor: pointer;
    border-bottom: 1px solid #f0f2f5;
}

/* å¯†å‹å†…å®¹å±‚çš„æ ·å¼ */
.sweetheart-item-content {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 20px;
    cursor: pointer;
    border-radius: 16px;
}

/* 3. åº•å±‚çš„æ“ä½œå±‚ (æ”¾ç½®åˆ é™¤æŒ‰é’®) */
.swipe-actions {
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
    display: flex;
    align-items: center;
    z-index: 1;
}

/* 4. åˆ é™¤æŒ‰é’®æœ¬èº« */
.swipe-delete-btn {
    width: 80px;
    height: 100%;
    border: none;
    background: transparent;
    color: white;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* 5. å½“ JS æ·»åŠ  is-swiped ç±»æ—¶ï¼Œå†…å®¹å±‚å‘å·¦æ»‘åŠ¨ */
.is-swiped .contact-item-content,
.is-swiped .sweetheart-item-content {
    transform: translateX(-80px);
}

/* ========== å·¦æ»‘åˆ é™¤åŠŸèƒ½ CSS ç»“æŸ ========== */
/* ========== è”ç³»äººå®ä¾‹IDæ˜¾ç¤ºæ ·å¼ ========== */

/* æ™®é€šè§’è‰²å¡IDåŒºåŸŸ */
.character-id-section {
    background: #f8f9fa;
    padding: 12px 16px;
    border-radius: 12px;
    margin: 16px 0;
    border: 2px dashed #e0e0e0;
}

.id-label {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 6px;
}

.id-icon {
    font-size: 14px;
}

.id-text {
    font-size: 12px;
    font-weight: 600;
    color: #666;
}

.id-value {
    font-family: 'Courier New', 'Monaco', monospace;
    font-size: 11px;
    color: #333;
    background: white;
    padding: 6px 10px;
    border-radius: 6px;
    word-break: break-all;
    border: 1px solid #e0e0e0;
}

/* å¯†å‹è§’è‰²å¡IDåŒºåŸŸ */
.sweetheart-id-section {
    background: #FFF5F5;
    padding: 12px 16px;
    border-radius: 12px;
    margin-bottom: 16px;
    border: 2px dashed #FFD1DC;
}

.sweetheart-id-label {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 6px;
    font-size: 14px;
    font-weight: 600;
    color: #8D6E63;
}

.sweetheart-id-value {
    font-family: 'Courier New', 'Monaco', monospace;
    font-size: 11px;
    color: #8D6E63;
    background: white;
    padding: 6px 10px;
    border-radius: 6px;
    word-break: break-all;
    border: 1px solid #FFD1DC;
}

/* è”ç³»äººåˆ—è¡¨é¡¹ä¸­æ˜¾ç¤ºIDçš„æ ·å¼ */
.contact-instance-id,
.sweetheart-instance-id {
    font-size: 10px;
    color: #999;
    font-family: 'Courier New', monospace;
    margin-top: 2px;
}

/* style.css */

/* ========== è”ç³»äººåº“å¤šé€‰åŠŸèƒ½æ ·å¼ (å·²ä¿®å¤ç‚¹å‡»é—®é¢˜) ========== */

/* 1. å³ä¸Šè§’æŒ‰é’®å®¹å™¨ (ä¸å˜) */
.contact-lib-actions {
    display: flex;
    align-items: center;
}

/* 2. å¤šé€‰åˆ‡æ¢æŒ‰é’® (ä¸å˜) */
.multi-select-toggle {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    background: rgba(168, 201, 245, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.2s;
}

.multi-select-toggle:active {
    transform: scale(0.9);
    background: rgba(168, 201, 245, 0.25);
}

/* 3. å¤šé€‰å·¥å…·æ  (ä¸å˜) */
.multi-select-toolbar {
    display: flex;
    gap: 6px;
    align-items: center;
}

/* ... å…¶ä»– toolbar-btn æ ·å¼ä¿æŒä¸å˜ ... */
.toolbar-btn {
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
}

.delete-btn {
    background: #FFE8E8;
    color: #FF5252;
}

.clone-btn {
    background: #E3F2FD;
    color: #2196F3;
}

.done-btn {
    background: linear-gradient(135deg, #66BB6A, #43A047);
    color: white;
}


/* 4. ğŸ”¥ã€æ ¸å¿ƒä¿®å¤ã€‘å¤šé€‰æ¨¡å¼ä¸‹çš„è”ç³»äººé¡¹æ ·å¼ */
.contact-library-item.multi-select-mode {
    position: relative; /* ä¿æŒç›¸å¯¹å®šä½ç”¨äºä¼ªå…ƒç´  */
    cursor: pointer; /* ç¡®ä¿æ•´ä¸ªé¡¹ç›®éƒ½æ˜¯å¯ç‚¹å‡»çš„ */
    /* ç§»é™¤ä¹‹å‰çš„ padding-left */
}

/* ğŸ”¥ã€æ ¸å¿ƒä¿®å¤ã€‘å°†å¤´åƒå’Œä¿¡æ¯å‘å³ç§»åŠ¨ï¼Œä¸ºå¤é€‰æ¡†è…¾å‡ºç©ºé—´ */
.contact-library-item.multi-select-mode .contact-library-avatar {
    margin-left: 36px; /* åŸæ¥æ˜¯ 14pxï¼Œå¢åŠ  22px ç©ºé—´ */
}

/* å¤é€‰æ¡†çš„ä¼ªå…ƒç´  */
.contact-library-item.multi-select-mode::before {
    content: '';
    position: absolute;
    left: 20px;
    top: 50%;
    transform: translateY(-50%);
    width: 22px;
    height: 22px;
    border: 2px solid #ccc;
    border-radius: 6px;
    background: white;
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    z-index: 5; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
    pointer-events: none; /* å…³é”®ï¼šè®©ä¼ªå…ƒç´ ä¸æ•è·é¼ æ ‡äº‹ä»¶ */
}

/* é€‰ä¸­çŠ¶æ€çš„å¤é€‰æ¡† */
.contact-library-item.multi-select-mode.selected::before {
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-color: #667eea;
    transform: translateY(-50%) scale(1.1); /* å¢åŠ ä¸€ä¸ªè½»å¾®çš„æ”¾å¤§åŠ¨ç”» */
}

/* å¤é€‰æ¡†å†…çš„ "âœ“" ç¬¦å· */
.contact-library-item.multi-select-mode.selected::after {
    content: 'âœ“';
    position: absolute;
    left: 24.5px;
    top: 50%;
    transform: translateY(-50%);
    color: white;
    font-size: 15px;
    font-weight: bold;
    z-index: 6; /* æ¯”å¤é€‰æ¡†æ›´é«˜ä¸€å±‚ */
    pointer-events: none; /* å…³é”®ï¼šåŒæ ·ä¸æ•è·é¼ æ ‡äº‹ä»¶ */
}

/* 5. é€‰ä¸­çŠ¶æ€é«˜äº® (ä¸å˜) */
.contact-library-item.selected {
    background: #F0F4FF;
}

/* ========== è”ç³»äººåº“ç»Ÿä¸€è§’è‰²å¡æ ·å¼ ========== */
.library-character-modal {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1015; /* é«˜äºè”ç³»äººåº“é¡µé¢ (1004) */
    display: none;
}

.library-character-modal.show {
    display: block;
}

.library-modal-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
}

.library-character-card {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    max-width: 340px;
    max-height: 85vh;
    background: white;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    animation: libraryModalSlideIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes libraryModalSlideIn {
    from {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
}

.library-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    border-bottom: 2px solid #f0f2f5;
}

.library-card-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
    margin: 0;
}

.library-close-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #f0f2f5;
    border: none;
    color: #666;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.library-close-btn:hover {
    background: #e0e4e8;
    transform: rotate(90deg);
}

.library-card-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

.library-card-content::-webkit-scrollbar {
    width: 6px;
}

.library-card-content::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
}

.library-section {
    margin-bottom: 20px;
}

.library-avatar-row {
    display: flex;
    gap: 16px;
    align-items: flex-start;
}

.library-avatar {
    width: 80px;
    height: 80px;
    border-radius: 12px;
    overflow: hidden;
    cursor: pointer;
    position: relative;
    flex-shrink: 0;
    background: #f0f2f5;
}

.library-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.library-avatar-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    text-align: center;
    padding: 4px;
    font-size: 14px;
    opacity: 0;
    transition: opacity 0.2s;
}

.library-avatar:hover .library-avatar-overlay {
    opacity: 1;
}

.library-basic-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.library-id-display {
    font-size: 11px;
    color: #999;
    font-family: 'Courier New', monospace;
    background: #f8f9fa;
    padding: 6px 10px;
    border-radius: 6px;
}

.library-id-label {
    font-weight: 600;
}

.library-label {
    display: block;
    font-size: 14px;
    font-weight: 600;
    color: #333;
    margin-bottom: 8px;
}

.library-label-sm {
    display: block;
    font-size: 13px;
    font-weight: 600;
    color: #555;
    margin-bottom: 6px;
}

.library-input,
.library-textarea {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid #e0e4e8;
    border-radius: 8px;
    font-size: 14px;
    font-family: inherit;
    transition: border-color 0.2s;
}

.library-input:focus,
.library-textarea:focus {
    outline: none;
    border-color: #667eea;
}

.library-textarea {
    resize: vertical;
}

.library-toggle-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 8px;
    transition: background 0.2s;
    user-select: none;
}

.library-toggle-header:hover {
    background: #e9ecef;
}

.library-toggle-arrow {
    font-size: 12px;
    color: #999;
    transition: transform 0.3s;
}

.library-toggle-arrow.open {
    transform: rotate(180deg);
}

.library-extended-fields,
.library-worldbooks-list {
    margin-top: 12px;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
}

.library-field {
    margin-bottom: 12px;
}

.library-field:last-child {
    margin-bottom: 0;
}

.library-worldbooks-list {
    max-height: 200px;
    overflow-y: auto;
}

.library-wb-item {
    display: flex;
    align-items: center;
    padding: 8px;
    cursor: pointer;
    border-radius: 6px;
    transition: background 0.2s;
}

.library-wb-item:hover {
    background: white;
}

.library-wb-item input[type="checkbox"] {
    margin-right: 10px;
    cursor: pointer;
    accent-color: #667eea;
}

.library-wb-item label {
    flex: 1;
    cursor: pointer;
    font-size: 14px;
    color: #333;
}

.library-card-footer {
    display: flex;
    gap: 12px;
    padding: 16px 20px;
    border-top: 2px solid #f0f2f5;
}

.library-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.library-btn-cancel {
    background: #f0f2f5;
    color: #666;
}

.library-btn-cancel:hover {
    background: #e0e4e8;
}

.library-btn-save {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.library-btn-save:hover {
    transform: scale(1.02);
}

/*
====================================
å¯†å‹èŠå¤© - ä¸–ç•Œåœ°å›¾å¼¹çª—æ ·å¼
====================================
*/

.world-map-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(161, 136, 127, 0.5); /* ä½¿ç”¨ä¸»é¢˜æ£•è‰²ä½œä¸ºèƒŒæ™¯ */
    backdrop-filter: blur(5px);
}

.world-map-modal {
    position: relative;
    z-index: 1;
    width: 95%;
    max-width: 360px;
    background: linear-gradient(180deg, #FFF5F5 0%, #FFE8E8 100%);
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(255, 182, 193, 0.3);
    overflow: hidden;
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

#worldMapPopup.show .world-map-modal {
    transform: scale(1);
}

.world-map-header {
    padding: 16px;
    text-align: center;
    border-bottom: 2px dashed #FFD1DC;
    position: relative;
}

.world-map-title {
    font-size: 16px;
    font-weight: 700;
    color: #8D6E63;
    margin: 0;
}

.world-map-close {
    position: absolute;
    top: 50%;
    right: 16px;
    transform: translateY(-50%);
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #FFF0F5;
    color: #D4A5A5;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 18px;
    transition: all 0.2s;
}

.world-map-close:hover {
    transform: translateY(-50%) rotate(90deg);
}

.world-map-content {
    padding: 16px;
}

.map-popup-container {
    position: relative;
    width: 100%;
    background: #fdfdfd;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border: 2px solid #FFD1DC;
}

#mapPopupImage {
    width: 100%;
    height: auto;
    display: block;
}

.map-popup-hint {
    margin-top: 12px;
    text-align: center;
    font-size: 12px;
    color: #BCAAA4;
    font-style: italic;
}

/* åœ°å›¾ä¸Šçš„å¤§å¤´é’ˆæ ·å¼ */
.map-popup-pin {
    position: absolute;
    transform: translate(-50%, -50%);
    cursor: pointer;
    transition: transform 0.2s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.map-popup-pin:hover {
    transform: translate(-50%, -50%) scale(1.2);
    z-index: 10;
}

.map-popup-pin-icon {
    font-size: 28px;
    filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.3));
}

.map-popup-pin-label {
    background: rgba(255, 255, 255, 0.9);
    padding: 3px 8px;
    border-radius: 8px;
    font-size: 11px;
    font-weight: 600;
    color: #8D6E63;
    white-space: nowrap;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    margin-top: 4px;
}

/* ========== HTMLæ¸²æŸ“æ°”æ³¡æ ·å¼ - å¼€å§‹ ========== */

/* 1. æ¸²æŸ“æ°”æ³¡å®¹å™¨ï¼šå…è®¸å†…éƒ¨æ»šåŠ¨ */
.render-bubble {
    padding: 0;
    background: #fff;
    width: 300px; /* é»˜è®¤å®½åº¦ */

    /* ğŸ”¥ æ ¸å¿ƒä¿®æ”¹ 1: å…è®¸å‚ç›´æ»šåŠ¨ï¼Œéšè—æ°´å¹³æ»šåŠ¨ */
    overflow-y: auto !important;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch; /* iOS æƒ¯æ€§æ»šåŠ¨æ”¯æŒ */

    /* ä¿æŒè‡ªé€‚åº”é«˜åº¦é€»è¾‘ */
    height: auto !important;
    min-height: 100px;

    /* ğŸ”¥ æ ¸å¿ƒä¿®æ”¹ 2: ä¸¥æ ¼é™åˆ¶æœ€å¤§é«˜åº¦ï¼Œè¶…è¿‡è¿™ä¸ªé«˜åº¦å°±å‡ºç°æ»šåŠ¨æ¡ */
    max-height: 70vh; /* ä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è¿™ä¸ªå€¼ï¼Œæ¯”å¦‚ 60vh */

    display: flex;
    flex-direction: column;
    transition: height 0.2s ease;

    /* ç¡®ä¿æ°”æ³¡æœ¬èº«èƒ½æ¥æ”¶æ»šåŠ¨äº‹ä»¶ */
    pointer-events: auto;
}


/* 2. iframe æ ·å¼ */
.render-iframe {
    width: 100%;
    /* é«˜åº¦ç”±å†…å®¹æ’‘å¼€ï¼Œæˆ–è€…å¡«æ»¡çˆ¶å®¹å™¨ */
    min-height: 100px;
    border: none;
    display: block;
}

/* 3. åœ¨å¯†å‹èŠå¤©ç•Œé¢ï¼Œç»™æ¸²æŸ“æ°”æ³¡ä¸€ä¸ªå¯çˆ±çš„è¾¹æ¡† */
.sweetheart-chat-page .render-bubble {
    border: 2px solid #FFC0D9;
    box-shadow: 0 4px 12px rgba(255, 182, 193, 0.3);
}

/* ========== HTMLæ¸²æŸ“æ°”æ³¡æ ·å¼ - ç»“æŸ ========== */

/* ========== iframe æ¶ˆæ¯æ°”æ³¡çš„äº‹ä»¶æ•è·é®ç½© (ä¿®æ”¹ç‰ˆ) ========== */
.iframe-event-capture-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;

    /* ğŸ”¥ æ ¸å¿ƒä¿®æ”¹ 3: å¿…é¡»è®¾ä¸º noneï¼
       è¿™æ ·æ‰‹æŒ‡/é¼ æ ‡æ‰èƒ½ç©¿é€è¿™å±‚é®ç½©ï¼Œç›´æ¥è§¦æ‘¸åˆ°ä¸‹é¢çš„ iframe è¿›è¡Œæ»‘åŠ¨æˆ–ç‚¹å‡»æŒ‰é’®ã€‚
       ä¹‹å‰çš„ auto ä¼šåƒç»ç’ƒä¸€æ ·æŒ¡ä½æ“ä½œã€‚
    */
    pointer-events: none !important;

    background: transparent;
}
/* (å¯é€‰) å¦‚æœä½ å¸Œæœ›é•¿æŒ‰æ°”æ³¡è¾¹ç¼˜è¿˜èƒ½è§¦å‘èœå•ï¼Œä¿ç•™è¿™ä¸ªï¼Œä½†ä¸­é—´å†…å®¹åŒºåŸŸå¿…é¡»èƒ½äº¤äº’ */
.chat-bubble.render-bubble {
    position: relative;
    /* ç¡®ä¿æ°”æ³¡æœ¬èº«å¯ä»¥è¢«ç‚¹å‡» */
    pointer-events: auto;
}

/* ğŸ¯ åªåœ¨éœ€è¦æ—¶æ¿€æ´»äº‹ä»¶æ•è·ï¼ˆä¾‹å¦‚é•¿æŒ‰æ—¶ï¼‰ */
/* è¿™æ˜¯ä¸ºäº†ç¡®ä¿åœ¨é•¿æŒ‰æ£€æµ‹è¿‡ç¨‹ä¸­ï¼Œiframe å†…éƒ¨çš„å…ƒç´ ä¸ä¼šåå™¬äº‹ä»¶ */
.render-bubble .iframe-event-overlay {
    pointer-events: none; /* é»˜è®¤å…³é—­ */
}

/* ğŸ¯ åªåœ¨éœ€è¦æ—¶æ¿€æ´»äº‹ä»¶æ•è·ï¼ˆä¾‹å¦‚é•¿æŒ‰æ—¶ï¼‰ */
.chat-bubble.render-bubble:active .iframe-event-overlay,
.chat-bubble.render-bubble.selecting .iframe-event-overlay {
    pointer-events: auto;
}

/* ========== æ¶ˆæ¯å¤šé€‰åŠŸèƒ½æ ·å¼ ========== */

/* å¤šé€‰å·¥å…·æ  */
.multi-select-toolbar {
    display: flex;
    align-items: center;
    gap: 12px;
}

.toolbar-btn {
    padding: 6px 14px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.toolbar-btn.delete-btn {
    background: #ff3b30;
    color: white;
}

.toolbar-btn.delete-btn:active {
    background: #d32f2f;
    transform: scale(0.95);
}

.toolbar-btn.done-btn {
    background: #0A84FF;
    color: white;
}

.toolbar-btn.done-btn:active {
    background: #0066CC;
    transform: scale(0.95);
}

/* æ¶ˆæ¯è¡Œçš„å¤šé€‰æ¨¡å¼ */
.message-row.multi-select-mode {
    padding-left: 40px;
    position: relative;
}

/* å¤é€‰æ¡†å®¹å™¨ */
.message-checkbox-container {
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
}

/* è‡ªå®šä¹‰å¤é€‰æ¡†æ ·å¼ */
.message-checkbox {
    width: 22px;
    height: 22px;
    border: 2px solid #ddd;
    border-radius: 50%;
    background: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.message-checkbox.checked {
    background: #0A84FF;
    border-color: #0A84FF;
}

.message-checkbox.checked::after {
    content: 'âœ“';
    color: white;
    font-size: 14px;
    font-weight: bold;
}

/* å¯†å‹èŠå¤©çš„å¤é€‰æ¡†æ ·å¼ */
.sweetheart-chat-page .message-checkbox.checked {
    background: #FFB6C1;
    border-color: #FFB6C1;
}

/* 2. ä¿®å¤å¤šé€‰å¤±è´¥ï¼šåœ¨å¤šé€‰æ¨¡å¼ä¸‹ï¼Œç¦æ­¢å†…å®¹åŒºæ•è·ç‚¹å‡»äº‹ä»¶ */
/* å½“æ¶ˆæ¯è¡Œå¤„äº multi-select-mode æ—¶ï¼Œå®ƒçš„å†…å®¹å­å…ƒç´ ä¸å†å“åº”é¼ æ ‡ï¼Œ
   è¿™æ ·ç‚¹å‡»å°±ä¼šå†’æ³¡åˆ° .message-rowï¼Œä»è€Œè§¦å‘ toggleMessageSelection */
.message-row.multi-select-mode .message-content {
    pointer-events: none !important;
}

/* ä½†è¦ä¿ç•™å¤é€‰æ¡†çš„ç‚¹å‡»èƒ½åŠ› (è™½ç„¶ä¸Šé¢pointer-events:noneé€šå¸¸åªå½±å“åä»£ï¼Œ
   ä½†ä¸ºäº†ä¿é™©èµ·è§ï¼Œå¦‚æœå¤é€‰æ¡†åœ¨message-contentå†…çš„è¯è¦æ’é™¤ï¼Œ
   ä¸è¿‡ä½ çš„å¤é€‰æ¡†æ˜¯åœ¨ row é‡Œçš„ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç åº”è¯¥è¶³å¤Ÿã€‚
   ä¸ºäº†åŒé‡ä¿é™©ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾å¼æŒ‡å®š) */
.message-row.multi-select-mode .message-checkbox-container {
    pointer-events: auto !important;
}

/* ========== é¢å…·ç®¡ç†åŠŸèƒ½æ ·å¼ - å¼€å§‹ ========== */

/* é¢å…·ç®¡ç†é¡µé¢ */
.mask-library-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1002;
    display: flex;
    flex-direction: column;
}

.mask-library-page.show {
    transform: translateX(0);
}

/* é¢å…·åˆ—è¡¨ */
#maskLibraryList {
    padding: 0 20px 20px;
}

.mask-item {
    background: white;
    padding: 16px;
    margin-bottom: 12px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    cursor: pointer;
    transition: all 0.2s;
}

.mask-item:active {
    transform: scale(0.98);
    background: #f8f9fa;
}

.mask-item-header {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
}

.mask-item-icon {
    font-size: 24px;
    margin-right: 12px;
}

.mask-item-title {
    flex: 1;
    font-size: 16px;
    font-weight: 600;
    color: #333;
}

.mask-item-desc {
    font-size: 13px;
    color: #888;
    margin-bottom: 8px;
}

.mask-item-preview {
    font-size: 12px;
    color: #999;
    line-height: 1.4;
}

/* ç©ºçŠ¶æ€ */
.mask-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 60px 20px;
}

.mask-empty-icon {
    font-size: 64px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.mask-empty-text {
    font-size: 16px;
    font-weight: 600;
    color: #666;
    margin-bottom: 8px;
}

.mask-empty-hint {
    font-size: 13px;
    color: #999;
    text-align: center;
}

/* é¢å…·ç¼–è¾‘å¼¹çª— */
.mask-modal-card {
    background: white;
    border-radius: 20px;
    width: 100%;
    max-width: 360px;
    max-height: 80vh;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

.mask-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px;
    border-bottom: 1px solid #eee;
}

.mask-modal-header .header-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
}

.modal-close-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #f0f0f0;
    border: none;
    color: #666;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.modal-close-btn:hover {
    background: #e0e0e0;
    transform: rotate(90deg);
}

.mask-modal-content {
    padding: 20px;
    max-height: 50vh;
    overflow-y: auto;
}

.mask-modal-content::-webkit-scrollbar {
    width: 6px;
}

.mask-modal-content::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
}

.mask-field {
    margin-bottom: 20px;
}

.mask-field.required-field .mask-label {
    font-weight: 600;
}

.mask-label {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
    font-size: 14px;
    color: #555;
}

.label-icon {
    font-size: 16px;
}

.required-star {
    color: #ff3b30;
    font-weight: bold;
}

.mask-input {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.2s;
}

.mask-input:focus {
    outline: none;
    border-color: #667eea;
}

.mask-textarea {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    resize: vertical;
    transition: border-color 0.2s;
}

.mask-textarea:focus {
    outline: none;
    border-color: #667eea;
}

.mask-modal-footer {
    display: flex;
    gap: 8px;
    padding: 16px 20px;
    border-top: 1px solid #eee;
}

.mask-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.mask-btn-cancel {
    background: #f0f0f0;
    color: #666;
}

.mask-btn-cancel:hover {
    background: #e0e0e0;
}

.mask-btn-delete {
    background: #ff3b30;
    color: white;
}

.mask-btn-delete:hover {
    background: #e02020;
}

.mask-btn-save {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.mask-btn-save:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

/* é¢å…·é€‰æ‹©åˆ—è¡¨æ ·å¼ï¼ˆç”¨äºè§’è‰²å¡ä¸­ï¼‰ */
.sweetheart-masks-list,
.library-masks-list,
.char-wb-list {
    margin-top: 8px;
    padding: 8px;
    background: #fdfdfd;
    border: 2px solid #eee;
    border-radius: 10px;
    max-height: 150px;
    overflow-y: auto;
}

.mask-checkbox-item {
    display: flex;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid #f0f0f0;
    cursor: pointer;
}

.mask-checkbox-item:last-child {
    border-bottom: none;
}

.mask-checkbox-item input[type="checkbox"] {
    margin-right: 10px;
    cursor: pointer;
    accent-color: #667eea;
}

.mask-checkbox-item label {
    flex: 1;
    cursor: pointer;
    font-size: 14px;
    color: #555;
}

/* ========== é¢å…·ç®¡ç†åŠŸèƒ½æ ·å¼ - ç»“æŸ ========== */
/* ========== çº¿ä¸Š/çº¿ä¸‹æ¨¡å¼åˆ‡æ¢æŒ‰é’®æ ·å¼ ========== */
.mode-toggle-btn {
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    cursor: pointer;
    border-radius: 50%;
    background: linear-gradient(135deg, #FFB6C1, #FFC0D9);
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(255, 182, 193, 0.3);
    margin-right: 100px;
}

.mode-toggle-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(255, 182, 193, 0.5);
}

.mode-toggle-btn:active {
    transform: scale(0.95);
}


/* ========== åœ°ç‚¹æç¤ºå¡ç‰‡æ ·å¼ï¼ˆæŒä¹…åŒ–ç‰ˆæœ¬ï¼‰========== */
.location-notice {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin: 16px auto;
    padding: 16px;
    max-width: 85%;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 16px;
    border: 2px solid #FFD1DC;
    box-shadow: 0 4px 12px rgba(161, 136, 127, 0.15);
    /* âœ… æ–°å¢ï¼šç¡®ä¿åœ¨èŠå¤©å†å²ä¸­æ­£ç¡®æ˜¾ç¤º */
    position: relative;
}

.location-notice-icon {
    font-size: 32px;
    flex-shrink: 0;
}

.location-notice-text {
    flex: 1;
}

.location-notice-text strong {
    display: block;
    font-size: 16px;
    color: #8D6E63;
    margin-bottom: 6px;
}

.location-notice-text p {
    font-size: 14px;
    color: #BCAAA4;
    margin: 0;
    line-height: 1.4;
}

/* ========== AIè®°å¿†è½®æ•°è®¾ç½®æ ·å¼ ========== */
.number-stepper {
    display: flex;
    align-items: center;
    gap: 8px;
}

.stepper-btn {
    width: 32px;
    height: 32px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    background: white;
    font-size: 18px;
    font-weight: bold;
    color: #667eea;
    cursor: pointer;
    transition: all 0.2s;
}

.stepper-btn:hover {
    background: #f0f4ff;
    border-color: #667eea;
}

.stepper-btn:active {
    transform: scale(0.95);
}

.stepper-input {
    width: 50px;
    height: 32px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    text-align: center;
    font-size: 14px;
    font-weight: 600;
}

.stepper-input:focus {
    outline: none;
    border-color: #667eea;
}

/* ========== è®°å¿†å­˜å‚¨ä¸­å¿ƒæ ·å¼ ========== */
.memory-center-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
    transform: translateX(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    z-index: 1001;
    display: flex;
    flex-direction: column;
}

.memory-center-page.show {
    transform: translateX(0);
}

/* Tabåˆ‡æ¢ */
.memory-tab-container {
    display: flex;
    background: white;
    border-radius: 12px;
    margin: 12px 20px;
    padding: 4px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.memory-tab {
    flex: 1;
    padding: 10px;
    text-align: center;
    font-size: 14px;
    font-weight: 600;
    color: #666;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
}

.memory-tab.active {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
}

/* å†…å®¹åŒºåŸŸ */
.memory-content-area {
    flex: 1;
    overflow-y: auto;
}

/* çŸ¥è¯†ç‚¹å¡ç‰‡ */
.knowledge-card {
    background: white;
    margin: 0 20px 16px;
    padding: 16px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.knowledge-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid #f0f0f0;
}

.knowledge-card-title {
    flex: 1;
    font-size: 15px;
    font-weight: 600;
    color: #333;
}

.knowledge-card-meta {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 4px;
}

.knowledge-card-date {
    font-size: 11px;
    color: #999;
}

.knowledge-card-badge {
    background: #667eea;
    color: white;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 600;
}

.knowledge-card-content {
    font-size: 13px;
    line-height: 1.6;
    color: #555;
    white-space: pre-wrap;
    max-height: 200px;
    overflow-y: auto;
}

.knowledge-card-footer {
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.knowledge-card-source {
    font-size: 12px;
    color: #888;
}

.knowledge-card-actions {
    display: flex;
    gap: 8px;
}

.knowledge-action-btn {
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.delete-knowledge-btn {
    background: #ffebee;
    color: #f44336;
}

.delete-knowledge-btn:hover {
    background: #ffcdd2;
}

/* ç©ºçŠ¶æ€ */
.memory-empty {
    text-align: center;
    padding: 60px 20px;
}

.memory-empty-icon {
    font-size: 64px;
    margin-bottom: 16px;
}

.memory-empty-text {
    font-size: 16px;
    font-weight: 600;
    color: #666;
    margin-bottom: 8px;
}

.memory-empty-hint {
    font-size: 13px;
    color: #999;
    line-height: 1.5;
}

#newWorldModal {
    z-index: 2001; /* ç¡®ä¿è¿™ä¸ªå€¼é«˜äº #worldSelectPage çš„ 2000 */
}

/*
====================================
çŠ¶æ€å¼¹çª— - å³ä¸Šè§’ç¼–è¾‘æŒ‰é’®æ ·å¼
====================================
*/

/* 2. ç¼–è¾‘æŒ‰é’®å®¹å™¨ */
.status-popup-edit {
    position: absolute; /* ç»å¯¹å®šä½ */
    top: 50%; /* å‚ç›´å±…ä¸­ */
    transform: translateY(-50%); /* ç²¾ç¡®å‚ç›´å±…ä¸­ */
    right: 58px; /* å…³é”®ï¼šå®šä½åœ¨å…³é—­æŒ‰é’®çš„å·¦è¾¹ (28pxçš„å…³é—­æŒ‰é’®å®½åº¦ + 28pxçš„è‡ªèº«å®½åº¦) */
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #FFF0F5; /* ä½¿ç”¨ä¸»é¢˜è‰² */
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

/* 3. æ‚¬åœæ•ˆæœ */
.status-popup-edit:hover {
    background: #FFE4E9;
    transform: translateY(-50%) scale(1.1); /* å¢åŠ ä¸€ä¸ªè½»å¾®çš„æ”¾å¤§æ•ˆæœ */
}

/* 4. SVGå›¾æ ‡æ ·å¼ */
.status-popup-edit svg {
    width: 18px;
    height: 18px;
    fill: #D4A5A5; /* ä½¿ç”¨ä¸»é¢˜è‰² */
}

/*
====================================
çŠ¶æ€å¼¹çª— - å°±åœ°ç¼–è¾‘æ¨¡å¼æ ·å¼
====================================
*/

/* 1. é»˜è®¤çŠ¶æ€ä¸‹çš„æ ·å¼ */
.status-popup-modal .status-input,
.status-popup-modal .status-popup-save,
.status-popup-modal .header-title-editing {
    display: none; /* é»˜è®¤éšè—æ‰€æœ‰è¾“å…¥æ¡†ã€ä¿å­˜æŒ‰é’®å’Œç¼–è¾‘æ ‡é¢˜ */
}

/* 2. ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ ·å¼ (å½“ .is-editing ç±»è¢«æ·»åŠ åˆ°å¼¹çª—ä¸Šæ—¶) */
.status-popup-modal.is-editing .status-value,
.status-popup-modal.is-editing .status-popup-edit,
.status-popup-modal.is-editing .header-title-static {
    display: none; /* éšè—æ‰€æœ‰åªè¯»æ–‡æœ¬ã€ç¼–è¾‘æŒ‰é’®å’Œé™æ€æ ‡é¢˜ */
}

.status-popup-modal.is-editing .status-input,
.status-popup-modal.is-editing .status-popup-save,
.status-popup-modal.is-editing .header-title-editing {
    display: flex; /* æ˜¾ç¤ºæ‰€æœ‰è¾“å…¥æ¡†ã€ä¿å­˜æŒ‰é’®å’Œç¼–è¾‘æ ‡é¢˜ */
}

/* 3. è¾“å…¥æ¡†çš„å…·ä½“æ ·å¼ */
.status-input {
    width: 100%;
    padding: 8px 10px;
    font-size: 14px;
    font-family: inherit;
    color: #8D6E63;
    border: 2px solid #FFD1DC; /* ä½¿ç”¨ä¸»é¢˜ç²‰è‰²ä½œä¸ºè¾¹æ¡† */
    border-radius: 8px;
    background: white;
    transition: all 0.2s;
}

.status-input:focus {
    outline: none;
    border-color: #FF9AAD;
    box-shadow: 0 0 0 3px rgba(255, 182, 193, 0.3); /* èšç„¦æ—¶å‘å…‰æ•ˆæœ */
}

/* 4. ä¿®æ”¹å¤´éƒ¨æ ·å¼ä»¥é€‚åº”æ–°æŒ‰é’® */
.status-popup-header .header-title-static,
.status-popup-header .header-title-editing {
    left: 50%;
    transform: translateX(-50%) translateY(-10px);
    font-size: 16px;
    font-weight: 700;
    color: #8D6E63;
    position: absolute; /* 1. å¼€å¯ç›¸å¯¹å®šä½ */
}

.status-popup-save {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    right: 58px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: #e8f5e9; /* ä¿å­˜æŒ‰é’®ç”¨ç»¿è‰² */
    cursor: pointer;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.status-popup-save:hover {
    background: #c8e6c9;
    transform: translateY(-50%) scale(1.1);
}

.status-popup-save svg {
    width: 22px;
    height: 22px;
    fill: #4caf50;
}

/* style.css */
/* 1. åŸºç¡€å›¾æ ‡å®¹å™¨æ ·å¼ï¼ˆæœ€ç»ˆæ— èƒŒæ™¯ç‰ˆï¼‰ */
.settings-icon {
    width: 32px;
    height: 32px;
    margin-right: 14px;

    /* æ ¸å¿ƒä¿®æ”¹ï¼šè®©èƒŒæ™¯å®Œå…¨é€æ˜ */
    background-color: transparent;
    /* ç§»é™¤ä¸ºèƒŒæ™¯æ¿è®¾è®¡çš„åœ†è§’ */
    border-radius: 0;
    /* èƒŒæ™¯å›¾ç‰‡é€šç”¨å±æ€§ */
    background-size: contain; /* containèƒ½ç¡®ä¿å›¾æ ‡å®Œæ•´æ˜¾ç¤º */
    background-position: center;
    background-repeat: no-repeat;
}

/* 2. ä¸ºæ¯ä¸ªå›¾æ ‡å•ç‹¬è®¾ç½® `background-image` */
/* å’Œä¸Šæ¬¡ä¸€æ ·ï¼Œè¿™é‡Œåªè®¾ç½®å›¾ç‰‡ URL */
.icon-api {
    background-image: url('https://chatbotcos.weixin.qq.com/chatbot/30-openaiassets_68f3834db21084aab1644317b57b1737_469401762089707973.png');
}

/* style.css (åœ¨ settings-icon å®šä¹‰ä¸‹) */
.icon-voice {
    background-image: url('https://yanfa-upload.oss-cn-zhangjiakou.aliyuncs.com/images/20251112/1762885109_wqbs_tpzb.png'); /* æ›¿æ¢ä¸ºä½ çš„è¯­éŸ³å›¾æ ‡ */
}

.icon-database {
    background-image: url('https://s3plus.meituan.net/opapisdk/op_ticket_1_5677168484_1762885229487_qdqqd_1tiq2h.png');
}

.icon-fullscreen {
    background-image: url('https://kycloud4.koyoo.cn/202511127acfa202511120219417826.png');
}

.icon-storage {
    background-image: url('https://static.eeo.cn/upload/images/20251112/b1d57cfe371561654181.png');
}

.icon-contacts {
    background-image: url('https://kycloud4.koyoo.cn/20251112fc1d4202511120222082324.png');
}

.icon-mask {
    background-image: url('https://static.eeo.cn/upload/file/20251112/1762884823848355.png');
}

.icon-memory {
    background-image: url('https://static.eeo.cn/upload/images/20251112/130697f11739d9c51667.png');
}

.icon-beautify {
    background-image: url('https://kycloud4.koyoo.cn/202511129f0ea202511120216506324.png');
}

.icon-bubble {
    background-image: url('https://www.yn12377.cn/jubao/upload/smjb/2025/11/12/83b37e19fd754b9abab38a2d15649c99.png');
}

.icon-widget {
    background-image: url('https://yanfa-upload.oss-cn-zhangjiakou.aliyuncs.com/images/20251112/1762885109_wqbs_tpzb.png');
}

.icon-danger {
    background-image: url('https://file.zhuyitai.com/feedback/202511/12/ad03506e64f04510b9ab6e85c5dff324.png');
}

/*
====================================
èŠå¤©å¤´éƒ¨ - æ ‡é¢˜ä¸æ¨¡å¼å›¾æ ‡å¸ƒå±€ä¼˜åŒ–
====================================
*/

/* 1. è®©å¤´éƒ¨å®¹å™¨å†…çš„å…ƒç´ èƒ½æ›´å¥½åœ°å¯¹é½ */
.sweetheart-chat-header {
    position: relative; /* ç¡®ä¿ç»å¯¹å®šä½çš„å­å…ƒç´ æœ‰å‚è€ƒ */
}

/* 2. å°†æ ‡é¢˜å’Œæ¨¡å¼å›¾æ ‡ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶è®©å®ƒä»¬å±…ä¸­ */
.sweetheart-chat-title {
    position: static; /* ç§»é™¤ç»å¯¹å®šä½ï¼Œè®©å®ƒå‚ä¸flexå¸ƒå±€ */
    transform: none; /* ç§»é™¤transform */
    margin: 0; /* ç§»é™¤å¤–è¾¹è· */

    /* ä½¿ç”¨flexå¸ƒå±€è®©æ ‡é¢˜å’Œåé¢çš„å›¾æ ‡å¯¹é½ */
    display: flex;
    align-items: center;
    gap: 8px; /* æ ‡é¢˜å’Œå›¾æ ‡ä¹‹é—´çš„é—´è· */

    /* å…³é”®ï¼šå°†ç»„åˆä½“ç§»åŠ¨åˆ°é¡µé¢ä¸­å¿ƒ */
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    padding-top: 30px; /* é€‚é…çŠ¶æ€æ é«˜åº¦ */
}

/* 3. è°ƒæ•´æ¨¡å¼åˆ‡æ¢æŒ‰é’®çš„æ ·å¼ */
.mode-toggle-btn {
    /* ç§»é™¤åŸæœ‰çš„åœ†å½¢èƒŒæ™¯å’Œè¾¹æ¡† */
    background: none;
    box-shadow: none;
    width: auto; /* å®½åº¦è‡ªé€‚åº” */
    height: auto; /* é«˜åº¦è‡ªé€‚åº” */
    border-radius: 0;

    /* è®©å®ƒåœ¨flexå¸ƒå±€ä¸­å‚ç›´å±…ä¸­ */
    display: flex;
    align-items: center;
}

/* 4. è®¾ç½®å›¾æ ‡å›¾ç‰‡çš„å¤§å° */
.mode-toggle-btn img {
    height: 1.2em; /* æ ¸å¿ƒä¿®æ”¹ï¼šè®©å›¾æ ‡é«˜åº¦ä¸æ–‡å­—å¤§å°å…³è” (1.2å€æ–‡å­—é«˜åº¦) */
    width: auto; /* æ ¸å¿ƒä¿®æ”¹ï¼šå®½åº¦è‡ªåŠ¨è°ƒæ•´ï¼Œä»¥ä¿æŒå›¾ç‰‡åŸå§‹æ¯”ä¾‹ä¸å¤±çœŸ */
    opacity: 0.7; /* è®©å›¾æ ‡æŸ”å’Œä¸€ç‚¹ */
    transition: opacity 0.2s, transform 0.2s;
}

/* 5. é¼ æ ‡æ‚¬åœæ—¶å¢åŠ äº¤äº’æ•ˆæœ */
.mode-toggle-btn:hover img {
    opacity: 1;
    transform: scale(1.1);
}

/* ========== æµ‹è¯•åŠŸèƒ½æ ·å¼ ========== */

/* æµ‹è¯•é…ç½®å¼¹çª— */
.test-config-card {
    background: white;
    border-radius: 20px;
    width: 90%;
    max-width: 340px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

#testConfigModal.show .test-config-card {
    transform: scale(1);
}

.test-config-header {
    padding: 20px;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.test-config-content {
    padding: 20px;
    max-height: 60vh;
    overflow-y: auto;
}

.test-field {
    margin-bottom: 20px;
}

.test-label {
    display: block;
    font-size: 14px;
    font-weight: 600;
    color: #333;
    margin-bottom: 10px;
}

.knowledge-selector {
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    padding: 12px;
    /*max-height: 200px;*/
    /*overflow-y: auto;*/
}

.knowledge-checkbox-item {
    display: flex;
    align-items: flex-start;
    padding: 10px;
    border-bottom: 1px solid #f5f5f5;
    cursor: pointer;
    transition: background 0.2s;
}

.knowledge-checkbox-item:last-child {
    border-bottom: none;
}

.knowledge-checkbox-item:hover {
    background: #f8f9fa;
}

.knowledge-checkbox-item input[type="checkbox"] {
    margin-right: 10px;
    margin-top: 3px;
    cursor: pointer;
    accent-color: #667eea;
}

.knowledge-checkbox-label {
    flex: 1;
    font-size: 13px;
    color: #555;
    line-height: 1.4;
}

.test-config-footer {
    display: flex;
    gap: 12px;
    padding: 16px 20px;
    border-top: 1px solid #f0f0f0;
}

.test-btn {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.test-btn-cancel {
    background: #f0f0f0;
    color: #666;
}

.test-btn-generate {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.test-btn-generate:active {
    transform: scale(0.97);
}

/* æµ‹è¯•ç¡®è®¤å¼¹çª— */
.test-ready-card {
    background: white;
    border-radius: 20px;
    padding: 40px 30px;
    text-align: center;
    max-width: 300px;
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

#testReadyModal.show .test-ready-card {
    transform: scale(1);
}

.test-ready-icon {
    font-size: 64px;
    margin-bottom: 20px;
}

.test-ready-card h3 {
    font-size: 20px;
    color: #333;
    margin-bottom: 10px;
}

.test-ready-card p {
    font-size: 14px;
    color: #666;
    margin-bottom: 24px;
}

.test-ready-actions {
    display: flex;
    gap: 12px;
}

.test-btn-start {
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    color: white;
}

/* æµ‹è¯•é¡µé¢ */
.test-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #f7f8fa;
    z-index: 2500 !important;
    display: flex;
    flex-direction: column;
    transform: translateY(100%);
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.test-page.show {
    transform: translateY(0);
}

.test-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 45px 12px 12px;
    background: white;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
}

.test-timer {
    font-size: 16px;
    font-weight: 600;
    color: #667eea;
    font-family: 'Courier New', monospace;
}

.test-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

.test-question {
    background: white;
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.question-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
    padding-bottom: 12px;
    border-bottom: 2px solid #f0f0f0;
}

.question-number {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: bold;
    flex-shrink: 0;
}

.question-type {
    background: #e3f2fd;
    color: #1976d2;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
}

.question-text {
    font-size: 16px;
    font-weight: 600;
    color: #333;
    line-height: 1.6;
    margin-bottom: 16px;
}

.question-options {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.option-item {
    display: flex;
    align-items: center;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.option-item:hover {
    background: #f8f9fa;
    border-color: #667eea;
}

.option-item.selected {
    background: #e8eaf6;
    border-color: #667eea;
}

.option-item input[type="radio"] {
    margin-right: 12px;
    cursor: pointer;
    accent-color: #667eea;
}

.option-label {
    flex: 1;
    font-size: 14px;
    color: #555;
}

.answer-input {
    width: 100%;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    font-size: 14px;
    resize: vertical;
    min-height: 60px;
}

.answer-input:focus {
    outline: none;
    border-color: #667eea;
}

.test-footer {
    padding: 16px 20px;
    background: white;
    border-top: 1px solid #e0e0e0;
}

.test-submit-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.test-submit-btn:active {
    transform: scale(0.98);
}

/* æµ‹è¯•ç»“æœå¼¹çª— */
.test-result-card {
    background: white;
    border-radius: 20px;
    width: 90%;
    max-width: 360px;
    max-height: 80vh;
    /*overflow: hidden;*/
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: flex; /* æ–°å¢ï¼šå¯ç”¨flexå¸ƒå±€ï¼Œè®©å­å…ƒç´ å¯ä»¥åˆ†é…ç©ºé—´ */
    flex-direction: column; /* æ–°å¢ï¼šè®©å­å…ƒç´ å‚ç›´æ’åˆ— */
}

#testResultModal.show .test-result-card {
    transform: scale(1);
}

.test-result-header {
    padding: 20px;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.test-result-content {
    padding: 30px 20px;
    flex: 1; /* æ–°å¢ï¼šè®©å†…å®¹åŒºå æ®æ‰€æœ‰å¯ç”¨çš„å‰©ä½™ç©ºé—´ */
    overflow-y: auto; /* æ–°å¢ï¼šå½“å†…å®¹è¶…å‡ºæ—¶ï¼Œåœ¨è¿™ä¸ªåŒºåŸŸå‡ºç°æ»šåŠ¨æ¡ */
}

.score-display {
    text-align: center;
    margin-bottom: 30px;
}

.score-number {
    font-size: 72px;
    font-weight: bold;
    background: linear-gradient(135deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
}

.score-label {
    font-size: 18px;
    color: #666;
    margin-top: 8px;
}

.score-details {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 16px;
}

.detail-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid #e0e0e0;
}

.detail-item:last-child {
    border-bottom: none;
}

.detail-label {
    font-size: 14px;
    color: #666;
}

.detail-value {
    font-size: 14px;
    font-weight: 600;
    color: #333;
}

.test-result-footer {
    padding: 16px 20px;
    border-top: 1px solid #f0f0f0;
}

.test-btn-close {
    width: 100%;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

/* é”™é¢˜è§£æåŒºåŸŸ */
.wrong-answers-section {
    margin-top: 20px;
}

.wrong-answers-section .section-title {
    font-size: 14px;
    font-weight: 600;
    color: #333;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 2px solid #f0f0f0;
}

.wrong-answer-item {
    background: #fff5f5;
    border-left: 3px solid #ff3b30;
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 8px;
}

.wrong-q-number {
    font-size: 12px;
    color: #ff3b30;
    font-weight: 600;
    margin-bottom: 6px;
}

.wrong-q-text {
    font-size: 13px;
    color: #333;
    margin-bottom: 8px;
    line-height: 1.4;
}

.wrong-answer-row {
    display: flex;
    align-items: baseline;
    margin: 4px 0;
    font-size: 12px;
}

.answer-label {
    font-weight: 600;
    margin-right: 6px;
    min-width: 80px;
}

.answer-label.wrong {
    color: #ff3b30;
}

.answer-label.correct {
    color: #34c759;
}

.answer-text {
    flex: 1;
    color: #555;
}

/*
====================================
çŠ¶æ€å†å²è®°å½•åŠŸèƒ½ - æ ·å¼
====================================
*/

/* 1. "æˆ‘çš„çŠ¶æ€" åŒºåŸŸçš„å¤´éƒ¨å®¹å™¨ï¼Œä½¿ç”¨ Flex å¸ƒå±€ */
.my-status-header {
    display: flex;
    align-items: center;
    gap: 8px; /* å›¾æ ‡å’Œæ–‡å­—ä¹‹é—´çš„é—´è· */
    margin-bottom: 12px;
}

/* 2. "å†å²è®°å½•" å›¾æ ‡æŒ‰é’®æ ·å¼ */
.status-history-btn {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: #FFF0F5;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.status-history-btn:hover {
    background: #FFE4E9;
    transform: scale(1.1);
}

.status-history-btn svg {
    width: 16px;
    height: 16px;
    fill: #D4A5A5;
}

/* 3. å†å²è®°å½•å¼¹çª—æ ·å¼ */
.status-history-modal {
    position: relative;
    z-index: 1;
    width: 90%;
    max-width: 340px;
    background: linear-gradient(180deg, #FFF5F5 0%, #FFE8E8 100%);
    border: 3px solid #FFB6C1;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(255, 182, 193, 0.3);
    display: flex;
    flex-direction: column;
    max-height: 80vh;
}

.status-history-header {
    padding: 16px 20px;
    border-bottom: 2px dashed #FFD1DC;
    position: relative;
    text-align: center;
}

.status-history-title {
    font-size: 16px;
    font-weight: 700;
    color: #8D6E63;
    margin: 0;
}

.status-history-content {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.status-history-content::-webkit-scrollbar {
    width: 6px;
}

.status-history-content::-webkit-scrollbar-track {
    background: #FFE8E8;
}

.status-history-content::-webkit-scrollbar-thumb {
    background: #FFB6C1;
    border-radius: 3px;
}

/* 4. å•æ¡å†å²è®°å½•é¡¹æ ·å¼ */
.history-item {
    background: rgba(255, 255, 255, 0.8);
    border-radius: 12px;
    padding: 12px;
    border: 1px solid #FFD1DC;
    position: relative;
}

.history-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.history-item-date {
    font-size: 11px;
    font-weight: 600;
    color: #BCAAA4;
}

.history-item-delete-btn {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #FFE4E9;
    color: #D4A5A5;
    border: none;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.2s;
}

.history-item-delete-btn:hover {
    background: #FFB6C1;
    color: white;
    transform: rotate(90deg);
}

.history-status-section {
    font-size: 12px;
    color: #8D6E63;
    padding-left: 10px;
    border-left: 3px solid #FFC0D9;
}

.history-status-section h5 {
    font-size: 12px;
    color: #A1887F;
    margin-bottom: 6px;
}

.history-status-section p {
    margin: 4px 0;
}

/* 5. å†å²è®°å½•ä¸ºç©ºæ—¶çš„å ä½ç¬¦æ ·å¼ */
.history-empty {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: #D4A5A5;
    min-height: 200px;
}

.history-empty-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.history-empty-text {
    font-size: 14px;
    font-weight: 600;
}

/* åœ¨ style.css ä¸­æ·»åŠ  */
/* å½“æ»‘åŠ¨æ—¶ï¼Œæš‚æ—¶ç¦ç”¨é«˜æ¶ˆè€—çš„ backdrop-filter */
.body.is-swiping .dock,
.body.is-swiping .folder-overlay {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    background: rgba(255, 255, 255, 0.8); /* æä¾›ä¸€ä¸ªé™çº§èƒŒæ™¯ */
}

#widgetManager .settings-content {
    overflow-y: auto !important;
    max-height: 75vh !important; /* é™åˆ¶æœ€å¤§é«˜åº¦ï¼Œå¼ºåˆ¶æ˜¾ç¤ºæ»šåŠ¨æ¡ */
}

#savedWidgetsList {
    overflow-y: auto;
    max-height: 60vh; /* ç¡®ä¿åˆ—è¡¨å¯æ»šåŠ¨ */
}
/* ========== åŒæ­¥ç»„ç®¡ç†æ ·å¼ - å¼€å§‹ ========== */

/* æˆ‘çš„çŠ¶æ€æ ‡é¢˜æ  */
.my-status-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.my-status-header h4 {
    margin: 0;
}

/* åŒæ­¥æŒ‰é’® */
.status-sync-btn {
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 50%;
    background: linear-gradient(135deg, #FFB6C1, #FF9AAD);
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    box-shadow: 0 2px 8px rgba(255, 182, 193, 0.3);
}

.status-sync-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(255, 182, 193, 0.4);
}

.status-sync-btn:active {
    transform: scale(0.95);
}

.status-sync-btn svg {
    width: 18px;
    height: 18px;
}

/* åŒæ­¥å¼¹çª— */
.status-sync-popup-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1012;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.status-sync-popup-overlay.show {
    opacity: 1;
    visibility: visible;
}

.status-sync-popup-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(161, 136, 127, 0.5);
    backdrop-filter: blur(4px);
}

.status-sync-popup-modal {
    position: relative;
    z-index: 1;
    background: linear-gradient(180deg, #FFF5F5 0%, #FFE8E8 100%);
    border: 3px solid #FFB6C1;
    border-radius: 20px;
    width: 85%;
    max-width: 340px;
    max-height: 70vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 10px 40px rgba(255, 182, 193, 0.3);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.status-sync-popup-overlay.show .status-sync-popup-modal {
    transform: scale(1);
}

.status-sync-popup-header {
    padding: 20px;
    border-bottom: 2px dashed #FFD1DC;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}

.status-sync-title {
    font-size: 16px;
    font-weight: 700;
    color: #8D6E63;
    margin: 0;
}

.status-sync-popup-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

.status-sync-popup-content::-webkit-scrollbar {
    width: 6px;
}

.status-sync-popup-content::-webkit-scrollbar-track {
    background: #FFE8E8;
}

.status-sync-popup-content::-webkit-scrollbar-thumb {
    background: #FFB6C1;
    border-radius: 3px;
}

/* åŒæ­¥çŠ¶æ€ä¿¡æ¯ */
.sync-status-info {
    text-align: center;
    padding: 20px;
    background: rgba(255, 255, 255, 0.6);
    border-radius: 12px;
    margin-bottom: 20px;
}

.sync-status-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.sync-status-text {
    font-size: 14px;
    color: #8D6E63;
    line-height: 1.5;
}

/* åŒæ­¥ç»„æˆå‘˜åˆ—è¡¨ */
.sync-group-members {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.sync-member-item {
    display: flex;
    align-items: center;
    padding: 12px;
    background: rgba(255, 255, 255, 0.8);
    border-radius: 12px;
    border: 2px solid transparent;
    transition: all 0.2s ease;
}

.sync-member-item.is-me {
    border-color: #FFB6C1;
    background: linear-gradient(135deg, rgba(255, 182, 193, 0.2), rgba(255, 154, 173, 0.2));
}

.sync-member-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin-right: 12px;
    overflow: hidden;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    background: #fff;
    border: 2px solid #FFE8E8;
}

.sync-member-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.sync-member-info {
    flex: 1;
}

.sync-member-name {
    font-size: 14px;
    font-weight: 600;
    color: #8D6E63;
    margin-bottom: 2px;
}

.sync-member-badge {
    font-size: 11px;
    color: #BCAAA4;
}

.sync-member-badge.active {
    color: #FF9AAD;
    font-weight: 600;
}

.sync-member-status {
    font-size: 20px;
}

.sync-member-status.active {
    color: #4CAF50;
}

.sync-member-status.inactive {
    color: #999;
    opacity: 0.5;
}

/* åº•éƒ¨æŒ‰é’® */
.status-sync-popup-footer {
    padding: 16px 20px;
    border-top: 2px dashed #FFD1DC;
    flex-shrink: 0;
}

.status-sync-toggle-btn {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.status-sync-toggle-btn.join {
    background: linear-gradient(135deg, #43e97b, #38f9d7);
    color: white;
}

.status-sync-toggle-btn.leave {
    background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
    color: white;
}

.status-sync-toggle-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
}

.status-sync-toggle-btn:active {
    transform: translateY(0);
}

/* ========== åŒæ­¥ç»„ç®¡ç†æ ·å¼ - ç»“æŸ ========== */
/* ========== æ¶ˆæ¯æ¸²æŸ“å¼‚å¸¸é˜²å¾¡ ========== */
.chat-bubble:empty::before {
    content: '[ç©ºæ¶ˆæ¯]';
    color: #999;
    font-style: italic;
}

.render-iframe {
    min-height: 100px; /* ç¡®ä¿iframeæœ‰æœ€å°é«˜åº¦ */
    background: #f5f5f5; /* åŠ è½½æ—¶çš„èƒŒæ™¯è‰² */
}

/* é˜²æ­¢å¼‚å¸¸å†…å®¹ç ´åå¸ƒå±€ */
.chat-bubble * {
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
}
/* style.css */

/* â–¼â–¼â–¼ åœ¨è¿™é‡Œç²˜è´´æ–°å¢çš„é”™è¯¯æç¤ºæ¡†CSS â–¼â–¼â–¼ */
.error-modal {
    z-index: 3000; /* ç¡®ä¿åœ¨æœ€é¡¶å±‚ */
    display: none; /* é»˜è®¤éšè— */
}

.error-modal .modal-content {
    background: #fff;
    border: 3px solid #ff4757; /* é†’ç›®çš„çº¢è‰²è¾¹æ¡† */
    box-shadow: 0 10px 30px rgba(255, 71, 87, 0.3);
}

.error-icon {
    font-size: 48px;
    margin-bottom: 16px;
    animation: shake 0.5s;
}

.error-modal h3 {
    color: #c0392b; /* æ·±çº¢è‰²æ ‡é¢˜ */
}

.error-modal p {
    color: #7f8c8d; /* ç°è‰²æè¿°æ–‡å­— */
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px) rotate(-2deg); }
    75% { transform: translateX(5px) rotate(2deg); }
}
/* â–²â–²â–² CSSä»£ç ç²˜è´´ç»“æŸ â–²â–²â–² */

/* ä¼˜åŒ–è§¦æ‘¸å“åº” */
.chat-action-btn,
.attachment-item,
.action-option {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
}
/* â–¼â–¼â–¼ ç²˜è´´ä»¥ä¸‹æ‰€æœ‰CSSä»£ç  â–¼â–¼â–¼ */

/*
============================
 çº¢åŒ…åŠŸèƒ½ - æ ·å¼
============================
*/

/* 1. èŠå¤©æ°”æ³¡ä¸­çš„çº¢åŒ…æ ·å¼ */
.red-packet-bubble {
    background-color: #FA9D3B; /* å¾®ä¿¡çº¢åŒ…çš„æ©™è‰² */
    color: white;
    padding: 12px 16px;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 12px;
    width: 220px;
    transition: background-color 0.3s;
}

.red-packet-bubble.opened {
    background-color: #FAD0A3; /* æ‰“å¼€åçš„æµ…æ©™è‰² */
    cursor: default;
}

.red-packet-icon {
    font-size: 36px;
    flex-shrink: 0;
}

.red-packet-info {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.red-packet-greeting {
    font-size: 14px;
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.red-packet-type {
    font-size: 12px;
    margin-top: 4px;
    padding-top: 4px;
    border-top: 1px solid rgba(255, 255, 255, 0.3);
}

/* 2. å‘çº¢åŒ…çš„å¼¹çª—æ ·å¼ */
.red-packet-creator {
    width: 100%;
    max-width: 350px;
    background: #F7F7F7;
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    animation: rpModalIn 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

@keyframes rpModalIn {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

.rp-creator-header {
    position: relative;
    text-align: center;
    padding: 16px;
}

.rp-creator-close {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
    color: #888;
    cursor: pointer;
}

.rp-creator-title {
    font-size: 16px;
    font-weight: 600;
    color: #333;
}

.rp-creator-body {
    padding: 16px;
    background: white;
}

.rp-amount-field, .rp-greeting-field {
    border-bottom: 1px solid #F0F0F0;
    padding: 16px 0;
}

.rp-amount-field {
    display: flex;
    align-items: center;
    gap: 12px;
}

.rp-amount-label {
    font-size: 16px;
    color: #333;
}

.rp-amount-input {
    flex: 1;
    border: none;
    font-size: 24px;
    text-align: right;
    font-weight: bold;
}
.rp-amount-input:focus, .rp-greeting-input:focus {
    outline: none;
}

.rp-amount-unit {
    font-size: 16px;
    color: #333;
}

.rp-greeting-input {
    width: 100%;
    border: none;
    background: transparent;
    font-size: 15px;
    padding: 8px 0;
}

.rp-creator-footer {
    padding: 30px 16px;
    text-align: center;
}

.rp-display-amount {
    font-size: 40px;
    font-weight: 300;
    color: #000;
    margin-bottom: 24px;
}
.rp-display-amount span {
    font-weight: 500;
}

.rp-send-btn {
    width: 80%;
    padding: 14px;
    border: none;
    border-radius: 8px;
    background: #E55743;
    color: white;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.rp-send-btn.disabled {
    background: #FFAD9F;
    cursor: not-allowed;
}

/* 3. å¼€çº¢åŒ…çš„å¼¹çª—æ ·å¼ */
#redPacketOpenModal {
    background: transparent;
    backdrop-filter: none;
}
.rp-opener-backdrop {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
    z-index: 5;
}

.rp-opener-card {
    position: relative;
    z-index: 10;
    width: 280px;
    height: 480px;
    background: linear-gradient(180deg, #E55845 0%, #D84B38 100%);
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: hidden;
    transform: translateY(-100vh);
    animation: rpOpenerFall 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes rpOpenerFall {
    to { transform: translateY(0); }
}

.rp-cover, .rp-details {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px;
    transition: opacity 0.5s ease;
}

.rp-cover::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 120px;
    background: linear-gradient(180deg, #D4422D 0%, #D84B38 100%);
    border-radius: 0 0 50% 50% / 0 0 10% 10%;
}

.rp-sender-info {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 60px;
}

.rp-sender-avatar {
    width: 54px; height: 54px;
    border-radius: 8px;
    background: #fff;
    overflow: hidden;
    margin-bottom: 8px;
}

.rp-sender-avatar img, .rp-sender-avatar span {
    width: 100%; height: 100%;
    object-fit: cover;
    font-size: 28px;
    display: flex; align-items: center; justify-content: center;
}

.rp-sender-name {
    font-size: 16px;
    color: #F8D69A;
}

.rp-greeting {
    position: relative;
    z-index: 1;
    margin-top: 24px;
    font-size: 22px;
    color: #F8D69A;
    font-weight: 500;
}

/* ç”¨è¿™æ®µæ–°çš„CSSæ›¿æ¢æ—§çš„ .rp-open-btn æ ·å¼ */
.rp-open-btn {
    position: absolute;      /* 1. æ”¹ä¸ºç»å¯¹å®šä½ */
    z-index: 20;             /* 2. èµ‹äºˆä¸€ä¸ªéå¸¸é«˜çš„å±‚çº§ */
    bottom: 90px;            /* 3. ç›´æ¥å®šä½åœ¨åº•éƒ¨ */
    left: 50%;               /* 4. æ°´å¹³å±…ä¸­ */
    transform: translateX(-50%); /* 5. ç²¾ç¡®æ°´å¹³å±…ä¸­ */

    /* ä»¥ä¸‹æ ·å¼ä¿æŒä¸å˜ï¼Œä½†ä¸ºäº†å®Œæ•´æ€§ä¸€å¹¶æä¾› */
    width: 90px;
    height: 90px;
    background: #F8D69A;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    color: #A9622A;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 6px 15px rgba(0,0,0,0.2), inset 0 2px 3px rgba(255,255,255,0.4);
}

.rp-open-btn.spinning {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* æ‰“å¼€åçš„æ ·å¼ */
.rp-opener-card.is-opened .rp-cover {
    opacity: 0;
    pointer-events: none;
}
.rp-opener-card.is-opened .rp-details {
    opacity: 1;
}

.rp-details {
    opacity: 0;
    background: #F7F7F7;
    transition-delay: 0.3s;
}

.rp-details-amount {
    margin-top: 80px;
    font-size: 50px;
    font-weight: 500;
    color: #333;
}
.rp-details-amount span:last-child {
    font-size: 16px;
    margin-left: 4px;
}

.rp-details-greeting {
    margin-top: 12px;
    font-size: 16px;
    color: #888;
}

.rp-details-tip {
    position: absolute;
    bottom: 24px;
    font-size: 14px;
    color: #5583A8;
    cursor: pointer;
}

/* â–²â–²â–² CSSä»£ç ç²˜è´´ç»“æŸ â–²â–²â–² */
/* ========== [æœ€é«˜ä¼˜å…ˆçº§ç‰ˆæœ¬] å¯†å‹èŠå¤©å¤´åƒæ˜¾ç¤ºæ§åˆ¶ ========== */

/* 1. é»˜è®¤éšè—å¤´åƒå’Œå‘é€è€…åç§°ï¼ˆé™ä½ä¼˜å…ˆçº§ï¼Œæ–¹ä¾¿è¢«è¦†ç›–ï¼‰*/
.sweetheart-chat-page .message-chat-avatar,
.sweetheart-chat-page .message-sender-name {
    display: none;
}

/* 2. âœ… å¼€å¯å¤´åƒæ˜¾ç¤ºæ—¶ï¼Œä½¿ç”¨æ›´é«˜çš„ä¼˜å…ˆçº§å¼ºåˆ¶æ˜¾ç¤º */
.sweetheart-chat-page.show-avatars .message-chat-avatar {
    display: flex !important; /* ä½¿ç”¨ !important ç¡®ä¿ä¼˜å…ˆçº§æœ€é«˜ */
    width: 36px;
    height: 36px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
    align-items: center;
    justify-content: center;
    background: #FFF0F5;
    border: 2px solid #FFE8E8;
}

/* 3. å¤´åƒå†…çš„å›¾ç‰‡æ ·å¼ */
.sweetheart-chat-page.show-avatars .message-chat-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* 4. å¤´åƒå†…çš„emoji/æ–‡å­—æ ·å¼ */
.sweetheart-chat-page.show-avatars .message-chat-avatar .initials {
    font-size: 18px;
    line-height: 1;
    color: #D4A5A5;
}

/* 5. âœ… ä¹Ÿè®©å‘é€è€…åç§°æ˜¾ç¤ºå‡ºæ¥ï¼ˆå¯é€‰ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼‰*/
.sweetheart-chat-page.show-avatars .message-sender-name {
    font-size: 12px;
    color: #999;
    margin-bottom: 4px;
}

/* 6. æ¶ˆæ¯è¡Œçš„åŸºç¡€flexå¸ƒå±€ */
.sweetheart-chat-page.show-avatars .message-row {
    display: flex !important;
    align-items: flex-end !important;
    gap: 8px !important;
    margin-bottom: 12px;
    padding: 0 2px;
    width: 100%;
}

/* 7. âœ… æ¥æ”¶çš„æ¶ˆæ¯ï¼ˆå¯¹æ–¹ï¼‰ï¼šå¤´åƒåœ¨å·¦ï¼Œå†…å®¹åœ¨å³ */
.sweetheart-chat-page.show-avatars .message-row.received {
    justify-content: flex-start !important;
    flex-direction: row !important;
}

/* 8. âœ… å‘é€çš„æ¶ˆæ¯ï¼ˆè‡ªå·±ï¼‰ï¼šé€šè¿‡orderè®©å¤´åƒæ˜¾ç¤ºåœ¨å³ä¾§ */
.sweetheart-chat-page.show-avatars .message-row.sent {
    justify-content: flex-end !important;
    flex-direction: row !important;
}

/* 9. âœ… æ ¸å¿ƒæŠ€å·§ï¼šä½¿ç”¨CSSçš„orderå±æ€§è°ƒæ•´sentæ¶ˆæ¯çš„è§†è§‰é¡ºåº */
/* å› ä¸ºDOMé¡ºåºç»Ÿä¸€ä¸ºï¼šå¤´åƒ â†’ å†…å®¹ï¼Œæ‰€ä»¥ç”¨orderè®©sentæ¶ˆæ¯çš„å¤´åƒæ˜¾ç¤ºåœ¨åé¢ */
.sweetheart-chat-page.show-avatars .message-row.sent .message-chat-avatar {
    order: 2; /* å¤´åƒæ’åœ¨åé¢ï¼ˆå³ä¾§ï¼‰*/
}

.sweetheart-chat-page.show-avatars .message-row.sent .message-content {
    order: 1; /* å†…å®¹æ’åœ¨å‰é¢ï¼ˆå·¦ä¾§ï¼‰ä½†æ•´ä½“é å³ */
}

/* 10. æ¥æ”¶æ¶ˆæ¯ä¿æŒé»˜è®¤orderï¼ˆå¤´åƒåœ¨å·¦ï¼Œå†…å®¹åœ¨å³ï¼‰*/
.sweetheart-chat-page.show-avatars .message-row.received .message-chat-avatar {
    order: 1;
}

/* è°ƒæ•´æ¥æ”¶æ¶ˆæ¯çš„é¡ºåºå’Œé—´è· */
.message-row.received .message-chat-avatar {
    order: 1; /* å¤´åƒåœ¨ç¬¬ä¸€ä¸ª */
    margin-right: 8px; /* å¤´åƒä¸å†…å®¹ä¹‹é—´é—´è· */
}

.sweetheart-chat-page.show-avatars .message-row.received .message-content {
    order: 2;
}

.message-row.received .message-content {
    order: 2; /* å†…å®¹åœ¨ç¬¬äºŒä¸ª */
}

/* 11. æ¶ˆæ¯å†…å®¹å®¹å™¨çš„æ ·å¼ */
.sweetheart-chat-page.show-avatars .message-content {
    max-width: calc(100% - 50px);
    display: flex;
    flex-direction: column;
}

/* 12. æ¥æ”¶æ¶ˆæ¯çš„å†…å®¹å·¦å¯¹é½ */
.sweetheart-chat-page.show-avatars .message-row.received .message-content {
    align-items: flex-start;
}

/* 13. å‘é€æ¶ˆæ¯çš„å†…å®¹å³å¯¹é½ */
.sweetheart-chat-page.show-avatars .message-row.sent .message-content {
    align-items: flex-end;
}

/* 14. æ°”æ³¡è‡ªé€‚åº”å†…å®¹ï¼Œä¸è¶…å‡ºå®¹å™¨ */
.sweetheart-chat-page.show-avatars .chat-bubble {
    max-width: 100%;
    word-wrap: break-word;
    word-break: break-word;
}

/* 15. çº¢åŒ…æ¶ˆæ¯çš„å®½åº¦é™åˆ¶ */
.sweetheart-chat-page.show-avatars .red-packet-bubble {
    max-width: 220px;
}

/* 16. å›¾ç‰‡æ¶ˆæ¯çš„ç‰¹æ®Šå¤„ç† */
.sweetheart-chat-page.show-avatars .chat-bubble.image-only {
    max-width: 200px;
    padding: 0;
    background: transparent;
}

.sweetheart-chat-page.show-avatars .chat-bubble.image-only img {
    border-radius: 8px;
}

/* 17. ä»£ç å—çš„å®½åº¦é™åˆ¶ */
.sweetheart-chat-page.show-avatars .code-block-wrapper {
    max-width: calc(100vw - 120px);
}

/* 18. iframeæ¶ˆæ¯çš„ç‰¹æ®Šå¤„ç† */
.sweetheart-chat-page.show-avatars .render-bubble {
    max-width: 280px;
    min-width: 200px;
}

/*
====================================
 è¯­éŸ³æ¡è¿›åº¦åŠ¨ç”» - ã€æœ€ç»ˆç‰ˆã€‘
====================================
*/

/*!* 1. å…³é”®å¸§åŠ¨ç”»ï¼šå®šä¹‰ç®­å¤´ä»å·¦åˆ°å³çš„æ»‘åŠ¨è¡Œä¸º *!*/
/*@keyframes disclosureArrowSlide {*/
/*  from {*/
/*    !* åŠ¨ç”»å¼€å§‹æ—¶ï¼Œç®­å¤´åœ¨æœ€å·¦è¾¹ (ç¨å¾®å‘å³åç§»ä¸€ç‚¹ç‚¹ï¼Œè§†è§‰æ•ˆæœæ›´å¥½) *!*/
/*    left: 2%;*/
/*  }*/
/*  to {*/
/*    !* åŠ¨ç”»ç»“æŸæ—¶ï¼Œç®­å¤´åœ¨æœ€å³è¾¹ (åŒæ ·ç•™ä¸€ç‚¹è¾¹è·) *!*/
/*    left: 98%;*/
/*  }*/
/*}*/

/* 2. è®© voice-bar æˆä¸ºç®­å¤´å®šä½çš„å‚è€ƒçˆ¶å…ƒç´  */
.voice-bar {
    position: relative; /* æ ¸å¿ƒï¼šè®©ç®­å¤´å¯ä»¥ç›¸å¯¹å®ƒå®šä½ */
    overflow: hidden;   /* ç¡®ä¿ç®­å¤´ä¸ä¼šè¶…å‡ºè½¨é“ */
}


/* åŒæ—¶ï¼Œè®©è¿›åº¦æ¡å¡«å……ä¹ŸåŠ¨èµ·æ¥ */
.voice-progress-fill {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 0%; /* åˆå§‹å®½åº¦ä¸º0 */
    background: rgba(0,0,0,0.1);
    border-radius: 5px;
    transition: width 0.1s linear; /* å¹³æ»‘è¿‡æ¸¡ */
    z-index: 1; /* ç¡®ä¿åœ¨ç®­å¤´ä¸‹æ–¹ */
}

.voice-message-bubble.is-playing .voice-progress-fill {
  /* JSä¼šç›´æ¥æ›´æ–°å®½åº¦ï¼Œä¸éœ€è¦CSSåŠ¨ç”» */
}

/* AIæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œè¿›åº¦æ¡å¡«å……é¢œè‰² */
.message-row.received .voice-progress-fill {
    background: rgba(0,0,0,0.2);
}

/* æˆ‘æ–¹å‘é€çš„æ¶ˆæ¯ï¼Œè¿›åº¦æ¡å¡«å……é¢œè‰² */
.message-row.sent .voice-progress-fill {
    background: rgba(255,255,255,0.2);
}

/* å¯†å‹èŠå¤©ä¸»é¢˜è‰² */
.sweetheart-chat-page .message-row.sent .voice-progress-fill {
    background: rgba(255,255,255,0.3);
}
.sweetheart-chat-page .message-row.received .voice-progress-fill {
   background: rgba(141, 110, 99, 0.2);
}

/* æ’­æ”¾/åŠ è½½ä¸­å›¾æ ‡çš„æ ·å¼ */
.voice-play-icon.loading .spinner {
    width: 20px;
    height: 20px;
    animation: tts-spinner-spin 1s linear infinite;
}
.voice-play-icon.loading .spinner .path {
    stroke: currentColor;
    stroke-linecap: round;
    stroke-width: 5;
    fill: none;
    animation: dash 1.5s ease-in-out infinite;
}
@keyframes tts-spinner-spin {
    100% { transform: rotate(360deg); }
}
@keyframes dash {
  0% { stroke-dasharray: 1, 150; stroke-dashoffset: 0; }
  50% { stroke-dasharray: 90, 150; stroke-dashoffset: -35; }
  100% { stroke-dasharray: 90, 150; stroke-dashoffset: -124; }
}

/* ç§»é™¤å¯èƒ½çš„é®æŒ¡å±‚ */
.message-row::before,
.message-row::after,
.chat-bubble::before,
.chat-bubble::after {
    pointer-events: none !important;
}

/* ç¡®ä¿æ¶ˆæ¯å®¹å™¨ä¸ä¼šå¹²æ‰° */
.message-content {
    pointer-events: none;
}

.message-content > * {
    pointer-events: auto;
}

/* ç§»é™¤å¯èƒ½çš„é®æŒ¡ */
.voice-message-bubble::before,
.voice-message-bubble::after {
    pointer-events: none !important;
}

/* ç¡®ä¿åŠ è½½åŠ¨ç”»ä¸ä¼šé®æŒ¡ */
.voice-play-icon.loading {
    pointer-events: none;
}

.voice-play-icon:not(.loading) {
    pointer-events: auto !important;
}

/* ========== å¯†å‹èŠå¤©è¾“å…¥æ¡†æŒ‰é’®åˆ‡æ¢é€»è¾‘ (ä¿®å¤ç‰ˆ) ========== */

/* 1. é»˜è®¤çŠ¶æ€ (è¾“å…¥æ¡†æ— å­—) */
/* éšè—å‘é€æŒ‰é’® (çˆ±å¿ƒ) */
#sweetheartSendMsgBtn {
    display: none !important;
}
/* æ˜¾ç¤ºæ¥æ”¶æŒ‰é’® (æ˜Ÿæ˜Ÿ/ä¿¡å°) */
#sweetheartGetReplyBtn {
    display: flex !important;
}

/* 2. è¾“å…¥çŠ¶æ€ (è¾“å…¥æ¡†æœ‰å­—ï¼Œçˆ¶å®¹å™¨æœ‰ .has-text ç±») */
/* æ˜¾ç¤ºå‘é€æŒ‰é’® */
.sweetheart-chat-input-area.has-text #sweetheartSendMsgBtn {
    display: flex !important;
}
/* éšè—æ¥æ”¶æŒ‰é’® */
.sweetheart-chat-input-area.has-text #sweetheartGetReplyBtn {
    display: none !important;
}

/* ========== å°è¯´ä¹¦æ¶æ ·å¼ (ä¿®å¤ç‰ˆ) ========== */
.novel-shelf-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #F2F2F7;
    z-index: 1300; /* å±‚çº§å¾ˆé«˜ï¼Œæ‰€ä»¥å¿…é¡»ç¡®ä¿è¢«ç§»å‡ºå±å¹• */

    /* æ ¸å¿ƒéšè—é€»è¾‘ï¼šé»˜è®¤å‘å³å¹³ç§»100%ï¼Œå¹¶éšè—å¯è§æ€§ */
    transform: translateX(100%);
    visibility: hidden;

    /* è¿‡æ¸¡åŠ¨ç”» */
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94), visibility 0.35s;

    display: flex;
    flex-direction: column;
    border-radius: 0;
}

/* å½“æ·»åŠ äº† .show ç±»æ—¶çš„æ ·å¼ */
.novel-shelf-page.show {
    transform: translateX(0); /* ç§»å›å±å¹•ä¸­é—´ */
    visibility: visible;      /* è®¾ä¸ºå¯è§ */
}

/* 1. ä¹¦æ¶å®¹å™¨ */
.novel-shelf-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;

    display: grid;
    /* å›ºå®šåˆ†æˆ3åˆ—ï¼Œæ¯åˆ—å æ®1ä»½å¯ç”¨ç©ºé—´ */
    grid-template-columns: repeat(3, 1fr);
    grid-auto-rows: min-content;
    align-content: start;

    gap: 20px 15px;
}

/* 2. å•æœ¬ä¹¦çš„å®¹å™¨ */
.book-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    position: relative;

    /* ğŸ”¥ã€æ ¸å¿ƒä¿®å¤ã€‘ğŸ”¥ */
    /* min-width: 0 å…è®¸Gridå­é¡¹åœ¨ç©ºé—´ä¸è¶³æ—¶æ”¶ç¼©ï¼Œè€Œä¸æ˜¯è¢«é•¿æ–‡æœ¬æ’‘å¤§ */
    min-width: 0;
    width: 100%; /* å æ»¡æ ¼å­çš„å®½åº¦ */
}

/* 3. å°é¢æ ·å¼ */
.book-cover {
    width: 100%;
    /* é”å®š 2:3 æ¯”ä¾‹ï¼Œé«˜åº¦è‡ªåŠ¨è®¡ç®— */
    aspect-ratio: 2 / 3;

    border-radius: 6px;
    background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%);
    box-shadow: 2px 4px 10px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10px;
    text-align: center;
    overflow: hidden;
}

/* 4. å°é¢ä¸Šçš„æ–‡å­—é¢„è§ˆä¿®æ­£ */
.book-title-preview {
    font-size: 14px;
    font-weight: bold;
    color: #fff;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);

    /* ğŸ”¥ é˜²æ­¢é•¿è‹±æ–‡/æ•°å­—ä¸æ¢è¡Œæ’‘å¤§å®¹å™¨ ğŸ”¥ */
    word-break: break-all;
    white-space: normal;

    line-height: 1.4;
    max-height: 80%;
    overflow: hidden;
}

.book-name-label {
    font-size: 12px;
    color: #333;
    text-align: center;
    width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.book-delete-hint {
    font-size: 10px;
    color: #999;
    margin-top: -4px;
}

/* ========== å°è¯´é˜…è¯»å™¨åŠ è½½åŠ¨ç”» ========== */
.reader-loading-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
    color: #8D6E63;
    z-index: 100;
}

.reader-spinner {
    width: 40px;
    height: 40px;
    border: 4px solid #E0E0E0;
    border-top: 4px solid #8D6E63;
    border-radius: 50%;
    animation: reader-spin 1s linear infinite;
}

.reader-loading-text {
    font-size: 14px;
    font-weight: 500;
    color: #8D6E63;
    text-align: center;
}

@keyframes reader-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}


/* ========== ä¿®æ­£åçš„ï¼šé˜…è¯»å™¨æ ·å¼ (ScreenåŸºå‡†ç‰ˆ) ========== */
.novel-reader-page {
    position: absolute;
    top: 0;
    left: 0;

    /* ğŸ”¥ æ ¸å¿ƒï¼šå¼ºåˆ¶å®½åº¦å’Œé«˜åº¦å æ»¡çˆ¶çº§ (.screen) */
    width: 100% !important;
    height: 100% !important;

    background-color: #E6E2D3; /* ç¾Šçš®çº¸è‰² */
    z-index: 1400;

    /* ç¿»é¡µåŠ¨ç”» */
    transform: translateX(100%);
    visibility: hidden;
    transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94), visibility 0.35s;

    display: flex;
    flex-direction: column;
    overflow: hidden;
    font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
    border-radius: 0;

    /* ç§»é™¤æ‰€æœ‰å†…è¾¹è·ï¼Œç¡®ä¿å®¹å™¨å°±æ˜¯å±å¹•å¤§å° */
    padding: 0 !important;
    box-sizing: border-box;
}

.novel-reader-page.show {
    transform: translateX(0);
    visibility: visible;
}

/* --- æ ¸å¿ƒé˜…è¯»å®¹å™¨ --- */
.reader-container {
    display: block; /* ç¡®ä¿æ˜¯å—çº§ */
    width: 100%;

    /* é™¤å»é¡¶éƒ¨å’Œåº•éƒ¨çš„å®‰å…¨åŒºåŸŸï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è¿™ä¸ªé«˜åº¦ */
    height: calc(100% - 60px);
    margin-top: 100px;
    margin-bottom: 50px;

    /* æ¨ªå‘æ»šåŠ¨è®¾ç½® */
    overflow-x: scroll;
    overflow-y: hidden;
    scroll-behavior: smooth;

    /* éšè—æ»šåŠ¨æ¡ */
    scrollbar-width: none;
    -ms-overflow-style: none;

    position: relative;

    /* ğŸ”¥ æ ¸å¿ƒï¼šé›¶å†…è¾¹è·ï¼Œé›¶å¤–è¾¹è·ï¼Œç¡®ä¿ contentBox å®½åº¦ = å±å¹•å®½åº¦ */
    padding: 0 !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    box-sizing: border-box;

    /* ğŸ”¥ æ–°å¢ï¼šå¼ºåˆ¶æ»šåŠ¨å¸é™„ (CSS Scroll Snap) */
    /* è¿™æ˜¯ä¸€ä¸ªåŒé‡ä¿é™©ï¼Œæµè§ˆå™¨ä¼šåœ¨æ»šåŠ¨åœæ­¢æ—¶è‡ªåŠ¨å¯¹é½åˆ°æœ€è¿‘çš„ä¸€é¡µ */
    scroll-snap-type: x mandatory;
}
.reader-container::-webkit-scrollbar { display: none; }

/* ä¿®æ”¹ #readerContent æ ·å¼ */
#readerContent {
    height: 100%;
    width: 100%;

    /* å…³é”®è®¾ç½® */
    column-gap: 0 !important;
    column-fill: auto;

    padding: 0 !important;
    box-sizing: border-box;
}
/* ä¿®æ”¹æ®µè½æ ·å¼ï¼Œç¡®ä¿æ²¡æœ‰æ¨ªå‘æº¢å‡º */
#readerContent p {
    /* ä½ çš„ç°æœ‰æ ·å¼... */
    margin: 0 0 1em 0;
    text-indent: 2em;
    font-size: 19px;
    line-height: 1.8;
    color: #2c2c2c;
    text-align: justify;

    /* è§†è§‰ç•™ç™½äº¤ç»™ P æ ‡ç­¾ */
    padding: 0 24px;
    box-sizing: border-box;

    /* é˜²æ­¢æ®µè½è¢«æ‹¦è…°æˆªæ–­ */
    break-inside: avoid;
    page-break-inside: avoid;
    -webkit-column-break-inside: avoid;

    /* ğŸ”¥ æ–°å¢ï¼šè®©æ¯ä¸€é¡µçš„å†…å®¹éƒ½ä½œä¸ºå¸é™„ç‚¹ */
    scroll-snap-align: start;
}
/* é¡¶éƒ¨æ ‡é¢˜æ å®¹å™¨ */
.reader-header-bar {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    /* å¢åŠ é¡¶éƒ¨å†…è¾¹è·ï¼Œé¿å¼€åˆ˜æµ·å±/çŠ¶æ€æ  */
    padding: 50px 16px 10px 16px !important;
    background-color: rgba(230, 226, 211, 0.95); /* ä¸èƒŒæ™¯è‰²ä¸€è‡´çš„åŠé€æ˜è‰² */
    backdrop-filter: blur(10px);
    z-index: 10;
    display: flex;
    align-items: center;
    /* justify-content: center; */ /* å¦‚æœä½ æƒ³è®©æ ‡é¢˜ç»å¯¹å±…ä¸­ï¼Œå–æ¶ˆè¿™è¡Œçš„æ³¨é‡Š */
    box-shadow: 0 1px 0 rgba(0,0,0,0.05);
}

/* ä¼˜åŒ–æ ‡é¢˜æ ï¼Œä½¿å…¶èƒ½æ˜¾ç¤ºç« èŠ‚æ ‡é¢˜ */
#headerTitle {
    font-size: 15px; /*ç¨å¾®å‡å°ä¸€ç‚¹ä»¥å®¹çº³é•¿æ ‡é¢˜*/
    font-weight: 500;
    color: #5d5d5d;
    margin-left: 10px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 70%;
    transition: opacity 0.3s;
}

/* ç« èŠ‚åˆ‡æ¢æ—¶çš„æ·¡å…¥æ·¡å‡ºåŠ¨ç”»ç±» */
.fade-out-content {
    opacity: 0;
    transition: opacity 0.2s ease-out;
}
.fade-in-content {
    opacity: 1;
    transition: opacity 0.2s ease-in;
}

/* åº•éƒ¨æµ®åŠ¨èœå• - é»‘è‰²èƒ¶å›Šé£æ ¼ */
.reader-float-menu {
    position: absolute;
    bottom: 40px; /* è·ç¦»åº•éƒ¨çš„é«˜åº¦ */
    left: 50%;
    transform: translateX(-50%);

    /* èƒ¶å›Šå®¹å™¨æ ·å¼ */
    background: rgba(30, 30, 30, 0.9); /* æ·±è‰²èƒŒæ™¯ */
    backdrop-filter: blur(10px);
    padding: 12px 24px;
    border-radius: 50px; /* å¤§åœ†è§’ */

    display: flex;
    align-items: center;
    gap: 20px; /* ä¸¤ä¸ªæŒ‰é’®ä¹‹é—´çš„é—´è· */

    z-index: 20;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);

    /* åŠ¨ç”» */
    transition: opacity 0.3s, transform 0.3s;
}

/* éšè—æ—¶çš„çŠ¶æ€ï¼ˆé…åˆ JS çš„ hidden ç±»ï¼‰ */
.reader-float-menu.hidden {
    display: flex; /* ä¿æŒ flex å¸ƒå±€ä»¥ä¾¿æµ‹é‡ */
    opacity: 0;
    bottom: 20px;
    pointer-events: none;
}

/* èœå•æŒ‰é’®æ ·å¼ */
.menu-pill-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 14px;
    color: #fff; /* ç™½è‰²æ–‡å­— */
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    opacity: 0.9;
}

.menu-pill-btn:active {
    opacity: 0.6;
}

/* æŒ‰é’®å›¾æ ‡ */
.menu-pill-btn svg {
    width: 18px;
    height: 18px;
    fill: #fff;
}

/* ä¸­é—´çš„åˆ†éš”çº¿ */
.menu-pill-divider {
    width: 1px;
    height: 16px;
    background-color: rgba(255, 255, 255, 0.2);
}

/* ========== é˜…è¯»å™¨åº•éƒ¨ç³»ç»Ÿæ æ ·å¼ (æ–°å¢) ========== */

/* 1. ç³»ç»Ÿæ å®¹å™¨ï¼šå›ºå®šåœ¨åº•éƒ¨ */
.reader-system-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 44px; /* ç³»ç»Ÿæ é«˜åº¦ */

    /* å¸ƒå±€ï¼šä¸¤ç«¯å¯¹é½ */
    display: flex;
    justify-content: space-between;
    align-items: center;

    /* é—´è· */
    padding: 0 24px;
    padding-bottom: 14px; /* é€‚é…æ‰‹æœºåº•éƒ¨å®‰å…¨åŒº */

    /* æ ·å¼ */
    font-size: 13px;
    color: #7d7568; /* æ·±ç°è¤è‰²ï¼Œé€‚åˆç¾Šçš®çº¸èƒŒæ™¯ */
    background: transparent; /* é€æ˜èƒŒæ™¯ */
    z-index: 99; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
    font-family: Menlo, Monaco, 'Courier New', monospace; /* æ•°å­—ç”¨ç­‰å®½å­—ä½“å¥½çœ‹ */
    pointer-events: none; /* è®©ç‚¹å‡»ç©¿é€ï¼Œä¸å½±å“ç¿»é¡µ */
}

/* ä¼˜åŒ–ç³»ç»Ÿæ ï¼Œè®©é¡µç æ˜¾ç¤ºæ›´æ¸…æ™° */
.reader-progress {
    font-size: 12px;
    color: #999;
}

/* 3. å³ä¾§ä¿¡æ¯å®¹å™¨ (æ—¶é—´å’Œç”µé‡) */
.reader-sys-right {
    display: flex;
    align-items: center;
    gap: 10px; /* æ—¶é—´å’Œç”µæ± çš„é—´è· */
}

/* 4. ç”µæ± å¤–æ¡†æ ·å¼ */
.reader-battery {
    width: 22px;
    height: 11px;
    border: 1px solid #7d7568;
    border-radius: 2px;
    padding: 1px;
    position: relative;
    opacity: 0.8;
    display: flex;
    align-items: center;
}

/* 5. ç”µæ± æ­£æå°å¤´ */
.reader-battery::after {
    content: '';
    position: absolute;
    right: -3px;
    top: 50%;
    transform: translateY(-50%);
    width: 2px;
    height: 4px;
    background: #7d7568;
    border-radius: 0 1px 1px 0;
}

/* 6. ç”µé‡å¡«å……æ¡ */
.reader-battery-level {
    height: 100%;
    background: #7d7568;
    width: 100%; /* é»˜è®¤æ»¡ç”µï¼ŒJSä¼šæ§åˆ¶å®é™…å®½åº¦ */
    border-radius: 1px;
}

/* ========== é˜…è¯»å™¨ç›®å½•åˆ—è¡¨æ ·å¼ ========== */
.chapter-list-panel {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 70%;
    background: #fff; /* å¿…é¡»æ˜¯çº¯è‰²èƒŒæ™¯ */
    border-radius: 20px 20px 0 0;

    z-index: 2000; /* å±‚çº§ä¿æŒå¾ˆé«˜ */

    /* ğŸ”¥ğŸ”¥ğŸ”¥ æ ¸å¿ƒæ–°å¢ï¼šå°±æ˜¯è¿™è¡Œä»£ç è§£å†³äº†ç©¿é€é—®é¢˜ ğŸ”¥ğŸ”¥ğŸ”¥ */
    pointer-events: auto !important;
    /* å¼ºåˆ¶æ•è·æ‰€æœ‰é¼ æ ‡/è§¦æ‘¸äº‹ä»¶ */

    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    display: flex;
    flex-direction: column;
    box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
}



.chapter-list-panel.show {
    transform: translateY(0);
}

.chapter-list-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    border-bottom: 1px solid #f0f0f0;
}

.chapter-list-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
}

.chapter-list-close {
    font-size: 14px;
    color: #666;
    padding: 6px 12px;
    background: #f5f5f5;
    border-radius: 14px;
    cursor: pointer;
}

.chapter-list-container {
    flex: 1;
    overflow-y: auto;
    padding: 10px 0;
    position: relative;
}

.chapter-item {
    padding: 14px 20px;
    font-size: 15px;
    color: #333;
    border-bottom: 1px solid #f9f9f9;
    cursor: pointer;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.chapter-item:active {
    background: #f0f0f0;
}

.chapter-item.active {
    color: #0A84FF; /* å½“å‰ç« èŠ‚é«˜äº®è‰² */
    font-weight: 600;
    background: rgba(10, 132, 255, 0.05);
}
/* style.css */

/* é€šç”¨çš„æ—‹è½¬åŠ¨ç”»ï¼Œç”¨äºå¬ä¹¦åŠ è½½çŠ¶æ€ */
@keyframes spin {
    to { transform: rotate(360deg); }
}

.spinner {
    animation: spin 1s linear infinite;
    width: 16px;
    height: 16px;
}

/* ç¨å¾®ä¼˜åŒ–ä¸€ä¸‹æµ®åŠ¨èœå•çš„æŒ‰é’®ï¼Œé˜²æ­¢æ–‡å­—å˜é•¿å¯¼è‡´æŒ¤å‹ */
.reader-float-menu .menu-pill-btn {
    min-width: 60px; /* ç¡®ä¿æœ‰æœ€å°å®½åº¦ */
    justify-content: center;
}

/* ========== å°è¯´æ®µè½ä¸è®¨è®ºæŒ‰é’®æ ·å¼ ========== */

/* æ®µè½å®¹å™¨ï¼Œè®¾ç½®ä¸ºç›¸å¯¹å®šä½ä»¥ä¾¿æ”¾ç½®æŒ‰é’® */
#readerContent p {
    position: relative;
    padding-right: 30px !important; /* å³ä¾§ç•™å‡ºç©ºé—´ç»™å›¾æ ‡ */
    transition: background-color 0.2s;
    border-radius: 8px;
}

#readerContent p:hover {
    background-color: rgba(0, 0, 0, 0.03); /* é¼ æ ‡æ‚¬åœæ—¶æ®µè½å¾®å¾®å˜è‰² */
}

/* è®¨è®ºå°æ ‡å¿— */
.discuss-btn {
    position: absolute;
    right: 0;
    top: 0;
    font-size: 16px;
    cursor: pointer;
    opacity: 0.3; /* é»˜è®¤æ¯”è¾ƒæ·¡ */
    transition: all 0.2s ease;
    user-select: none;
    padding: 4px;
}

/* æ‚¬åœæ®µè½æ—¶ï¼Œå›¾æ ‡å˜æ˜æ˜¾ */
#readerContent p:hover .discuss-btn {
    opacity: 1;
    transform: scale(1.2);
}

.discuss-btn:hover {
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
}

/* ç¡®ä¿è®¨è®ºæŒ‰é’®åœ¨æœ€ä¸Šå±‚ä¸”å¯ç‚¹å‡» */
.discuss-btn {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%); /* å‚ç›´å±…ä¸­ */
    font-size: 18px; /* ç¨å¾®è°ƒå¤§ä¸€ç‚¹ */
    cursor: pointer;
    opacity: 0.4;
    transition: all 0.2s ease;
    user-select: none;
    padding: 8px 12px; /* å¢åŠ ç‚¹å‡»çƒ­åŒº */
    z-index: 100; /* ğŸ”¥ ç¡®ä¿åœ¨æ®µè½æ–‡å­—ä¹‹ä¸Š */
    background: transparent;
    pointer-events: auto; /* ğŸ”¥ ç¡®ä¿èƒ½æ¥æ”¶ç‚¹å‡»äº‹ä»¶ */
}

/* ä¿®å¤é˜…è¯»å†…å®¹åŒºåŸŸçš„å±‚çº§ï¼Œé˜²æ­¢é®æŒ¡æŒ‰é’® */
#readerContent p {
    position: relative;
    padding-right: 40px !important; /* ç•™å‡ºæ›´å¤šç©ºé—´ç»™æŒ‰é’® */
    box-sizing: border-box;
    z-index: 1;
}

/* æ‚¬åœæ•ˆæœ */
#readerContent p:hover {
    background-color: rgba(0, 0, 0, 0.03);
}

#readerContent p:hover .discuss-btn {
    opacity: 1;
    transform: translateY(-50%) scale(1.2);
}

/* ğŸ”¥ å¼ºåˆ¶æå‡å±‚çº§ï¼Œç¡®ä¿è”ç³»äººé€‰æ‹©å™¨æ°¸è¿œåœ¨æœ€ä¸Šå±‚ */
.contact-library-page {
    z-index: 2000 !important; /* åŸå§‹æ˜¯1004ï¼Œæå‡åˆ°2000è¶…è¿‡æ‰€æœ‰APP */
}

/* åŒæ ·æå‡èŠå¤©é¡µé¢çš„å±‚çº§ï¼Œé˜²æ­¢é€‰å®ŒäººåèŠå¤©æ¡†è¢«ä¹¦æ¶æŒ¡ä½ */
.chat-page,
.sweetheart-chat-page {
    z-index: 1500 !important; /* åŸå§‹æ˜¯1005ï¼Œæå‡åˆ°1500è¶…è¿‡ä¹¦æ¶(1300) */
}

/* ========== å‰§æƒ…è®¨è®ºå¼¹çª—æ ·å¼ ========== */
#discussModal {
    z-index: 2500; /* å¿…é¡»é«˜äºè”ç³»äººåº“(2000)å’Œå°è¯´é˜…è¯»å™¨(1400) */
    background: rgba(0, 0, 0, 0.3); /* ç¨å¾®æ·±ä¸€ç‚¹çš„é®ç½© */
    align-items: flex-end; /* è®©å¼¹çª—ä»åº•éƒ¨å‡ºç°ï¼Œç±»ä¼¼é”®ç›˜æˆ–é¢æ¿ */
    padding: 0;
}

.discuss-card {
    width: 100%;
    height: 70%; /* å æ®å±å¹• 70% é«˜åº¦ */
    background: #fff;
    border-radius: 20px 20px 0 0;
    display: flex;
    flex-direction: column;
    box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

#discussModal.show .discuss-card {
    transform: translateY(0);
}

.discuss-header {
    padding: 16px 20px;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #f9f9f9;
    border-radius: 20px 20px 0 0;
}

.discuss-title {
    font-size: 16px;
    font-weight: 600;
    color: #333;
}

.discuss-close-btn {
    font-size: 14px;
    color: #666;
    background: #e0e0e0;
    border: none;
    padding: 6px 12px;
    border-radius: 12px;
    cursor: pointer;
}

.discuss-messages {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    background: #f5f5f5;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* å¤ç”¨ç°æœ‰çš„æ¶ˆæ¯æ°”æ³¡æ ·å¼ï¼Œä½†åœ¨è®¨è®ºçª—ä¸­ç¨å¾®ç¼©å° */
.discuss-messages .chat-bubble {
    font-size: 14px;
    padding: 10px;
    max-width: 85%;
}

.discuss-input-area {
    padding: 10px 15px;
    background: white;
    border-top: 1px solid #eee;
    display: flex;
    gap: 10px;
    /* é€‚é… iPhone åº•éƒ¨å®‰å…¨åŒº */
    padding-bottom: 25px;
}

#discussInput {
    flex: 1;
    padding: 10px 14px;
    background: #f0f2f5;
    border: none;
    border-radius: 20px;
    font-size: 14px;
    outline: none;
}

.discuss-send-btn {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    padding: 0 20px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 14px;
}

/* style.css æœ«å°¾æ·»åŠ  */

/* ========== å‰§æƒ…è®¨è®º Markdown æ ·å¼ä¼˜åŒ– ========== */

/* Markdown å†…å®¹å®¹å™¨ */
.markdown-content {
    line-height: 1.6;
    font-size: 14px;
    color: inherit;
}

/* 1. æ ‡é¢˜æ ·å¼ */
.markdown-content h1,
.markdown-content h2,
.markdown-content h3 {
    font-size: 16px;
    font-weight: 700;
    margin: 12px 0 6px 0;
    line-height: 1.4;
}
.markdown-content h1:first-child,
.markdown-content h2:first-child,
.markdown-content h3:first-child {
    margin-top: 0;
}

/* 2. åˆ—è¡¨æ ·å¼ (å…³é”®ï¼šè§£å†³ç¼©è¿›é—®é¢˜) */
.markdown-content ul,
.markdown-content ol {
    margin: 6px 0;
    padding-left: 20px; /* ç•™å‡ºåœ†ç‚¹ç©ºé—´ */
}

.markdown-content li {
    margin-bottom: 4px;
    list-style-position: outside; /* æ ‡è®°åœ¨å¤–éƒ¨ï¼Œæ•´é½å¯¹é½ */
}

/* 3. ç²—ä½“ä¸æ–œä½“ */
.markdown-content strong {
    font-weight: 700;
    color: inherit; /* ç»§æ‰¿æ°”æ³¡æ–‡å­—é¢œè‰² */
}
.markdown-content em {
    font-style: italic;
    opacity: 0.9;
}

/* 4. å¼•ç”¨å— (Blockquote) */
.markdown-content blockquote {
    margin: 8px 0;
    padding: 8px 12px;
    border-left: 3px solid rgba(0, 0, 0, 0.2); /* åŠé€æ˜è¾¹æ¡† */
    background: rgba(0, 0, 0, 0.05); /* åŠé€æ˜èƒŒæ™¯ */
    border-radius: 4px;
    font-size: 0.95em;
    color: inherit;
}

/* å‘é€æ–¹çš„å¼•ç”¨å—é¢œè‰²é€‚é… (è“è‰²èƒŒæ™¯) */
.message-row.sent .markdown-content blockquote {
    border-left-color: rgba(255, 255, 255, 0.5);
    background: rgba(255, 255, 255, 0.15);
}

/* 5. è¡Œå†…ä»£ç ä¸ä»£ç å— */
.markdown-content code {
    font-family: 'Consolas', monospace;
    background: rgba(0, 0, 0, 0.08);
    padding: 2px 4px;
    border-radius: 4px;
    font-size: 0.9em;
}
.message-row.sent .markdown-content code {
    background: rgba(255, 255, 255, 0.2);
}

.markdown-content pre {
    background: #2d2d2d;
    color: #e6e6e6;
    padding: 10px;
    border-radius: 8px;
    overflow-x: auto;
    margin: 8px 0;
}
.markdown-content pre code {
    background: transparent;
    padding: 0;
    color: inherit;
}

/* 6. æ®µè½å¤„ç† */
.markdown-content p {
    margin-bottom: 8px;
}
.markdown-content p:last-child {
    margin-bottom: 0;
}



/* ========== è®°è´¦æœ¬é¡µé¢æ ·å¼ ========== */
.ledger-page {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: #F2F4F7;
    z-index: 1100;
    transform: translateX(100%);
    visibility: hidden;
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), visibility 0.3s;
    display: flex;
    flex-direction: column;
}
.ledger-page.show {
    transform: translateX(0);
    visibility: visible;
}

/* é¡¶éƒ¨èµ„äº§å¡ç‰‡ */
.ledger-summary-card {
    background: linear-gradient(135deg, #FFF0F5 0%, #E6E6FA 100%);
    margin: 10px 20px;
    padding: 20px;
    border-radius: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    color: #555;
    flex-shrink: 0;
}
.ledger-month-selector {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
    font-weight: bold;
    font-size: 16px;
    color: #333;
}
.ledger-toggle-mode {
    font-size: 13px;
    color: #667eea;
    cursor: pointer;
    background: rgba(255,255,255,0.6);
    padding: 4px 10px;
    border-radius: 12px;
}
.ledger-stats-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
}
.stat-item {
    display: flex;
    flex-direction: column;
}
.stat-label { font-size: 12px; opacity: 0.7; }
.stat-num { font-size: 20px; font-weight: bold; font-family: 'DIN Alternate', sans-serif; }
.stat-num.income { color: #f39c12; }
.stat-num.expense { color: #e74c3c; }
.ledger-balance {
    border-top: 1px dashed rgba(0,0,0,0.1);
    padding-top: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
}

/* å†…å®¹åŒºåŸŸé€šç”¨ */
.ledger-content-area {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    position: relative;
    background: #fff;
    border-radius: 20px 20px 0 0;
    margin-top: 10px;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.03);
}
.ledger-content-area.hidden { display: none; }

/* èŠå¤©è®°è´¦æ¨¡å¼ */
.ledger-chat-list {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
}
.ledger-system-msg {
    text-align: center;
    font-size: 12px;
    color: #999;
    background: #f5f5f5;
    padding: 5px 10px;
    border-radius: 10px;
    align-self: center;
}
.ledger-msg {
    max-width: 80%;
    padding: 10px 14px;
    border-radius: 16px;
    font-size: 14px;
    line-height: 1.4;
}
.ledger-msg.user {
    align-self: flex-end;
    background: #667eea;
    color: white;
    border-bottom-right-radius: 4px;
}
.ledger-msg.ai {
    align-self: flex-start;
    background: #f0f2f5;
    color: #333;
    border-bottom-left-radius: 4px;
    white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œ */
    line-height: 1.5;
}


/* åº•éƒ¨è¾“å…¥æ¡† */
.ledger-input-bar {
    padding: 10px 15px; /* å¢åŠ åº•éƒ¨å†…è¾¹è· */
    background: #fff;
    border-top: 1px solid #eee;
    display: flex;
    align-items: center;
    gap: 10px;
    padding-bottom: 30px; /* é€‚é…å…¨é¢å±åº•éƒ¨ */
}
.ledger-upload-btn {
    font-size: 24px;
    cursor: pointer;
}
#ledgerInput {
    flex: 1;
    padding: 10px;
    border: 1px solid #eee;
    border-radius: 20px;
    background: #f9f9f9;
    outline: none;
}
.ledger-send-btn {
    background: #667eea;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 16px;
    font-size: 13px;
    font-weight: 600;
}

/* åˆ—è¡¨æ¨¡å¼ */
.ledger-list-container {
    flex: 1;
    overflow-y: auto;
    padding: 0 20px;
}
.ledger-record-item {
    display: flex;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #f5f5f5;
}
.record-icon {
    width: 40px; height: 40px;
    background: #f0f2f5;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 20px;
    margin-right: 12px;
}
.record-info { flex: 1; }
.record-title { font-size: 15px; color: #333; font-weight: 500; }
.record-date { font-size: 12px; color: #999; margin-top: 2px; }
.record-amount { font-size: 16px; font-weight: bold; font-family: 'DIN Alternate', sans-serif; }
.record-amount.expense { color: #333; }
.record-amount.income { color: #f39c12; }
.record-delete {
    color: #ff4757; font-size: 12px; margin-left: 10px;
    cursor: pointer; padding: 5px; opacity: 0.5;
}

/* ========== æ–°å¢ï¼šAI è®°è´¦æ¨¡å¼æ ·å¼ ========== */

/* å¤´éƒ¨å¸ƒå±€è°ƒæ•´ */
.ledger-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

/* AI å¼€å…³å®¹å™¨ */
.ledger-ai-switch {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    background: rgba(255, 255, 255, 0.5);
    padding: 4px 8px;
    border-radius: 20px;
    transition: all 0.3s ease;
}

.ai-switch-label {
    font-size: 12px;
    font-weight: bold;
    color: #888;
}

/* å¼€å…³è½¨é“ */
.ai-toggle-btn {
    width: 36px;
    height: 20px;
    background: #ccc;
    border-radius: 20px;
    position: relative;
    transition: background 0.3s ease;
}

/* å¼€å…³åœ†çƒ */
.ai-toggle-circle {
    width: 16px;
    height: 16px;
    background: white;
    border-radius: 50%;
    position: absolute;
    top: 2px;
    left: 2px;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

/* AI æ¨¡å¼æ¿€æ´»çŠ¶æ€ */
.ledger-ai-switch.active .ai-switch-label {
    color: #8A2BE2; /* ç´«è‰²æ–‡å­— */
    text-shadow: 0 0 5px rgba(138, 43, 226, 0.3);
}

.ledger-ai-switch.active .ai-toggle-btn {
    background: linear-gradient(135deg, #b06ab3, #4568dc); /* é­”æ³•æ¸å˜è‰² */
}

.ledger-ai-switch.active .ai-toggle-circle {
    transform: translateX(16px);
}

/* è¾“å…¥æ¡†åœ¨ AI æ¨¡å¼ä¸‹çš„ç‰¹æ•ˆ */
.ledger-input-bar.ai-active {
    border-top: 2px solid #b06ab3;
    box-shadow: 0 -4px 20px rgba(176, 106, 179, 0.15);
}

.ledger-input-bar.ai-active .ledger-send-btn {
    background: linear-gradient(135deg, #b06ab3, #4568dc);
    animation: glow 2s infinite;
}

@keyframes glow {
    0% { box-shadow: 0 0 5px rgba(176, 106, 179, 0.5); }
    50% { box-shadow: 0 0 15px rgba(176, 106, 179, 0.8); }
    100% { box-shadow: 0 0 5px rgba(176, 106, 179, 0.5); }
}

